!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){var r=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function s(e,t,n,a){var o=t&&t.prototype instanceof p?t:p,i=Object.create(o.prototype),l=new N(a||[]);return r(i,"_invoke",{value:_(e,n,l)}),i}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var u={};function p(){}function m(){}function f(){}var b={};c(b,o,(function(){return this}));var v=Object.getPrototypeOf,w=v&&v(v(P([])));w&&w!==t&&n.call(w,o)&&(b=w);var g=f.prototype=p.prototype=Object.create(b);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function h(e,t){var a;r(this,"_invoke",{value:function(r,o){function i(){return new t((function(a,i){!function r(a,o,i,l){var c=d(e[a],e,o);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==typeof u&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){r("next",e,i,l)}),(function(e){r("throw",e,i,l)})):t.resolve(u).then((function(e){s.value=e,i(s)}),(function(e){return r("throw",e,i,l)}))}l(c.arg)}(r,o,a,i)}))}return a=a?a.then(i,i):i()}})}function _(e,t,n){var r="suspendedStart";return function(a,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw o;return{value:void 0,done:!0}}for(n.method=a,n.arg=o;;){var i=n.delegate;if(i){var l=E(i,n);if(l){if(l===u)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=d(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===u)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function E(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),u;var a=d(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,u;var o=a.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function P(e){if(null!=e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}throw new TypeError(typeof e+" is not iterable")}return m.prototype=f,r(g,"constructor",{value:f,configurable:!0}),r(f,"constructor",{value:m,configurable:!0}),m.displayName=c(f,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,l,"GeneratorFunction")),e.prototype=Object.create(g),e},e.awrap=function(e){return{__await:e}},y(h.prototype),c(h.prototype,i,(function(){return this})),e.AsyncIterator=h,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new h(s(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},y(g),c(g,l,"Generator"),c(g,o,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=P,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],i=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var l=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,u):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),u}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;S(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:P(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),u}},e}(e.exports);try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){"use strict";n.r(t);n(0);var r=wp.data,a=r.dispatch,o=r.select,i=function(e){return new Promise((function(t){if(window.vibebp.settings.hasOwnProperty("firebase_config")&&window.vibebp.settings.firebase_config&&"undefined"!=typeof firebase&&firebase&&firebase.hasOwnProperty("database")&&firebase.database&&window.vibebp.settings.session_lock){var n=firebase.database().ref("users");n||t(),n.orderByChild("firebaseUid").equalTo(e).once("value",(function(r){if(r.exists()){var i=r.val();for(var l in i)i[l].hasOwnProperty("status")&&("loggedin_logout_all"==window.vibebp.settings.session_lock?function(){var r=o("vibebp").getData("loggedInNumber");r||(r=i[l].hasOwnProperty("loggedInNumber")?i[l].loggedInNumber+1:1,a("vibebp").setData("loggedInNumber",r),localforage.setItem("loggedInNumber",r)),firebase.database().ref("users/".concat(l,"/loggedInNumber")).set(r),firebase.database().ref("users/".concat(l,"/status")).onDisconnect().set(0),n.orderByChild("firebaseUid").equalTo(e).on("value",(function(e){if(e.exists()){var t=e.val();for(var n in t)t[n].hasOwnProperty("loggedInNumber")&&t[n].loggedInNumber&&t[n].loggedInNumber!==r&&document.dispatchEvent(new Event("vibebp_logout"))}})),t()}():i[l].hasOwnProperty("status")&&i[l].status&&t(window.vibebp.translations.online_from_other_account));t()}else t()})).catch((function(){t()}))}else t()}))};function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var d=wp.element,u=(d.createElement,d.useState),p=d.useEffect,m=d.Fragment,f=(d.render,wp.data),b=f.dispatch,v=(f.select,function(e){var t=c(u({}),2),n=t[0],r=t[1],a=c(u(null),2),o=a[0],s=a[1],d=c(u(!1),2),f=d[0],v=d[1],w=c(u(!1),2),g=w[0],y=w[1];p((function(){window.vibebp.settings.firebase_config&&"object"==("undefined"==typeof firebase?"undefined":l(firebase))&&0===firebase.apps.length&&firebase.initializeApp(JSON.parse(window.vibebp.settings.firebase_config))}),[]),p((function(){e.childProviderId!==g&&y(e.childProviderId)}),[e.childProviderId]),p((function(){if(window.vibebp.settings.firebase_config){var e={};Object.keys(window.vibebp.settings.auth).map((function(t){window.vibebp.settings.auth[t]&&("google"===t&&(e.google=new firebase.auth.GoogleAuthProvider,e.google.addScope("profile"),e.google.addScope("email")),"twitter"===t&&(e.twitter=new firebase.auth.TwitterAuthProvider),"github"===t&&(e.github=new firebase.auth.GithubAuthProvider),"apple"===t&&(e.apple=new firebase.auth.OAuthProvider("apple.com"),e.apple.addScope("email"),e.apple.addScope("name")),"facebook"===t&&(e.facebook=new firebase.auth.FacebookAuthProvider),"microsoft"===t&&(e.microsoft=new firebase.auth.OAuthProvider("microsoft.com")))})),r(e)}}),[]);var h=function(t,n){return fetch("".concat(window.vibebp.api.url,"/sociallogin?client_id=").concat(window.vibebp.settings.client_id,"&nocache"),{method:"post",body:JSON.stringify({social:t.credential.signInMethod,client_id:window.vibebp.settings.client_id,user:{email:t.user.email,uid:t.user.uid,name:t.user.displayName,avatar:t.user.photoURL,phoneNumber:t.user.phoneNumber,last_login:t.user.metadata.lastSignInTime,create_time:t.user.metadata.creationTime},idToken:n})}).then((function(e){return e.json()})).then((function(n){if(n.status)return localforage.setItem("bp_login_token",n.token),fetch("".concat(window.vibebp.api.validate_token,"?force&client_id=").concat(window.vibebp.settings.client_id),{method:"post",body:n.token}).then((function(e){return e.json()})).then((function(r){if(r.hasOwnProperty("data")){if("undefined"!=typeof firebase&&firebase&&firebase.hasOwnProperty("database")&&window.vibebp.settings.firebase_config&&firebase.database().ref("users/".concat(r.data.data.user.id,"/firebaseUid")).set(t.user.uid),localforage.setItem("bp_user",JSON.stringify(r.data.data.user)),sessionStorage.setItem("bp_user",JSON.stringify(r.data.data.user)),e.setUser(r.data.data.user),b("vibebp").setToken(n.token),b("vibebp").setUser(r.data.data.user),document.querySelector("body").classList.add("vibebp-logged-in"),window.vibebp.settings.login_redirect&&r.hasOwnProperty("redirect_component")&&r.redirect_component){var a="";a=r.redirect_component.split("http").length>1?r.redirect_component:r.redirect_component.split("#").length>1?window.vibebp.settings.login_redirect+r.data.data.user.slug+r.redirect_component:window.vibebp.settings.login_redirect+r.data.data.user.slug+"#"+r.redirect_component,window.location.href=a}var o=sessionStorage.getItem("loggedinmenu");return o?b("vibebp").setData("loggedinMenu",JSON.parse(o)):fetch("".concat(window.vibebp.api.url,"/loggedinmenu"),{method:"post",body:JSON.stringify({token:n.token})}).then((function(e){return e.json()})).then((function(e){e.status&&(sessionStorage.setItem("loggedinmenu",JSON.stringify(e.menu)),b("vibebp").setData("loggedinMenu",e.menu))})).catch((function(e){return 401===e.status&&document.dispatchEvent(new Event("vibebp_logout")),Promise.reject(e.json())})),r.data.data.user}document.dispatchEvent(new Event("vibebp_logout"))}));n.hasOwnProperty("message")&&s(n.message)}))},_=function(e){window.vibebp.settings.firebase_config&&n&&n[e]?(v(e),s(null),window.innerWidth<1024&&("undefined"==typeof window||"undefined"==typeof navigator||/iPhone/i.test(navigator.userAgent||navigator.vendor||window.opera&&"[object Opera]"===opera.toString())),firebase.auth().signInWithPopup(n[e]).then((function(e){var t=e.user;i(t.uid).then((function(n){n&&n.length?s(n):(b("vibebp").setData("firebaseUser",t),t.getIdToken().then((function(t){h(e,t).then((function(e){b("vibebp").setUser(e)}))})))}))})).catch((function(e){"auth/account-exists-with-different-credential"===e.code&&(console.log("account exists in different login credentials"),firebase.auth().fetchSignInMethodsForEmail(e.email).then((function(t){if(v(!1),Array.isArray(t)){if(t.indexOf("google.com")>-1)(n=new firebase.auth.GoogleAuthProvider).addScope("profile"),n.addScope("email");else if(t.indexOf("facebook.com")>-1)var n=new firebase.auth.FacebookAuthProvider;else if(t.indexOf("twitter.com")>-1)n=new firebase.auth.TwitterAuthProvider;else if(t.indexOf("github.com")>-1)n=new firebase.auth.GithubAuthProvider;n.setCustomParameters({login_hint:e.email}),firebase.auth().signInWithPopup(n).then((function(e){var t=e.user;i(t.uid).then((function(n){n&&n.length?s(n):t.getIdToken().then((function(t){h(e,t).then((function(e){b("vibebp").setUser(e)}))}))}))})).catch((function(e){console.log(e)}))}})))}))):document.dispatchEvent(new CustomEvent("login_with_"+e,{detail:{key:e}}))};if(!f&&n&&Object.keys(n).length&&g){var E=!1;Object.keys(n).map((function(e,t){g===n[e].providerId&&(E=e)})),E&&v(E)}return wp.element.createElement(m,null,window.vibebp.settings.email_login?"":wp.element.createElement(m,null,wp.element.createElement("h2",{dangerouslySetInnerHTML:{__html:window.vibebp.translations.login_heading}}),wp.element.createElement("p",{dangerouslySetInnerHTML:{__html:window.vibebp.translations.login_message}})),o?wp.element.createElement("div",{className:"vbp_message error",dangerouslySetInnerHTML:{__html:o}}):"",window.vibebp.settings.firebase_config?Object.keys(window.vibebp.settings.auth).map((function(e){if(window.vibebp.settings.auth[e])return wp.element.createElement("a",{className:f==e?"button is-primary is-loading":"button is-primary",onClick:function(){return _(e)}},window.vibebp.settings.icons&&window.vibebp.settings.icons[e]?wp.element.createElement("span",{className:"vicon",dangerouslySetInnerHTML:{__html:window.vibebp.settings.icons[e]}}):wp.element.createElement("span",{className:"icon vicon vicon-"+e}),wp.element.createElement("span",null,window.vibebp.translations[e]))})):"",window.vibebp.settings.email_login?"":wp.element.createElement("a",{className:"button is-primary",onClick:function(){return e.setemailSignIn(!0)}},wp.element.createElement("span",{className:"icon vicon vicon-email"}),wp.element.createElement("span",null,window.vibebp.translations.email_login)),wp.element.createElement("div",{className:"extra_details"},window.vibebp.settings.enable_registrations?isNaN(window.vibebp.settings.enable_registrations)?wp.element.createElement("p",null,window.vibebp.translations.no_account,wp.element.createElement("a",{className:"vibebp_forward_link",href:window.vibebp.settings.enable_registrations},window.vibebp.translations.create_one," ",wp.element.createElement("span",{className:"vicon vicon-arrow-right"}))):wp.element.createElement("p",null,window.vibebp.translations.no_account,wp.element.createElement("a",{className:"vibebp_forward_link",onClick:function(){return e.setRegistration(!0)}},window.vibebp.translations.create_one," ",wp.element.createElement("span",{className:"vicon vicon-arrow-right"}))):"",wp.element.createElement("p",{dangerouslySetInnerHTML:{__html:window.vibebp.translations.login_terms}})))});function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h=wp.data,_=(h.dispatch,h.select),E={setUser:function(e){return document.dispatchEvent(new CustomEvent("userLoaded",{detail:{userLoaded:e}})),{type:"SET_USER",user:e}},addNotification:function(e){if(e.hasOwnProperty("text")&&e.text&&e.text.length)return{type:"ADD_NOTIFICATION",notification:g(g({},e),{},{id:(new Date).getTime()})}},removeNotification:function(e){return{type:"REMOVE_NOTIFICATION",notification:e}},updateNotification:function(e){return{type:"UPDATE_NOTIFICATION",notification:e}},getUser:function(){return{type:"GET_USER"}},verifyUser:function(e,t){return{type:"VERIFY_USER_API",path:e,token:t}},setToken:function(e){return{type:"SET_TOKEN",token:e}},logout:function(){fetch("".concat(window.vibebp.api.remove_token,"?client_id=").concat(window.vibebp.settings.client_id,"&force"),{method:"post",body:JSON.stringify({token:_("vibebp").getToken()})});var e=new CustomEvent("userLoaded",{detail:{userLoaded:!0,loggedOut:!0}});return document.dispatchEvent(e),localforage.removeItem("loggedInNumber"),sessionStorage.removeItem("bp_user"),window.vibebp.settings.firebase_config&&firebase.auth().signOut(),localforage.removeItem("bp_login_token").then((function(){document.querySelector("body").classList.add("vibebp_logout"),window.location.href=window.vibebp.settings.logout_redirect+"?vibebp_logout=1"})),{type:"LOGOUT"}},setMenu:function(e){return{type:"SET_MENU",menu:e}},setOnlineMembers:function(e){return{type:"SET_ONLINE_MEMBERS",onlineMembers:e}},setData:function(e,t){return{type:"SET_DATA",data_type:e,data:t}},removeData:function(e){return{type:"REMOVE_DATA",data_type:e}},setComponent:function(e){var t=window.location.href.split("#")[0]+"#",n=[],r=(window.location.href.replace(/[#&]+([^=&]+)=([^&]*)/gi,(function(e,t,r){n[t]=r})),""),a="",o="";return Object.keys(n).map((function(e){"component"!==e&&(r+="&"+e+"="+n[e]),"action"==e&&(a=n[e]),"id"==e&&(o=n[e])})),t+="component="+e,r.length&&(t+=r),window.location.href=t,localforage.removeItem("last_request"),document.querySelector("body").classList.forEach((function(e,t){e.indexOf("vibebp-component")>-1&&document.querySelector("body").classList.remove(e)})),document.querySelector("body").classList.add("vibebp-component-"+e),{type:"SET_COMPONENT",component:e,action:a,id:o}},setAction:function(e){var t=window.location.href.split("#")[0]+"#",n=[],r=(window.location.href.replace(/[#&]+([^=&]+)=([^&]*)/gi,(function(e,t,r){n[t]=r})),""),a="",o="";return Object.keys(n).map((function(e){"component"!==e&&"action"!==e&&(r+="&"+e+"="+n[e]),"component"==e&&(o=n[e]),"id"==e&&(a=n[e])})),o&&(t+="component="+o,e&&(t+="&action="+e,a&&(t+="&id="+a))),r.length&&(t+=r),window.location.href=t,{type:"SET_ACTION",action:e}},setId:function(e){var t=window.location.href.split("#")[0]+"#",n=[],r=(window.location.href.replace(/[#&]+([^=&]+)=([^&]*)/gi,(function(e,t,r){n[t]=r})),""),a="",o="";return Object.keys(n).map((function(e){"component"!==e&&"action"!==e&&"id"!=e&&(r+="&"+e+"="+n[e]),"action"==e&&(o=n[e]),"component"==e&&(a=n[e])})),a&&(t+="component="+a,o&&(t+="&action="+o,e&&(t+="&id="+e))),r.length&&(t+=r),window.location.href=t,{type:"SET_ID",id:e}},sendRealTimeNotification:function(e,t){return{type:"SEND_REALTIME_NOTIFICATION",user_id:e,message:t}},removeRealTimeNotification:function(e,t){return{type:"REMOVE_REALTIME_NOTIFICATION",user_id:e,message:t}},AddStaleRequest:function(e){var t=localforage.createInstance({name:"vibebp_stale_requests"}),n=Math.round((new Date).getTime()/1e3);return t.keys().then((function(r){var a=r.findIndex((function(t){return t.indexOf(e)>-1}));a>-1?t.setItem(r[a],n):t.setItem(e,n)})),{}}};function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function S(e){return function(e){if(Array.isArray(e))return N(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var I=wp.data,A=I.registerStore,x=(I.combineReducers,I.useStore,{user:{},menu:[],notifications:[],component:"",action:""}),T=A("vibebp",{reducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER":return sessionStorage.setItem("bp_user",JSON.stringify(t.user)),k(k({},e),{},{user:t.user});case"ADD_NOTIFICATION":var n=S(e.notifications),r=[];return n.map((function(e,t){e.id>=(new Date).getTime()-3e3&&r.push(e)})),r.unshift(k({},t.notification)),k(k({},e),{},{notifications:r});case"REMOVE_NOTIFICATION":var a=S(e.notifications);return a.splice(a.findIndex((function(e){return t.notification.id===e.id})),1),k(k({},e),{},{notifications:a});case"UPDATE_NOTIFICATION":var o=S(e.notifications),i=o.findIndex((function(e){return t.notification.id===e.id}));return i>-1&&(o[i]=t.notification),k(k({},e),{},{notifications:o});case"GET_NOTIFICATIONS":return e.notifications;case"GET_USER":return e.user;case"SET_MENU":return k(k({},e),{},{menu:t.menu});case"GET_MENU":return e.menu;case"SET_TOKEN":return k(k({},e),{},{token:t.token});case"SET_COMPONENT":var l=new CustomEvent("component_loaded",{detail:{component:t.component,action:t.action,id:t.id,user:e.user,token:e.token}});return document.dispatchEvent(l),k(k({},e),{},{component:t.component,action:t.action,id:t.id});case"SET_ACTION":return k(k({},e),{},{action:t.action});case"SET_ID":return k(k({},e),{},{id:t.id});case"SET_ONLINE_MEMBERS":return k(k({},e),{},{onlineMembers:t.onlineMembers});case"SET_DATA":var c=k({},e.data);return c[t.data_type]=t.data,k(k({},e),{},{data:c});case"REMOVE_DATA":var s=k({},e.data);return delete s[t.data_type],k(k({},e),{},{data:s});case"SEND_REALTIME_NOTIFICATION":k({},e.user);return!e.hasOwnProperty("realTimeNotification")||e.realTimeNotification.message!=t.message&&e.realTimeNotification.user_id!=t.user_id?(window.vibebp.settings.firebase_config&&window.vibebp.settings.realtimenotifications,k(k({},e),{},{realTimeNotification:{user_id:t.user_id,message:t.message}})):e}return e},actions:E,selectors:{getUser:function(e){return e.user},verifyUser:function(e,t,n){return e.user},setUser:function(e,t){return e.user=t,t},getNotifications:function(e){return e.notifications},removeNotification:function(e,t){var n=e.notifications;return n.splice(n.findIndex((function(e){return e.id===t})),1),e.notifications=n,n},updateNotification:function(e,t){var n=e.notifications;if("object"===O(t)){var r=n.findIndex((function(e){return e.id===t.id}));r>-1&&(n[r]=t),e.notifications=n}return n},logout:function(e){return e.user},setMenu:function(e,t){return e.menu},getMenu:function(e){return e.menu},getComponent:function(e){return e.component},getAction:function(e){return e.action},getId:function(e){return e.id},getToken:function(e){return e.token},setToken:function(e,t){return e.token=t,t},getOnlineMembers:function(e){return e.onlineMembers},getData:function(e,t){return!(!e.hasOwnProperty("data")||!e.data.hasOwnProperty(t))&&e.data[t]}},controls:{VERIFY_USER_API:function(e){var t=e.path,n=e.token;return fetch(t,{method:"post",body:n}).then((function(e){return e.json()})).then((function(e){return e.hasOwnProperty("data")&&e.status?("undefined"!=typeof firebase&&firebase.hasOwnProperty("auth")&&firebase.auth().onAuthStateChanged((function(e){e&&Object.keys(e).length&&firebase.auth().currentUser&&i(e.uid).then((function(e){e&&e.length&&document.dispatchEvent(new Event("vibebp_logout"))}))})),localforage.setItem("bp_user",JSON.stringify(e.data.data.user)),e.data.data.user.exp=e.data.exp,e.data.data.user):(localforage.removeItem("bp_user"),localforage.removeItem("bp_login_token"),{})}))},LOGOUT:function(e){localforage.removeItem("bp_login_token"),localforage.removeItem("bp_user")}},resolvers:{verifyUser:regeneratorRuntime.mark((function e(t,n){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.verifyUser(t,n);case 2:return r=e.sent,e.abrupt("return",E.setUser(r));case 4:case"end":return e.stop()}}),e)})),setToken:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E.setToken(t));case 1:case"end":return e.stop()}}),e)})),setUser:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E.setUser(t));case 1:case"end":return e.stop()}}),e)})),addNotification:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E.addNotification(t));case 1:case"end":return e.stop()}}),e)})),removeNotification:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E.removeNotification(t));case 1:case"end":return e.stop()}}),e)})),updateNotification:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E.updateNotification(t));case 1:case"end":return e.stop()}}),e)})),logout:regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E.logout();case 2:return e.sent,e.abrupt("return",E.setUser({}));case 4:case"end":return e.stop()}}),e)})),setMenu:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",E.setMenu(t));case 1:case"end":return e.stop()}}),e)}))}});function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var L=wp.element,D=(L.createElement,L.useState),U=L.useEffect,R=L.Fragment,J=(L.render,wp.data),F=J.select,G=J.dispatch,q=function(e){var t=C(D(""),2),n=t[0],r=t[1],a=C(D(!1),2),o=a[0],l=a[1],c=C(D("input"),2),s=c[0],d=c[1],u=C(D("input"),2),p=(u[0],u[1]),m=C(D(""),2),f=m[0],b=m[1],v=C(D(!1),2),w=v[0],g=v[1],y=C(D(""),2),h=y[0],_=y[1],E=C(D(""),2),O=E[0],S=E[1],N=C(D(""),2),P=(N[0],N[1],C(D(!1),2)),k=P[0],j=P[1],I=C(D(!0),2),A=I[0],x=I[1],T=C(D(!1),2),M=T[0],L=T[1];U((function(){window.vibebp.translations.login_checkbox.length&&x(!1)}),[]);var J=function(){if(f.length<4&&n.length<4)_(window.vibebp.translations.password_too_short);else{var t=0;n.trim().indexOf("@")>-1&&!n.trim().match(/^([\w.%+-]+)@([\w-]+\.)+([\w]{2,})$/i)&&(d("input is-danger"),_(window.vibebp.translations.invalid_email),t++),f.length<4&&(p("input is-danger"),_(window.vibebp.translations.password_too_short),t++),!t&&A?(l(!0),window.vibebp.settings.hasOwnProperty("firebase_config")&&window.vibebp.settings.firebase_config&&"undefined"!=typeof firebase&&firebase&&window.vibebp.settings.session_lock?fetch("".concat(window.vibebp.api.generate_token,"?nocache&client_id=").concat(window.vibebp.settings.client_id),{method:"post",body:JSON.stringify({email:n.trim(),password:f})}).then((function(e){return e.json()})).then((function(t){t.status?fetch("".concat(window.vibebp.api.validate_token,"?client_id=").concat(window.vibebp.settings.client_id,"&nocache"),{method:"post",body:t.token}).then((function(e){return e.json()})).then((function(n){l(!1),n.hasOwnProperty("data")?firebase.auth().signInWithEmailAndPassword(n.data.data.user.email,n.data.data.user.refresh_token).then((function(r){console.log("user",r),r.hasOwnProperty("user")||(r.user=r),firebase.database().ref("users/".concat(n.data.data.user.id,"/firebaseUid")).set(r.user.uid).then((function(){i(r.user.uid).then((function(a){if(a&&a.length)_(a);else{if(l(!1),localforage.setItem("bp_login_token",t.token),F("vibebp").setToken(t.token),localforage.setItem("bp_user",n.data.data.user),sessionStorage.setItem("bp_user",JSON.stringify(n.data.data.user)),e.setUser(n.data.data.user),G("vibebp").setData("firebaseUser",r),n.data.data.user.firebaseUid=r.user.uid,G("vibebp").setUser(n.data.data.user),document.querySelector("body").classList.contains("logged-out")&&document.querySelector("body").classList.remove("logged-out"),document.querySelector("body").classList.contains("logged-in")||document.querySelector("body").classList.add("logged-in"),window.vibebp.settings.login_redirect&&n.hasOwnProperty("redirect_component")&&n.redirect_component){var o="";o=n.redirect_component.split("http").length>1?n.redirect_component:n.redirect_component.split("#").length>1?window.vibebp.settings.login_redirect+n.data.data.user.slug+n.redirect_component:window.vibebp.settings.login_redirect+n.data.data.user.slug+"#"+n.redirect_component,window.location.href=o}fetch("".concat(window.vibebp.api.url,"/loggedinmenu"),{method:"post",body:JSON.stringify({token:t.token})}).then((function(e){return e.json()})).then((function(e){var t;e.status&&(G("vibebp").setData("loggedinMenu",e.menu),G("vibebp").setUser(n.data.data.user)),e.hasOwnProperty("code")&&401==(null===(t=e.data)||void 0===t?void 0:t.status)&&document.dispatchEvent(new Event("vibebp_logout"))}))}}))})).catch((function(a){i(r.user.uid).then((function(a){if(a&&a.length)_(a);else{if(l(!1),localforage.setItem("bp_login_token",t.token),F("vibebp").setToken(t.token),localforage.setItem("bp_user",n.data.data.user),sessionStorage.setItem("bp_user",JSON.stringify(n.data.data.user)),e.setUser(n.data.data.user),G("vibebp").setData("firebaseUser",r),n.data.data.user.firebaseUid=r.user.uid,G("vibebp").setUser(n.data.data.user),document.querySelector("body").classList.contains("logged-out")&&document.querySelector("body").classList.remove("logged-out"),document.querySelector("body").classList.contains("logged-in")||document.querySelector("body").classList.add("logged-in"),window.vibebp.settings.login_redirect&&n.hasOwnProperty("redirect_component")&&n.redirect_component){var o="";o=n.redirect_component.split("http").length>1?n.redirect_component:n.redirect_component.split("#").length>1?window.vibebp.settings.login_redirect+n.data.data.user.slug+n.redirect_component:window.vibebp.settings.login_redirect+n.data.data.user.slug+"#"+n.redirect_component,window.location.href=o}fetch("".concat(window.vibebp.api.url,"/loggedinmenu"),{method:"post",body:JSON.stringify({token:t.token})}).then((function(e){return e.json()})).then((function(e){e.status&&G("vibebp").setData("loggedinMenu",e.menu),G("vibebp").setUser(n.data.data.user)}))}}))}))})).catch((function(r){if(console.log(r),400==r.code||"auth/user-not-found"==r.code||"auth/internal-error"==r.code)console.log("create user in firebase"),firebase.auth().createUserWithEmailAndPassword(n.data.data.user.email,n.data.data.user.refresh_token).then((function(r){if(l(!1),localforage.setItem("bp_login_token",t.token),F("vibebp").setToken(t.token),localforage.setItem("bp_user",n.data.data.user),sessionStorage.setItem("bp_user",JSON.stringify(n.data.data.user)),e.setUser(n.data.data.user),G("vibebp").setData("firebaseUser",r),r.hasOwnProperty("user")?n.data.data.user.firebaseUid=r.user.uid:r.hasOwnProperty("uid")&&(n.data.data.user.firebaseUid=r.uid),fetch("".concat(window.vibebp.api.url,"/storeFirebaseUID?post&client_id=").concat(window.vibebp.settings.client_id),{method:"post",body:JSON.stringify({user:n.data.data.user,token:t.token})}),G("vibebp").setUser(n.data.data.user),document.querySelector("body").classList.contains("logged-out")&&document.querySelector("body").classList.remove("logged-out"),document.querySelector("body").classList.contains("logged-in")||document.querySelector("body").classList.add("logged-in"),window.vibebp.settings.login_redirect&&n.hasOwnProperty("redirect_component")&&n.redirect_component){var a="";a=n.redirect_component.split("http").length>1?n.redirect_component:n.redirect_component.split("#").length>1?window.vibebp.settings.login_redirect+n.data.data.user.slug+n.redirect_component:window.vibebp.settings.login_redirect+n.data.data.user.slug+"#"+n.redirect_component,window.location.href=a}fetch("".concat(window.vibebp.api.url,"/loggedinmenu"),{method:"post",body:JSON.stringify({token:t.token})}).then((function(e){return e.json()})).then((function(e){e.status&&G("vibebp").setData("loggedinMenu",e.menu),G("vibebp").setUser(n.data.data.user)}))})).catch((function(e){console.log("register",e)}));else{if(l(!1),localforage.setItem("bp_login_token",t.token),F("vibebp").setToken(t.token),localforage.setItem("bp_user",n.data.data.user),sessionStorage.setItem("bp_user",JSON.stringify(n.data.data.user)),e.setUser(n.data.data.user),G("vibebp").setUser(n.data.data.user),document.querySelector("body").classList.contains("logged-out")&&document.querySelector("body").classList.remove("logged-out"),document.querySelector("body").classList.contains("logged-in")||document.querySelector("body").classList.add("logged-in"),window.vibebp.settings.login_redirect&&n.hasOwnProperty("redirect_component")&&n.redirect_component){var a="";a=n.redirect_component.split("http").length>1?n.redirect_component:n.redirect_component.split("#").length>1?window.vibebp.settings.login_redirect+n.data.data.user.slug+n.redirect_component:window.vibebp.settings.login_redirect+n.data.data.user.slug+"#"+n.redirect_component,window.location.href=a}fetch("".concat(window.vibebp.api.url,"/loggedinmenu"),{method:"post",body:JSON.stringify({token:t.token})}).then((function(e){return e.json()})).then((function(e){e.status&&G("vibebp").setData("loggedinMenu",e.menu),G("vibebp").setUser(n.data.data.user)}))}})):document.dispatchEvent(new Event("vibebp_logout"))})):(l(!1),_(t.message))})):fetch("".concat(window.vibebp.api.generate_token,"?client_id=").concat(window.vibebp.settings.client_id,"&nocache"),{method:"post",body:JSON.stringify({email:n,password:f})}).then((function(e){return e.json()})).then((function(t){l(!1),t.status?(localforage.setItem("bp_login_token",t.token),F("vibebp").setToken(t.token),fetch("".concat(window.vibebp.api.validate_token,"?nocache&client_id=").concat(window.vibebp.settings.client_id),{method:"post",body:t.token}).then((function(e){return e.json()})).then((function(n){if(n.hasOwnProperty("data")){if(localforage.setItem("bp_user",n.data.data.user),sessionStorage.setItem("bp_user",JSON.stringify(n.data.data.user)),e.setUser(n.data.data.user),window.vibebp.settings.firebase_config&&"undefined"!=typeof firebase&&firebase&&!firebase.auth().currentUser?firebase.auth().signInWithEmailAndPassword(n.data.data.user.email,n.data.data.user.refresh_token).then((function(e){G("vibebp").setData("firebaseUser",e);var t=0;e.hasOwnProperty("user")?t=e.user.uid:e.hasOwnProperty("uid")&&(t=e.uid),G("vibebp").setUser(n.data.data.user),firebase.database().ref("users/".concat(n.data.data.user.id,"/firebaseUid")).set(t)})).catch((function(e){console.log(e),400==e.code||"auth/user-not-found"==e.code||"auth/internal-error"==e.code?firebase.auth().createUserWithEmailAndPassword(n.data.data.user.email,n.data.data.user.refresh_token).then((function(e){var r=0;e.hasOwnProperty("user")?(n.data.data.user.firebaseUid=e.user.uid,r=e.user.uid):e.hasOwnProperty("uid")&&(n.data.data.user.firebaseUid=e.uid,r=e.uid),G("vibebp").setData("firebaseUser",e),firebase.database().ref("users/".concat(n.data.data.user.id,"/firebaseUid")).set(r),fetch("".concat(window.vibebp.api.url,"/storeFirebaseUID?post&client_id=").concat(window.vibebp.settings.client_id),{method:"post",body:JSON.stringify({user:n.data.data.user,token:t.token})}),G("vibebp").setUser(n.data.data.user)})).catch((function(e){console.log("register",e)})):(400==e.code&&e.code,G("vibebp").setUser(n.data.data.user))})):G("vibebp").setUser(n.data.data.user),document.querySelector("body").classList.contains("logged-out")&&document.querySelector("body").classList.remove("logged-out"),document.querySelector("body").classList.contains("logged-in")||document.querySelector("body").classList.add("logged-in"),window.vibebp.settings.login_redirect&&n.hasOwnProperty("redirect_component")&&n.redirect_component){var r="";r=n.redirect_component.split("http").length>1?n.redirect_component:n.redirect_component.split("#").length>1?window.vibebp.settings.login_redirect+n.data.data.user.slug+n.redirect_component:window.vibebp.settings.login_redirect+n.data.data.user.slug+"#"+n.redirect_component,window.location.href=r}fetch("".concat(window.vibebp.api.url,"/loggedinmenu"),{method:"post",body:JSON.stringify({token:t.token})}).then((function(e){return e.json()})).then((function(e){e.status&&G("vibebp").setData("loggedinMenu",e.menu),G("vibebp").setUser(n.data.data.user)}))}else document.dispatchEvent(new Event("vibebp_logout"))}))):_(t.message)}))):_(window.vibebp.translations.login_checkbox)}};return U((function(){w&&document.dispatchEvent(new Event("Vibebp_forgot_password"))}),[w]),wp.element.createElement(R,null,wp.element.createElement("h2",null,w?window.vibebp.translations.forgotpassword:window.vibebp.translations.signin_email_heading),w?wp.element.createElement("p",null,window.vibebp.translations.forgot_password):wp.element.createElement("p",null,window.vibebp.translations.signin_email_description),wp.element.createElement("div",{className:"loginform"},O.length?wp.element.createElement("div",{className:"message"},wp.element.createElement("div",{dangerouslySetInnerHTML:{__html:O}})):wp.element.createElement("div",{className:"field"},wp.element.createElement("div",{className:"control"},wp.element.createElement("label",null,wp.element.createElement("strong",null,window.vibebp.translations.email)),wp.element.createElement("input",{className:s,type:"text",onChange:function(e){r(e.target.value)}}))),w?O.length?"":wp.element.createElement(R,null,wp.element.createElement("a",{className:k?"button is-primary is-loading":"button is-primary",onClick:function(){j(!0),fetch("".concat(window.vibebp.api.url,"/forgotPassword?nocache&client_id=").concat(window.vibebp.settings.client_id),{method:"post",body:JSON.stringify({email:n})}).then((function(e){return e.json()})).then((function(e){j(!1),e.hasOwnProperty("message")&&(G("vibebp").addNotification({text:e.message}),S(e.message),setTimeout((function(){S("")}),5e3))}))}},window.vibebp.translations.password_recovery_email)):wp.element.createElement(R,null,wp.element.createElement("div",{className:"field"},wp.element.createElement("div",{className:"control"},wp.element.createElement("label",null,wp.element.createElement("strong",null,window.vibebp.translations.password),wp.element.createElement("span",{className:"forgot_password",onClick:function(){window.vibebp.settings.hasOwnProperty("forgotpassword_link")&&window.vibebp.settings.forgotpassword_link.length?window.location.href=window.vibebp.settings.forgotpassword_link:g(!0)}},window.vibebp.translations.forgotpassword)),wp.element.createElement("span",{className:M?"vicon vicon-na":"vicon vicon-eye",onClick:function(e){return L(!M)}}),wp.element.createElement("input",{className:"input",type:M?"text":"password",onChange:function(e){b(e.target.value),_("")},onKeyPress:function(e){"Enter"===e.key&&J()}}))),window.vibebp.translations.login_checkbox.length?wp.element.createElement("div",{className:A?"checkbox":"checkbox error"},wp.element.createElement("input",{id:"login_checkbox",type:"checkbox",onClick:function(){return x(!A)}}),wp.element.createElement("label",{for:"login_checkbox",dangerouslySetInnerHTML:{__html:window.vibebp.translations.login_checkbox}})):"",wp.element.createElement("a",{className:o?"button is-primary is-loading":"button is-primary",onClick:J},o&&F("vibebp").getToken()?"...":window.vibebp.translations.signin),h.length?wp.element.createElement("div",{className:"error",dangerouslySetInnerHTML:{__html:h}}):"")),window.vibebp.settings.email_login?w?wp.element.createElement("div",{class:"extra_details"},wp.element.createElement("a",{className:"vibebp_back_link",onClick:function(){g(!1)}},wp.element.createElement("span",{className:"vicon vicon-arrow-left"}),window.vibebp.translations.back_to_signin)):"":wp.element.createElement("div",{class:"extra_details"},wp.element.createElement("a",{className:"vibebp_back_link",onClick:function(){e.setemailSignIn(!1),g(!0)}},wp.element.createElement("span",{className:"vicon vicon-arrow-left"}),window.vibebp.translations.all_signin_options)))};function z(e){return function(e){if(Array.isArray(e))return B(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return B(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var H=wp.element,K=(H.createElement,H.useRef),V=H.useEffect,$=(H.Fragment,H.render,function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=K(Date.now());V((function(){var n=setTimeout((function(){Date.now()-r.current>=t&&(e(),r.current=Date.now())}),t-(Date.now()-r.current));return function(){clearTimeout(n)}}),[t].concat(z(n)))});var W=function(e){try{JSON.parse(e)}catch(e){return!1}return!0};function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){Q(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X(e){return function(e){if(Array.isArray(e))return ne(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||te(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||te(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function te(e,t){if(e){if("string"==typeof e)return ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ne(e,t):void 0}}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var re=wp.element,ae=(re.createElement,re.useState),oe=re.useEffect,ie=(re.Fragment,re.render,wp.data),le=ie.dispatch,ce=ie.select,se=function(e){var t=ee(ae(!0),2),n=(t[0],t[1],ee(ae(e.field),2)),r=n[0],a=(n[1],ee(ae(!1),2)),o=a[0],i=a[1],l=ee(ae({icon:"",url:""}),2),c=l[0],s=l[1],d=ee(ae([]),2),u=d[0],p=d[1];oe((function(){"string"==typeof e.field.value&&e.field.value.length&&p(JSON.parse(e.field.value))}),[]);var m,f=function(t){e.hasOwnProperty("registration")&&e.registration?e.update(r):fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),{method:"post",body:JSON.stringify(Z({field_id:r.id,value:JSON.stringify(t),token:ce("vibebp").getToken()},e))}).then((function(e){return e.json()})).then((function(e){le("vibebp").addNotification({text:e.message})}))};return wp.element.createElement("div",{className:"vibebp_profile_field social"},u.length?wp.element.createElement("div",{className:"social_icons_list"},u.map((function(e,t){return wp.element.createElement("div",{className:"social_icon_wrapper"},wp.element.createElement("div",{className:"social_icon"},wp.element.createElement("span",{className:e.icon}),wp.element.createElement("span",null,e.url)),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){var e=X(u);e.splice(t,1),p(e),f(e)}}))}))):"",wp.element.createElement("a",{className:o?"vicon vicon-close":"vicon vicon-plus",onClick:function(){i(!o)}}),o?wp.element.createElement("div",{className:"add_social_icon"},wp.element.createElement("div",{className:"social_icons"},window.vibebp.social_icons.map((function(e){return wp.element.createElement("div",{className:c.icon===e.icon?"social_icon selected":"social_icon",onClick:function(){s(Z(Z({},c),{},{icon:e.icon}))}},wp.element.createElement("span",{className:e.icon}),wp.element.createElement("span",null,e.label))}))),wp.element.createElement("div",{className:!c.url.length||(m=c.url,/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(m))?"social_icon_url":"social_icon_url error"},wp.element.createElement("input",{type:"text",onChange:function(e){s(Z(Z({},c),{},{url:e.target.value}))},value:c.url})),wp.element.createElement("a",{className:"button is-primary",onClick:function(){if(c.url.length){var e=X(u);e.push(c),p(e),i(!1),s({icon:"",url:""}),f(e)}}},window.vibebp.translations.set_icon)):"")};function de(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?de(Object(n),!0).forEach((function(t){pe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):de(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function me(e){return function(e){if(Array.isArray(e))return ve(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||be(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||be(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function be(e,t){if(e){if("string"==typeof e)return ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ve(e,t):void 0}}function ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var we=wp.element,ge=(we.createElement,we.useState),ye=we.useEffect,he=(we.Fragment,we.render,wp.data),_e=he.dispatch,Ee=he.select,Oe=function(e){var t=fe(ge(!0),2),n=(t[0],t[1],fe(ge(e.field),2)),r=n[0],a=(n[1],fe(ge(!1),2)),o=a[0],i=a[1],l=fe(ge({icon:"",title:"",description:""}),2),c=l[0],s=l[1],d=fe(ge([]),2),u=d[0],p=d[1];ye((function(){"string"==typeof e.field.value&&e.field.value.length&&W(e.field.value)&&p(JSON.parse(e.field.value))}),[]);var m=function(t){e.hasOwnProperty("registration")&&e.registration?e.update(r):fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),{method:"post",body:JSON.stringify({field_id:r.id,value:JSON.stringify(t),token:Ee("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){_e("vibebp").addNotification({text:e.message})}))};return wp.element.createElement("div",{className:"vibebp_profile_field repeatable"},u.length?wp.element.createElement("div",{className:"repeatable_icons_list"},u.map((function(e,t){return wp.element.createElement("div",{className:"repeatable_icon_wrapper"},wp.element.createElement("div",{className:"desc"!=r.rtype?"titled"!=r.rtype?"repeatable_title":"repeatable_icon":"repeatable_desc"},("stacked"==r.rtype||"spaced"==r.rtype)&&e.hasOwnProperty("icon")&&e.icon.length>100?wp.element.createElement("span",{dangerouslySetInnetHTML:{__html:e.icon}}):wp.element.createElement("span",{className:e.icon}),wp.element.createElement("span",null,"desc"!=r.rtype&&e.hasOwnProperty("title")?wp.element.createElement("h4",null,e.title):"",wp.element.createElement("p",null,e.description))),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){var e=me(u);e.splice(t,1),p(e),m(e)}}))}))):"",wp.element.createElement("a",{className:o?"vicon vicon-close":"vicon vicon-plus",onClick:function(){i(!o)}}),o?wp.element.createElement("div",{className:"add_repeatable_icon"},"stacked"==r.rtype||"spaced"==r.rtype?wp.element.createElement("div",{className:"repeatable_icons"},window.vibebp.repeatable_icons.map((function(e){if(!(e.length>100))return wp.element.createElement("div",{className:c.icon===e?"repeatable_icon selected":"repeatable_icon",onClick:function(){s(ue(ue({},c),{},{icon:e}))}},wp.element.createElement("span",{className:e}));wp.element.createElement("div",{className:c.icon===e?"repeatable_icon selected":"repeatable_icon",onClick:function(){s(ue(ue({},c),{},{icon:e}))}},wp.element.createElement("span",{dangerouslySetInnetHTML:{__html:e}}))}))):"",wp.element.createElement("div",{className:"desc"!=r.rtype?"repeatable_title":"repeatable_desc"},"stacked"!=r.rtype&&"spaced"!=r.rtype||!c.icon?"":c.icon.length>100?wp.element.createElement("span",{dangerouslySetInnetHTML:{__html:c.icon}}):wp.element.createElement("span",{className:c.icon}),wp.element.createElement("span",null,"desc"!=r.rtype?wp.element.createElement("input",{type:"text",onChange:function(e){s(ue(ue({},c),{},{title:e.target.value}))},value:c.title,placeholder:window.vibebp.translations.title}):"",wp.element.createElement("input",{type:"text",onChange:function(e){s(ue(ue({},c),{},{description:e.target.value}))},value:c.description,placeholder:window.vibebp.translations.description}))),wp.element.createElement("a",{className:"button is-primary",onClick:function(){var e=me(u);e.push(c),p(e),i(!1),m(e),s({icon:"",title:"",description:""})}},window.vibebp.translations.set_icon)):"")};function Se(e){return(Se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ne(e){return function(e){if(Array.isArray(e))return xe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Ae(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pe(Object(n),!0).forEach((function(t){je(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function je(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||Ae(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ae(e,t){if(e){if("string"==typeof e)return xe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xe(e,t):void 0}}function xe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Te=wp.element,Ce=(Te.createElement,Te.useState),Me=Te.useEffect,Le=(Te.Fragment,Te.render,wp.data),De=Le.dispatch,Ue=Le.select,Re=function(e){var t=Ie(Ce(!0),2),n=t[0],r=t[1],a=Ie(Ce(e.field),2),o=a[0],i=a[1],l=Ie(Ce(),2),c=l[0],s=l[1],d=Ie(Ce(),2),u=d[0],p=d[1],m=Ie(Ce(),2),f=m[0],b=m[1],v=Ie(Ce(),2),w=v[0],g=v[1],y=Ie(Ce(""),2),h=y[0],_=y[1],E=Ie(Ce([]),2),O=E[0],S=E[1],N=Ie(Ce(!1),2),P=N[0],k=N[1];Me((function(){if(Array.isArray(e.field.value)){var t=e.field.value,n={lat:t[0],lng:t[1],address:t[2],zipcode:t[3],city:t[4],country:t[5]};i(ke(ke({},e.field),{},{value:n}))}}),[e.field]);$((function(){if(!n){var e=new google.maps.places.AutocompleteService;h.length&&e.getQueryPredictions({input:h},(function(e,t){if(t==google.maps.places.PlacesServiceStatus.OK){var n=Ne(O);e.forEach((function(e){n.push(e.description)})),S(n)}}))}}),500,[h]),Me((function(){if(c)if(window.hasOwnProperty("google")&&window.google.hasOwnProperty("maps")){var e={lat:-34.397,lng:150.644},t={zoom:16,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP,imageDefaultUI:!0},n=new google.maps.Map(c,t);p(n);var a=new google.maps.Marker({map:n,position:e,animation:google.maps.Animation.DROP});b(a),r(!1),g(new google.maps.Geocoder)}else{var o=window.document.createElement("script");o.src="https://maps.googleapis.com/maps/api/js?key=".concat(window.vibebp.settings.google_maps_api_key,"&libraries=places"),o.async=!0,window.document.body.appendChild(o),o.addEventListener("load",(function(){var e={lat:-34.397,lng:150.644},t={zoom:16,center:e,mapTypeId:google.maps.MapTypeId.ROADMAP,imageDefaultUI:!0},n=new google.maps.Map(c,t);p(n);var a={url:window.vibebp.settings.map_marker,size:new google.maps.Size(51,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(21,30)},o=new google.maps.Marker({map:n,position:e,animation:google.maps.Animation.DROP,draggable:!0,icon:a});b(o),r(!1),g(new google.maps.Geocoder)}))}}),[c]),Me((function(){if(f){var e,t;(null===(e=window.google)||void 0===e||null===(t=e.maps)||void 0===t?void 0:t.event)&&window.google.maps.event.addListener(f,"dragend",(function(e){(new google.maps.Geocoder).geocode({location:e.latLng},(function(e,t){"OK"==t&&(console.log(e),u.setCenter(e[0].geometry.location),i(ke(ke({},o),{},{value:{lat:e[0].geometry.location.lat(),lng:e[0].geometry.location.lng(),address:e[0].formatted_address,zipcode:e[0].address_components[e[0].address_components.findIndex((function(e){return-1!==e.types.indexOf("postal_code")}))].long_name,city:e[0].address_components[e[0].address_components.findIndex((function(e){return-1!==e.types.indexOf("locality")}))].long_name,country:e[0].address_components[e[0].address_components.findIndex((function(e){return-1!==e.types.indexOf("country")}))].long_name}})))}))}))}return function(){var e,t;null===(e=window.google)||void 0===e||null===(t=e.maps)||void 0===t||t.event}}),[f]),Me((function(){if("object"==Se(o.value)&&u&&f){console.log("--\x3e");var e=new google.maps.LatLng(o.value.lat,o.value.lng);u.setCenter(e),f.setPosition(e)}}),[o,u,f]),Me((function(){if(!n)if(o.value){var e={lat:-34.397,lng:150.644},t=o.value;if(Array.isArray(t)||"string"!=typeof t?e={lat:parseFloat(o.value.lat),lng:parseFloat(o.value.lng)}:t.split(","),t.length){var r=ke({},o);6===t.length&&(r.value={lat:t[0],lng:t[1],address:t[2],zipcode:t[3],city:t[4],country:t[5]}),i(r),e={lat:parseFloat(r.value.lat),lng:parseFloat(r.value.lng)}}if(u){var a={url:window.vibebp.settings.map_marker,size:new google.maps.Size(51,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(21,30)},l=new google.maps.Marker({map:u,position:e,animation:google.maps.Animation.DROP,draggable:!0,icon:a});b(l)}}else I()}),[n]);var j=function(){w&&(new google.maps.Geocoder).geocode({address:h},(function(e,t){"OK"==t&&(u.setCenter(e[0].geometry.location),console.log(e[0].geometry.location),f.setPosition(e[0].geometry.location)),S([])}))},I=function(){"geolocation"in navigator?navigator.geolocation.getCurrentPosition((function(e){var t=ke({},o);t.value=[e.coords.latitude,e.coords.longitude],i(t);var n=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);console.log(n),u.setCenter(n),f.setPosition(n),w&&w.geocode({location:{lat:e.coords.latitude,lng:e.coords.longitude}}).then((function(e){console.log(e)}),(function(e){console.error(e)}))})):fetch("http://ip-api.com/json",{method:"get"}).then((function(e){return e.json()})).then((function(e){console.log(e);var t=ke({},o);t.value={lat:e.lat,lng:e.lng},i(t);new google.maps.LatLng(e.lat,e.lng);w&&w.geocode({location:{lat:e.lat,lng:e.lng}}).then((function(e){console.log(e)}),(function(e){console.error(e)}))}));var e={url:window.vibebp.settings.map_marker,size:new google.maps.Size(51,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(21,30)},t=new google.maps.Marker({map:u,position:{lat:o.value.lat,lng:o.value.lng},animation:google.maps.Animation.DROP,draggable:!0,icon:e});b(t)};return wp.element.createElement("div",{className:"vibebp_profile_field location"},wp.element.createElement("div",{className:"search_me"},wp.element.createElement("span",{className:"vicon vicon-target",onClick:I}),wp.element.createElement("input",{type:"text",value:h,onChange:function(e){_(e.target.value)}}),h.length?wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){_(""),S([])}}):"",wp.element.createElement("span",{className:h.length?"vicon vicon-search is_active":"vicon vicon-search",onClick:j})),O.length?wp.element.createElement("div",{className:"vibebp_autocomplete_results"},O.map((function(e){return wp.element.createElement("div",{className:"vibebp_autocomplete_result",onClick:function(){_(e),S([]),j()}},e)}))):"",wp.element.createElement("div",{className:"google_map_locator"},n?wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"",wp.element.createElement("div",{ref:function(e){e&&!c&&s(e)},style:{height:"400px",width:"100%"}})),wp.element.createElement("div",{className:"google_map_details"},wp.element.createElement("textarea",{placeholder:window.vibebp.translations.address,onChange:function(e){i(ke(ke({},o),{},{value:ke(ke({},o.value),{},{address:e.target.value})}))},value:o.value.hasOwnProperty("address")?o.value.address:""}),wp.element.createElement("div",{className:"gmap_fields"},wp.element.createElement("input",{type:"text",onChange:function(e){i(ke(ke({},o),{},{value:ke(ke({},o.value),{},{zipcode:e.target.value})}))},placeholder:window.vibebp.translations.zipcode,value:o.value.hasOwnProperty("zipcode")?o.value.zipcode:""}),wp.element.createElement("input",{type:"text",onChange:function(e){i(ke(ke({},o),{},{value:ke(ke({},o.value),{},{city:e.target.value})}))},placeholder:window.vibebp.translations.city,value:o.value.hasOwnProperty("city")?o.value.city:""}),wp.element.createElement("input",{type:"text",placeholder:window.vibebp.translations.country,value:o.value.hasOwnProperty("country")?o.value.country:""}),o.value.zipcode?wp.element.createElement("a",{className:P?"button is-loading":"button",onClick:function(){k(!0),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),{method:"post",body:JSON.stringify(ke({field_id:o.id,type:"location",value:o.value,token:Ue("vibebp").getToken()},e))}).then((function(e){return e.json()})).then((function(e){k(!1),e.hasOwnProperty("message")&&De("vibebp").addNotification({text:e.message})}))}},window.vibebp.translations.save_changes):"")))};function Je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Je(Object(n),!0).forEach((function(t){Ge(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qe(e){return function(e){if(Array.isArray(e))return He(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Be(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||Be(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Be(e,t){if(e){if("string"==typeof e)return He(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?He(e,t):void 0}}function He(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ke=wp.element,Ve=(Ke.createElement,Ke.render,Ke.useState),$e=Ke.useEffect;Ke.useContext,Ke.Fragment,Ke.RawHTML;function We(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))if(n){for(var r=0;r<t.length;r++)if(t[r][n]===e[n])return r}else for(var a=0;a<t.length;a++)if(t[a].name===e.name)return a;return-1}var Ye=function(e){var t=ze(Ve({}),2),n=t[0],r=t[1],a=ze(Ve(""),2),o=(a[0],a[1]),i=ze(Ve([]),2),l=i[0],c=i[1],s=ze(Ve([]),2),d=s[0],u=s[1],p=ze(Ve(!1),2),m=p[0],f=p[1],b=ze(Ve(!1),2),v=b[0],w=b[1],g=ze(Ve(!1),2),y=(g[0],g[1]);$e((function(){if(e.field&&e.field.hasOwnProperty("value")&&e.field.value.length&&e.field.options&&e.field.options.length){var t=[];e.field.value.map((function(n){e.field.options.map((function(e){e.value!=n&&e.name!=n||t.push(e)}))})),u(t)}e.field.options&&e.field.options.length&&Array.isArray(e.field.options)&&(f(!0),c(qe(e.field.options)),f(!1)),r(e.field),y(!0)}),[e.field]);var h="search_results";return v&&(h="search_results active"),wp.element.createElement("div",{className:"selectcptfield multiselect"},wp.element.createElement("div",{className:"selectcptfield_list"},d.length?wp.element.createElement("div",{className:"selectcptfield_items"},d.map((function(t){var a=n.cpt?n.multiselect:"";return wp.element.createElement("span",{type:a,onClick:function(){var a=qe(d),o=qe(l);a.splice(We(t,d,"name"),1),o.push(t),c(o),u(a);var i=Fe({},n);if(a&&a.length){var s=[];a.map((function(e){e.hasOwnProperty("name")&&s.push(e.name)})),i.value=s,i.show_value=a,r(i),e.update(i,e.fieldIndex,"fieldvaluechanged")}else i.value=[],i.show_value=[],r(i),e.update(i,e.fieldIndex,"fieldvaluechanged")}},t.name)}))):""),wp.element.createElement("div",{className:"selectimitate",onClick:function(){w(!v)}},v?wp.element.createElement("i",{class:"vicon vicon-angle-up","aria-hidden":"true"}):wp.element.createElement("i",{class:"vicon vicon-angle-down","aria-hidden":"true"}),l.length?wp.element.createElement("div",{className:h},l.map((function(t,a){if(-1===We(t,d,"name"))return wp.element.createElement("div",{className:"search_result selectcpt",onClick:function(){o("");var i=qe(d);if(-1===We(t,i,"name")){i.push(t),l.splice(a,1),u(i);var c=Fe({},n);if(i&&i.length){var s=[];i.map((function(e){e.hasOwnProperty("name")&&s.push(e.name)})),c.value=s,c.show_value=i,r(c),e.update(c,e.fieldIndex,"fieldvaluechanged")}}}},wp.element.createElement("span",null,t.name))}))):m?"......":""))};function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){Xe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Xe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function et(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return tt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var nt=wp.element,rt=(nt.createElement,nt.render,nt.useState),at=nt.useEffect,ot=nt.Fragment,it=(nt.useContext,wp.data),lt=it.dispatch,ct=it.select,st=function(e){var t=et(rt(!1),2),n=(t[0],t[1],et(rt({}),2)),r=n[0],a=n[1],o=et(rt(!1),2),i=(o[0],o[1],et(rt(0),2)),l=i[0],c=(i[1],et(rt(""),2)),s=c[0],d=c[1];at((function(){s.length&&setTimeout((function(){d("")}),5e3)}),[s]),at((function(){e.field.hasOwnProperty("value")&&void 0!==e.field.value&&e.field.value.hasOwnProperty("url")&&a(e.field.value)}),[e.field]);var u=function(t){void 0===t&&(t=r),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),{method:"post",body:JSON.stringify(Qe({field_id:e.field.id,type:e.field.type,value:t,token:ct("vibebp").getToken()},e))}).then((function(e){return e.json()})).then((function(e){lt("vibebp").addNotification({text:e.message})}))},p=function(){a({}),u({}),fetch("".concat(window.vibebp.api.url,"/user/delete_media?post"),{method:"post",body:JSON.stringify({token:ct("vibebp").getToken(),media:r})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&lt("vibebp").addNotification({text:e.message})}))};return wp.element.createElement(ot,null,r&&r.hasOwnProperty("url")?wp.element.createElement("div",{className:"single_media"},function(e){if(e.hasOwnProperty("url"))return wp.element.createElement("div",{className:"media_snapashot"},wp.element.createElement("a",{href:e.url,target:"_blank"},e.name),wp.element.createElement("span",{className:"vicon vicon-close",onClick:p}))}(r)):wp.element.createElement("div",{className:"upload_media"},wp.element.createElement("label",{for:"vibe_editor_upload_media",style:{border:"1px dotted var(--darkborder)",padding:"1rem"}},l?wp.element.createElement("div",{className:"vibebp_progress_wrapper"},wp.element.createElement("span",{className:"progress_wrapper"},wp.element.createElement("span",{className:"progress_bar",style:{width:l+"%"}})),wp.element.createElement("span",null,l,"%")):wp.element.createElement("span",{className:"vicon vicon-plus"})),wp.element.createElement("input",{type:"file",id:"vibe_editor_upload_media",onChange:function(t){!function(t){if(t.target.files[0]){var n=t.target.files[0],r=n.size/1024/1024,o=[];if(e.field.all_upload_types&&Array.isArray(e.field.upload_types)&&e.field.upload_types.length&&e.field.upload_types.map((function(t){e.field.all_upload_types.hasOwnProperty(t)&&e.field.all_upload_types[t].length&&e.field.all_upload_types[t].map((function(e){o.push(e)}))})),-1===o.indexOf(n.type))return d(window.vibebp.translations.file_type_not_allowed),!1;if(parseInt(e.field.upload_size)<r)return d(window.vibebp.translations.file_size_error+" "+e.field.upload_size+"MB"),!1;var i=new FormData;i.append("file",t.target.files[0]),i.append("body",JSON.stringify({token:ct("vibebp").getToken()})),fetch("".concat(window.vibebp.api.url,"/user/upload_media?upload"),{method:"post",body:i}).then((function(e){return e.json()})).then((function(e){e.status?(a(e.data),u(e.data)):e.hasOwnPropoerty("message")&&lt("vibebp").addNotification({text:e.message})}))}}(t)},style:{visibility:"hidden"}}),wp.element.createElement("div",{className:"file_restrictions_info"},wp.element.createElement("div",{className:"allowed_file_types"},e.field.hasOwnProperty("upload_types")&&e.field.upload_types.length?wp.element.createElement(ot,null,wp.element.createElement("span",null,window.vibebp.translations.allowed_file_types),wp.element.createElement("div",null,e.field.upload_types.map((function(e){return wp.element.createElement("span",null,e)})))):""),wp.element.createElement("div",{className:"allowed_file_size"},e.field.hasOwnProperty("upload_size")&&e.field.upload_size?wp.element.createElement(ot,null,wp.element.createElement("span",null,window.vibebp.translations.max_size),wp.element.createElement("span",null,e.field.upload_size+" MB")):"")),s&&s.length?wp.element.createElement("div",{className:"vbp_message vbp_error"},s):""))};function dt(e){return(dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ut(e){return function(e){if(Array.isArray(e))return wt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||vt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pt(Object(n),!0).forEach((function(t){ft(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ft(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||vt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vt(e,t){if(e){if("string"==typeof e)return wt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wt(e,t):void 0}}function wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var gt=wp.element,yt=(gt.createElement,gt.render,gt.useState),ht=gt.useEffect,_t=gt.Fragment,Et=(gt.useContext,wp.data),Ot=Et.dispatch,St=Et.select,Nt=function(e){var t=bt(yt(!1),2),n=t[0],r=t[1],a=bt(yt([]),2),o=a[0],i=a[1],l=bt(yt([]),2),c=l[0],s=(l[1],bt(yt(!1),2)),d=s[0],u=s[1],p=bt(yt(!1),2),m=p[0],f=p[1],b=bt(yt(0),2),v=b[0],w=b[1],g=bt(yt("media"),2),y=g[0],h=g[1],_=bt(yt((function(){var t={posts_per_page:20,paged:1,search_terms:"",orderby:""};return e.hasOwnProperty("post_mime_type")&&void 0!==e.post_mime_type&&(t.post_mime_type=e.post_mime_type),t})),2),E=_[0],O=_[1],S=bt(yt(""),2),N=S[0],P=S[1],k=bt(yt([]),2),j=(k[0],k[1],bt(yt({name:"",url:"",type:"file"}),2)),I=j[0],A=j[1];ht((function(){return document.querySelector(".vibebp_myprofile")&&document.querySelector(".vibebp_myprofile").classList.add("popup_active"),function(){document.querySelector(".vibebp_myprofile.popup_active")&&document.querySelector(".vibebp_myprofile").classList.remove("popup_active")}}),[]),$((function(){fetch("".concat(window.vibebp.api.url,"/user/fetch_media?").concat(E.search_terms.length?"nocache":encodeURIComponent(JSON.stringify(mt(mt({},E),{},{search_terms:""})))),{method:"post",body:JSON.stringify(mt(mt({},E),{},{token:St("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){if(r(!1),e.status)if(m){var t=ut(o);e.data.map((function(e){t.push(e)})),i(t),f(!1),t.length<parseInt(data.total)?u(!0):u(!1)}else i(e.data),e.data.length<parseInt(e.total)?u(!0):u(!1)}))}),500,[E]);var x=function(){O(mt({},E))};ht((function(){return document.addEventListener("vibebp_component_reload",x),function(){document.removeEventListener("vibebp_component_reload",x)}})),ht((function(){N.length&&setTimeout((function(){P("")}),5e3)}),[N]);var T=function(t){e.share(t)},C=function(e){switch(e.type){case"image":return wp.element.createElement("img",{src:e.url,className:"content_to_html_image"});case"video":return wp.element.createElement("video",{class:"video_plyr"},wp.element.createElement("source",{src:e.url,type:"video/mp4"}));case"audio":return wp.element.createElement("audio",{class:"audio_plyr"},wp.element.createElement("source",{src:e.url,type:"audio/mp3"}));case"document":return wp.element.createElement("span",{class:"modal_document"},e.name)}};return wp.element.createElement("div",{className:"vibe_editor_modal"},wp.element.createElement("span",{onClick:function(t){e.close(!1)}}),wp.element.createElement("div",{className:"ve_modal-content"},wp.element.createElement("div",{className:"ve_modal-header"},wp.element.createElement("div",null,window.vibebp.settings.media_tabs?Object.keys(window.vibebp.settings.media_tabs).map((function(t){if("upload"!=t||!window.vibebp.settings.hasOwnProperty("upload_capability")||!window.vibebp.settings.upload_capability)return wp.element.createElement("a",{className:y==t?"active":"",onClick:function(){h(t)}},window.vibebp.settings.media_tabs[t]);var n=St("vibebp").getUser();if(void 0!==n&&n.hasOwnProperty("caps")&&void 0!==n.caps){var r=0;if(Array.isArray(n.caps)?n.caps.findIndex((function(e,t){return e==window.vibebp.settings.upload_capability}))>-1&&(r=1):"object"===dt(n.caps)&&Object.keys(n.caps).map((function(e,t){e===window.vibebp.settings.upload_capability&&n.caps[e]&&(r=1)})),e.hasOwnProperty("allow_upload")&&e.allow_upload&&(r=1),r)return wp.element.createElement("a",{className:y==t?"active":"",onClick:function(){h(t)}},window.vibebp.settings.media_tabs[t])}})):""),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(t){e.close(!1)}})),wp.element.createElement("div",{className:"ve_modal-body"},"media"==y?wp.element.createElement(_t,null,wp.element.createElement("div",{className:"vibebp_form"},wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("input",{type:"text",placeholder:window.vibebp.translations.search_text,onChange:function(e){return O(mt(mt({},E),{},{search_terms:e.target.value}))}})),wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("select",{onChange:function(e){O(mt(mt({},E),{},{order:e.target.value}))}},Object.keys(window.vibeEditor.media_order).map((function(e){return wp.element.createElement("option",{value:e},window.vibeEditor.media_order[e])}))))),n?wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):o&&o.length?wp.element.createElement("div",{className:"allMedia"},o.map((function(t,n){return wp.element.createElement("div",{className:"single_media"},wp.element.createElement("span",{onClick:function(n){T(t),e.hasOwnProperty("autoclose")||e.close(!1)}},C(t)),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){return function(e){var t=ut(o);t.splice(t.findIndex((function(t){return t.id==e.id})),1),i(t),fetch("".concat(window.vibebp.api.url,"/user/delete_media?post"),{method:"post",body:JSON.stringify({token:St("vibebp").getToken(),media:e})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&Ot("vibebp").addNotification({text:e.message})}))}(t)}}))}))):wp.element.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_media),d?wp.element.createElement("a",{className:"link",onClick:function(){O(mt(mt({},E),{},{paged:E.paged+1})),f(!0)}},window.vibebp.translations.more):""):"upload"===y?wp.element.createElement(_t,null,wp.element.createElement("div",{className:"upload_media"},wp.element.createElement("label",{for:"vibe_editor_upload_media"},window.vibebp.translations.upload_media,v?wp.element.createElement("div",{className:"vibebp_progress_wrapper"},wp.element.createElement("span",{className:"progress_wrapper"},wp.element.createElement("span",{className:"progress_bar",style:{width:v+"%"}})),wp.element.createElement("span",null,v,"%")):wp.element.createElement("span",{className:"vicon vicon-plus"})),wp.element.createElement("input",{type:"file",id:"vibe_editor_upload_media",onChange:function(t){return function(t){var n=e.post_mime_type,r=e.allowed_file_size;if(void 0===r&&(r=window.vibebp.settings.upload_limit),void 0===n||!Array.isArray(n)){var a=n;(n=[]).push(a)}if(t.target.files[0]){var l=t.target.files[0].size/1024/1024;if(n.indexOf(t.target.files[0].type)<=-1)return P(window.vibebp.translations.allowed_file_types+" "+n.join(",")),!1;if(r<l)return P(window.vibebp.translations.file_size_error+" "+r+"Mb"),!1;if(tus.isSupported&&tus.canStoreURLs&&l>4){var c="".concat(window.vibebp.api.url,"/user/upload_media_stream?upload"),s=new tus.Upload(t.target.files[0],{endpoint:c,chunkSize:2097152,retryDelays:[0,3e3],metadata:{token:St("vibebp").getToken(),filename:t.target.files[0].name,filetype:t.target.files[0].type},onError:function(e){e.hasOwnProperty("message")&&Ot("vibebp").addNotification({text:e.message})},onProgress:function(t,n){var r=(t/n*100).toFixed(2);w(r),100==r&&setTimeout((function(){var t={posts_per_page:20,paged:1,search_terms:"",orderby:""};e.hasOwnProperty("post_mime_type")&&void 0!==e.post_mime_type&&(t.post_mime_type=e.post_mime_type),O(t),w(0),h("media")}),500)},onSuccess:function(){localStorage.removeItem(s._urlStorageKey),s.url=s.url.replace("?upload",""),fetch("".concat(s.url,"/complete_stream?nocache"),{method:"post",body:JSON.stringify({token:St("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){if(t.status){e.hasOwnProperty("post_mime_type")&&void 0!==e.post_mime_type&&e.post_mime_type,w(0),h("media")}t.hasOwnProperty("message")&&Ot("vibebp").addNotification({text:t.message})}))}});s.findPreviousUploads().then((function(e){e.length>0&&s.resumeFromPreviousUpload(e[0]),s.start()})),tus.Upload.terminate(c).then((function(){})).catch((function(e){}))}else{var d=new FormData;d.append("file",t.target.files[0]),d.append("body",JSON.stringify({token:St("vibebp").getToken()})),fetch("".concat(window.vibebp.api.url,"/user/upload_media?upload"),{method:"post",body:d}).then((function(e){return e.json()})).then((function(e){if(e.status){var t=ut(o);t.unshift(e.data),i(t),h("media")}else e.hasOwnPropoerty("message")&&Ot("vibebp").addNotification({text:e.message})}))}}}(t)}}),c&&c.length?wp.element.createElement("div",{className:"uploaded"},wp.element.createElement("strong",null,window.vibebp.translations.uploaded_media),wp.element.createElement("div",{className:"uploaded_files"},c.map((function(e,t){return wp.element.createElement("div",{className:"single_media",onClick:function(t){T(e)}},C(e))})))):""),N&&N.length?wp.element.createElement("div",{className:"vbp_message vbp_error"},N):""):"embed"===y?wp.element.createElement(_t,null,wp.element.createElement("div",{className:"embed_media"},wp.element.createElement("label",{for:"vibe_editor_embed_name"}," ",window.vibebp.translations.enter_emabed_name," "),wp.element.createElement("input",{type:"text",id:"vibe_editor_embed_name",onChange:function(e){return A(mt(mt({},I),{},{name:e.target.value}))}}),wp.element.createElement("label",{for:"vibe_editor_embed_url"}," ",window.vibebp.translations.enter_embed_url," "),wp.element.createElement("input",{type:"text",id:"vibe_editor_embed_url",onChange:function(e){return A(mt(mt({},I),{},{url:e.target.value}))}}),wp.element.createElement("select",{onChange:function(e){return A(mt(mt({},I),{},{type:e.target.value}))},value:I.type},e.hasOwnProperty("embed_options")?e.embed_options.map((function(e){return wp.element.createElement("option",{value:e},e.charAt(0).toUpperCase()+e.slice(1))})):Object.keys(window.vibeEditor.embed_types).map((function(t){if(e.hasOwnProperty("post_mime_type")&&void 0!==e.post_mime_type)if(Array.isArray(e.post_mime_type)){if(e.post_mime_type.indexOf(t)<0)return}else if(e.post_mime_type.split(",").indexOf(t)<0)return;return wp.element.createElement("option",{value:t},window.vibeEditor.embed_types[t])}))),Object.values(I).findIndex((function(e){return""==e||null==e}))>-1?"":wp.element.createElement("button",{className:"button is-primary",onClick:function(){T(I),e.close(!1)}},window.vibebp.translations.embed))):wp.element.createElement("div",{className:y}))))};function Pt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pt(Object(n),!0).forEach((function(t){jt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function jt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function It(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return At(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return At(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function At(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var xt=wp.element,Tt=(xt.createElement,xt.render,xt.useState),Ct=xt.useEffect,Mt=xt.Fragment,Lt=(xt.useContext,xt.useRef),Dt=wp.data,Ut=Dt.dispatch,Rt=Dt.select,Jt=function(e){var t=Lt(null),n=It(Tt(!1),2),r=(n[0],n[1],It(Tt({}),2)),a=r[0],o=r[1],i=It(Tt(!1),2),l=(i[0],i[1],It(Tt(0),2)),c=(l[0],l[1],It(Tt(""),2)),s=c[0],d=c[1],u=It(Tt(!1),2),p=u[0],m=u[1],f=It(Tt([]),2),b=f[0],v=f[1],w=It(Tt(null),2),g=w[0],y=w[1];Ct((function(){s.length&&setTimeout((function(){d("")}),5e3)}),[s]),Ct((function(){e.field.hasOwnProperty("value")&&void 0!==e.field.value&&e.field.value.hasOwnProperty("url")&&o(e.field.value);var t=[];e.field.all_upload_types&&Array.isArray(e.field.upload_types)&&e.field.upload_types.length&&e.field.upload_types.map((function(n){e.field.all_upload_types.hasOwnProperty(n)&&e.field.all_upload_types[n].length&&e.field.all_upload_types[n].map((function(e){t.push(e)}))})),t.push("video"),v(t)}),[e.field]),Ct((function(){if(a&&a.hasOwnProperty("type")&&t.current){if("video"==a.type){var e=new Plyr(t.current);y(e)}if("youtube"==a.type){var n=new Plyr(t.current);y(n)}if("vimeo"==a.type){var r=new Plyr(t.current);y(r)}}}),[a]);var h=function(t){void 0===t&&(t=a),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),{method:"post",body:JSON.stringify(kt({field_id:e.field.id,type:e.field.type,value:t,token:Rt("vibebp").getToken()},e))}).then((function(e){return e.json()})).then((function(e){Ut("vibebp").addNotification({text:e.message})}))},_=function(e){var t=e.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&|?]+)/);return!(!t||!t.length)&&t[1]};return wp.element.createElement("div",{className:"video_field"},a&&a.hasOwnProperty("url")?wp.element.createElement("div",null,wp.element.createElement("div",{className:"single_media"},wp.element.createElement("div",null,wp.element.createElement("span",{className:"remove vicon vicon-close",onClick:function(){g&&(g.destroy(),y(null)),h(null),o({})}}),wp.element.createElement("div",null,"  ",wp.element.createElement("div",null," ",function(e){switch(e.type){case"image":return wp.element.createElement("img",{src:e.url,className:"content_to_html_image"});case"video":return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("video",{ref:t,class:"video_plyr"},wp.element.createElement("source",{src:e.url,type:"video/mp4"})));case"youtube":var n=_(a.url);return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("div",{ref:t,"data-plyr-provider":"youtube","data-plyr-embed-id":n}));case"vimeo":var r=e.url.match(/(http|https)?:\/\/(www\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/);return wp.element.createElement("div",{className:"video_wrapper"}," ",wp.element.createElement("div",{ref:t,"data-plyr-provider":"vimeo","data-plyr-embed-id":r[4]}));case"audio":return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("audio",{class:"audio_plyr",controls:!0},wp.element.createElement("source",{src:e.url,type:"audio/mp3"})));default:if(void 0!==e.url&&e.type)return e.url.split(".pdf").length>1?wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("embed",{width:"200px",height:"300px",controls:!0,type:"application/pdf",src:e.url}),wp.element.createElement("div",{className:"embed_block"})):wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("a",{href:e.url},wp.element.createElement("span",{className:"vicon vicon-clip"})))}}(a)))," "))):wp.element.createElement("div",{className:"upload_media"},wp.element.createElement("label",{for:"vibe_editor_upload_media_wrap",style:{border:"1px dotted var(--darkborder)",padding:"1rem"},onClick:function(){m(!0)}},wp.element.createElement("span",{className:"vicon vicon-plus"})),wp.element.createElement("div",{className:"file_restrictions_info"},wp.element.createElement("div",{className:"allowed_file_types"},e.field.hasOwnProperty("upload_types")&&e.field.upload_types.length?wp.element.createElement(Mt,null,wp.element.createElement("span",null,window.vibebp.translations.allowed_file_types),wp.element.createElement("div",null,e.field.upload_types.map((function(e){return wp.element.createElement("span",null,e)})))):""),wp.element.createElement("div",{className:"allowed_file_size"},e.field.hasOwnProperty("upload_size")&&e.field.upload_size?wp.element.createElement(Mt,null,wp.element.createElement("span",null,window.vibebp.translations.max_size),wp.element.createElement("span",null,e.field.upload_size+" MB")):"")),s&&s.length?wp.element.createElement("div",{className:"vbp_message vbp_error"},s):"",p?wp.element.createElement(Nt,{post_mime_type:b,allowed_file_size:e.field.upload_size,close:function(){m(!1)},share:function(e){if(e.hasOwnProperty("type")&&["youtube","vimeo"].includes(e.type))if("youtube"==e.type){if(!_(e.url))return d(window.vibebp.translations.invalid_url),!1}else if("vimeo"==e.type){if(!e.url.match(/(http|https)?:\/\/(www\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/))return d(window.vibebp.translations.invalid_url),!1}o(e),h(e)},embed_options:["video","youtube","vimeo"]}):""))};function Ft(e){return function(e){if(Array.isArray(e))return Kt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Ht(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(n),!0).forEach((function(t){zt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function zt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||Ht(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ht(e,t){if(e){if("string"==typeof e)return Kt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Kt(e,t):void 0}}function Kt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Vt=wp.element,$t=(Vt.createElement,Vt.render,Vt.useState),Wt=Vt.useEffect,Yt=Vt.Fragment,Zt=(Vt.useContext,Vt.useRef),Qt=wp.data,Xt=Qt.dispatch,en=Qt.select,tn=function(e){var t=Zt(null),n=Bt($t(!1),2),r=(n[0],n[1],Bt($t([]),2)),a=r[0],o=r[1],i=Bt($t(!1),2),l=(i[0],i[1],Bt($t(0),2)),c=(l[0],l[1],Bt($t(""),2)),s=c[0],d=c[1],u=Bt($t(!1),2),p=u[0],m=u[1],f=Bt($t([]),2),b=f[0],v=f[1],w=Bt($t(null),2),g=w[0],y=w[1];Wt((function(){s.length&&setTimeout((function(){d("")}),5e3)}),[s]),Wt((function(){e.field.hasOwnProperty("value")&&void 0!==e.field.value&&e.field.value.length&&(W(e.field.value)?o(JSON.parse(e.field.value)):o(e.field.value));var t=[];e.field.all_upload_types&&Array.isArray(e.field.upload_types)&&e.field.upload_types.length&&e.field.upload_types.map((function(n){e.field.all_upload_types.hasOwnProperty(n)&&e.field.all_upload_types[n].length&&e.field.all_upload_types[n].map((function(e){t.push(e)}))})),t.push("image"),v(t)}),[e.field]);var h=function(t){if(void 0===t&&(t=a),e.hasOwnProperty("registration")&&e.registration)e.update(field);else{g&&g.abort();var n={},r=new AbortController;g&&(n={signal:r.signal}),y(r),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),qt(qt({method:"post"},n),{},{body:JSON.stringify(qt({field_id:e.field.id,type:e.field.type,value:t,token:en("vibebp").getToken()},e))})).then((function(e){return e.json()})).then((function(e){y(null),m(!1),Xt("vibebp").addNotification({text:e.message})}))}};return wp.element.createElement("div",{className:"gallery_field"},wp.element.createElement("div",{className:"upload_media"},a&&a.length?wp.element.createElement("div",{className:"media_gallery"},a.map((function(e,n){return wp.element.createElement("div",null,wp.element.createElement("div",{className:"single_media"},wp.element.createElement("div",null,wp.element.createElement("span",{className:"remove vicon vicon-close",onClick:function(){var e=Ft(a);e.splice(n,1),h(e),o(e)}}),wp.element.createElement("div",null,"  ",wp.element.createElement("div",null," ",function(e){switch(e.type){case"image":return wp.element.createElement("img",{src:e.url,className:"content_to_html_image"});case"video":return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("video",{ref:t,class:"video_plyr"},wp.element.createElement("source",{src:e.url,type:"video/mp4"})));default:if(void 0!==e.url&&e.type)return e.url.split(".pdf").length>1?wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("embed",{width:"200px",height:"300px",controls:!0,type:"application/pdf",src:e.url}),wp.element.createElement("div",{className:"embed_block"})):wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("a",{href:e.url},wp.element.createElement("span",{className:"vicon vicon-clip"})))}}(e)))," ")))}))):"",wp.element.createElement("label",{for:"vibe_editor_upload_media_wrap",onClick:function(){m(!0)}},wp.element.createElement("span",{className:"vicon vicon-plus"})),wp.element.createElement("div",{className:"file_restrictions_info"},wp.element.createElement("div",{className:"allowed_file_types"},e.field.hasOwnProperty("upload_types")&&e.field.upload_types.length?wp.element.createElement(Yt,null,wp.element.createElement("strong",null,window.vibebp.translations.allowed_file_types),wp.element.createElement("div",null,e.field.upload_types.map((function(e){return wp.element.createElement("span",null,e)})))):""),wp.element.createElement("div",{className:"allowed_file_size"},e.field.hasOwnProperty("upload_size")&&e.field.upload_size?wp.element.createElement(Yt,null,wp.element.createElement("strong",null,window.vibebp.translations.max_size),wp.element.createElement("span",null,e.field.upload_size+" MB")):"")),s&&s.length?wp.element.createElement("div",{className:"vbp_message vbp_error"},s):"",p?wp.element.createElement(Nt,{post_mime_type:b,autoclose:"1",allowed_file_size:e.field.upload_size,close:function(){m(!1)},share:function(e){if(e.hasOwnProperty("type")&&e.hasOwnProperty("url")){var t=Ft(a);t.push(e),o(t),h(t)}},embed_options:["video","youtube","vimeo"]}):""))};function nn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return rn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var an=wp.element,on=(an.createElement,an.useState),ln=an.useEffect,cn=(an.Fragment,an.render,an.useRef,wp.data),sn=(cn.dispatch,cn.select,function(e){var t=nn(on(e.value),2),n=t[0],r=t[1],a=nn(on({}),2),o=a[0],i=a[1];return ln((function(){var t=100,r=0;e.hasOwnProperty("max")&&(t=e.max),e.hasOwnProperty("min")&&(r=e.min);var a=Math.round(100*n/(t-r));i({background:"linear-gradient(to right, var(--primary), var(--primary) "+a+"%, var(--light) "+a+"%, var(--light) 100%)"})}),[]),wp.element.createElement("div",{class:"range"},wp.element.createElement("div",{class:"form-group range__slider"},wp.element.createElement("input",{type:"range",style:o,step:e.hasOwnProperty("step")?e.step:"",min:e.hasOwnProperty("min")?e.min:0,max:e.hasOwnProperty("max")?e.max:100,value:n,onChange:function(t){r(t.target.value);var n=100,a=0;e.hasOwnProperty("max")&&(n=e.max),e.hasOwnProperty("min")&&(a=e.min);var o=Math.round(100*t.target.value/(n-a));console.log(o),i({background:"linear-gradient(to right, var(--primary), var(--primary) "+o+"%, var(--light) "+o+"%, var(--light) 100%)"}),e.change(t.target.value)}})),wp.element.createElement("div",{class:"form-group range__value"},e.hasOwnProperty("valueLabel")?wp.element.createElement("label",null,e.valueLabel):"",wp.element.createElement("span",null,n)))});function dn(e){return function(e){if(Array.isArray(e))return vn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||bn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function un(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?un(Object(n),!0).forEach((function(t){mn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):un(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function mn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||bn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bn(e,t){if(e){if("string"==typeof e)return vn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?vn(e,t):void 0}}function vn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var wn=wp.element,gn=(wn.createElement,wn.render,wn.Fragment,wn.useState),yn=wn.useEffect,hn=wp.data,_n=hn.dispatch,En=hn.select;function On(e){var t=fn(gn(e.field),2),n=t[0],r=t[1],a=fn(gn(),2),o=a[0],i=a[1],l=fn(gn(!1),2),c=l[0],s=l[1],d=fn(gn(null),2),u=d[0],p=d[1];yn((function(){s(!0),fetch("".concat(window.vibebp.api.url,"/xprofile/field/options?field_id=").concat(n.id).concat(e.registration?"&client_id="+window.vibebp.settings.client_id:""),{method:"post",body:JSON.stringify(pn({field_id:n.id,type:n.type,token:En("vibebp").getToken()},e))}).then((function(e){return e.json()})).then((function(e){s(!1),e.status&&i(e.values)})).catch((function(e){s(!1),console.log({error:e})}))}),[]);$((function(){n.value&&o&&function(){if(e.hasOwnProperty("registration")&&e.registration)e.update(n);else{u&&u.abort();var t=new AbortController,r=u?{signal:t.signal}:{};p(t),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),pn(pn({method:"post"},r),{},{body:JSON.stringify(pn({field_id:n.id,type:n.type,value:n.value,token:En("vibebp").getToken()},e))})).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&_n("vibebp").addNotification({text:e.message})})).catch((function(e){console.log({error:e})}))}}()}),500,[n.value]);return wp.element.createElement("div",{className:"frontend_profile_field"},c?wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"",wp.element.createElement("div",{className:"_profile_field_body"},o?wp.element.createElement("div",{className:"vibebpProfile_table_wrapper"},wp.element.createElement("table",{className:"vibebpProfile_table"},o.hasOwnProperty("columns")&&o.columns&&o.columns.length&&o.hasOwnProperty("rows")&&o.rows&&o.rows.length?function(){for(var e=[],t=function(t){e.push(wp.element.createElement("tr",null,function(){for(var e=[],a=0;a<=o.columns.length;a++)if(0===a)if(0===t)e.push(wp.element.createElement("th",null));else{var i=o.rows[t-1];e.push(wp.element.createElement("th",{className:"removable_item"},wp.element.createElement("span",null,i.name)))}else if(0===t){var l=o.columns[a-1];e.push(wp.element.createElement("th",{className:"removable_item"},wp.element.createElement("span",null,l.name)))}else!function(){var i={row:o.rows[t-1].id,column:o.columns[a-1].id},l=pn(pn({},i),{},{type:"text",value:""});if(o.values){var c=o.values.findIndex((function(e){return e.row===i.row&&e.column===i.column}));c>-1&&o.values[c].row&&o.values[c].column&&(l=o.values[c])}var s=[];if(n.value&&Array.isArray(n.value)&&n.value.length){var d=n.value.find((function(e){return e.row===i.row&&e.column===i.column}));d&&(s=d.value)}e.push(wp.element.createElement("td",null,wp.element.createElement("div",null,wp.element.createElement(Sn,{field:pn(pn({},l),{},{value:s}),change:function(e){r((function(t){var n=pn({},t);n.hasOwnProperty("value")&&Array.isArray(n.value)?n.value=dn(t.value):n.value=[];var r=pn(pn({},i),{},{value:e}),a=n.value.findIndex((function(e){return e.row===i.row&&e.column===i.column}));return a>-1?n.value.splice(a,1,pn({},r)):n.value.push(pn({},r)),n}))}}))))}();return e}()))},a=0;a<=o.rows.length;a++)t(a);return e}():"")):""))}function Sn(e){var t=fn(gn({}),2),n=t[0],r=t[1],a=fn(gn(!0),2),o=a[0],i=(a[1],function(t){return e.change(t)});return yn((function(){r(e.field&&e.field.row&&e.field.column?pn({},e.field):pn(pn({},e.ids),{},{type:"text",value:""}))}),[e.field]),wp.element.createElement("div",{className:"profile_field_fields_element"},o?wp.element.createElement("div",{className:"field_settings"},"text"===n.type||"number"===n.type?wp.element.createElement("input",{type:"string"==typeof n.value||"number"==typeof n.value?n.value:"",value:n.value,onChange:function(e){return i(e.target.value)}}):"option"===n.type?wp.element.createElement("div",null,n.options&&n.options.length?wp.element.createElement("select",{onChange:function(e){return i(e.target.value)},value:n.value},n.options.map((function(e){return wp.element.createElement("option",{field:e.field},e.lable)}))):""):"range"===n.type||"points"===n.type?wp.element.createElement(sn,{value:n.value,min:"0",max:"100",change:function(e){return i(e)}}):"checkbox"===n.type?wp.element.createElement("div",null,n.options&&n.options.length?n.options.map((function(e,t){var a=pn({},n);return a.value&&Array.isArray(a.value)||(a.value=[]),wp.element.createElement("div",{className:"checkbox"},wp.element.createElement("input",{type:"checkbox",id:"custom-checkbox-".concat(t),value:t,checked:a.value.indexOf(t)>-1,onChange:function(){var e=pn({},n);e.value&&Array.isArray(e.value)||(e.value=[]);var a=dn(e.value);a.indexOf(t)>-1?a.splice(a.indexOf(t),1):a.push(t),r(pn(pn({},e),{},{value:a})),i(a)}}),wp.element.createElement("label",{htmlFor:"custom-checkbox-".concat(t)},e.lable))})):""):""):"")}function Nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Pn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nn(Object(n),!0).forEach((function(t){kn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function kn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return In(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return In(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function In(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var An=wp.element,xn=(An.createElement,An.render,An.useState),Tn=An.useEffect,Cn=An.Fragment,Mn=(An.useContext,An.useRef,wp.data),Ln=(Mn.dispatch,Mn.select,[{name:"Afghanistan",dial_code:"93",code:"AF"},{name:"Aland Islands",dial_code:"358",code:"AX"},{name:"Albania",dial_code:"355",code:"AL"},{name:"Algeria",dial_code:"213",code:"DZ"},{name:"AmericanSamoa",dial_code:"1684",code:"AS"},{name:"Andorra",dial_code:"376",code:"AD"},{name:"Angola",dial_code:"244",code:"AO"},{name:"Anguilla",dial_code:"1264",code:"AI"},{name:"Antarctica",dial_code:"672",code:"AQ"},{name:"Antigua and Barbuda",dial_code:"1268",code:"AG"},{name:"Argentina",dial_code:"54",code:"AR"},{name:"Armenia",dial_code:"374",code:"AM"},{name:"Aruba",dial_code:"297",code:"AW"},{name:"Australia",dial_code:"61",code:"AU"},{name:"Austria",dial_code:"43",code:"AT"},{name:"Azerbaijan",dial_code:"994",code:"AZ"},{name:"Bahamas",dial_code:"1242",code:"BS"},{name:"Bahrain",dial_code:"973",code:"BH"},{name:"Bangladesh",dial_code:"880",code:"BD"},{name:"Barbados",dial_code:"1246",code:"BB"},{name:"Belarus",dial_code:"375",code:"BY"},{name:"Belgium",dial_code:"32",code:"BE"},{name:"Belize",dial_code:"501",code:"BZ"},{name:"Benin",dial_code:"229",code:"BJ"},{name:"Bermuda",dial_code:"1441",code:"BM"},{name:"Bhutan",dial_code:"975",code:"BT"},{name:"Bolivia, Plurinational State of",dial_code:"591",code:"BO"},{name:"Bosnia and Herzegovina",dial_code:"387",code:"BA"},{name:"Botswana",dial_code:"267",code:"BW"},{name:"Brazil",dial_code:"55",code:"BR"},{name:"British Indian Ocean Territory",dial_code:"246",code:"IO"},{name:"Brunei Darussalam",dial_code:"673",code:"BN"},{name:"Bulgaria",dial_code:"359",code:"BG"},{name:"Burkina Faso",dial_code:"226",code:"BF"},{name:"Burundi",dial_code:"257",code:"BI"},{name:"Cambodia",dial_code:"855",code:"KH"},{name:"Cameroon",dial_code:"237",code:"CM"},{name:"Canada",dial_code:"1",code:"CA"},{name:"Cape Verde",dial_code:"238",code:"CV"},{name:"Cayman Islands",dial_code:" 345",code:"KY"},{name:"Central African Republic",dial_code:"236",code:"CF"},{name:"Chad",dial_code:"235",code:"TD"},{name:"Chile",dial_code:"56",code:"CL"},{name:"China",dial_code:"86",code:"CN"},{name:"Christmas Island",dial_code:"61",code:"CX"},{name:"Cocos (Keeling) Islands",dial_code:"61",code:"CC"},{name:"Colombia",dial_code:"57",code:"CO"},{name:"Comoros",dial_code:"269",code:"KM"},{name:"Congo",dial_code:"242",code:"CG"},{name:"Congo, The Democratic Republic of the Congo",dial_code:"243",code:"CD"},{name:"Cook Islands",dial_code:"682",code:"CK"},{name:"Costa Rica",dial_code:"506",code:"CR"},{name:"Cote d'Ivoire",dial_code:"225",code:"CI"},{name:"Croatia",dial_code:"385",code:"HR"},{name:"Cuba",dial_code:"53",code:"CU"},{name:"Cyprus",dial_code:"357",code:"CY"},{name:"Czech Republic",dial_code:"420",code:"CZ"},{name:"Denmark",dial_code:"45",code:"DK"},{name:"Djibouti",dial_code:"253",code:"DJ"},{name:"Dominica",dial_code:"1767",code:"DM"},{name:"Dominican Republic",dial_code:"1849",code:"DO"},{name:"Ecuador",dial_code:"593",code:"EC"},{name:"Egypt",dial_code:"20",code:"EG"},{name:"El Salvador",dial_code:"503",code:"SV"},{name:"Equatorial Guinea",dial_code:"240",code:"GQ"},{name:"Eritrea",dial_code:"291",code:"ER"},{name:"Estonia",dial_code:"372",code:"EE"},{name:"Ethiopia",dial_code:"251",code:"ET"},{name:"Falkland Islands (Malvinas)",dial_code:"500",code:"FK"},{name:"Faroe Islands",dial_code:"298",code:"FO"},{name:"Fiji",dial_code:"679",code:"FJ"},{name:"Finland",dial_code:"358",code:"FI"},{name:"France",dial_code:"33",code:"FR"},{name:"French Guiana",dial_code:"594",code:"GF"},{name:"French Polynesia",dial_code:"689",code:"PF"},{name:"Gabon",dial_code:"241",code:"GA"},{name:"Gambia",dial_code:"220",code:"GM"},{name:"Georgia",dial_code:"995",code:"GE"},{name:"Germany",dial_code:"49",code:"DE"},{name:"Ghana",dial_code:"233",code:"GH"},{name:"Gibraltar",dial_code:"350",code:"GI"},{name:"Greece",dial_code:"30",code:"GR"},{name:"Greenland",dial_code:"299",code:"GL"},{name:"Grenada",dial_code:"1473",code:"GD"},{name:"Guadeloupe",dial_code:"590",code:"GP"},{name:"Guam",dial_code:"1671",code:"GU"},{name:"Guatemala",dial_code:"502",code:"GT"},{name:"Guernsey",dial_code:"44",code:"GG"},{name:"Guinea",dial_code:"224",code:"GN"},{name:"Guinea-Bissau",dial_code:"245",code:"GW"},{name:"Guyana",dial_code:"595",code:"GY"},{name:"Haiti",dial_code:"509",code:"HT"},{name:"Holy See (Vatican City State)",dial_code:"379",code:"VA"},{name:"Honduras",dial_code:"504",code:"HN"},{name:"Hong Kong",dial_code:"852",code:"HK"},{name:"Hungary",dial_code:"36",code:"HU"},{name:"Iceland",dial_code:"354",code:"IS"},{name:"India",dial_code:"91",code:"IN"},{name:"Indonesia",dial_code:"62",code:"ID"},{name:"Iran, Islamic Republic of Persian Gulf",dial_code:"98",code:"IR"},{name:"Iraq",dial_code:"964",code:"IQ"},{name:"Ireland",dial_code:"353",code:"IE"},{name:"Isle of Man",dial_code:"44",code:"IM"},{name:"Israel",dial_code:"972",code:"IL"},{name:"Italy",dial_code:"39",code:"IT"},{name:"Jamaica",dial_code:"1876",code:"JM"},{name:"Japan",dial_code:"81",code:"JP"},{name:"Jersey",dial_code:"44",code:"JE"},{name:"Jordan",dial_code:"962",code:"JO"},{name:"Kazakhstan",dial_code:"77",code:"KZ"},{name:"Kenya",dial_code:"254",code:"KE"},{name:"Kiribati",dial_code:"686",code:"KI"},{name:"Korea, Democratic People's Republic of Korea",dial_code:"850",code:"KP"},{name:"Korea, Republic of South Korea",dial_code:"82",code:"KR"},{name:"Kuwait",dial_code:"965",code:"KW"},{name:"Kyrgyzstan",dial_code:"996",code:"KG"},{name:"Laos",dial_code:"856",code:"LA"},{name:"Latvia",dial_code:"371",code:"LV"},{name:"Lebanon",dial_code:"961",code:"LB"},{name:"Lesotho",dial_code:"266",code:"LS"},{name:"Liberia",dial_code:"231",code:"LR"},{name:"Libyan Arab Jamahiriya",dial_code:"218",code:"LY"},{name:"Liechtenstein",dial_code:"423",code:"LI"},{name:"Lithuania",dial_code:"370",code:"LT"},{name:"Luxembourg",dial_code:"352",code:"LU"},{name:"Macao",dial_code:"853",code:"MO"},{name:"Macedonia",dial_code:"389",code:"MK"},{name:"Madagascar",dial_code:"261",code:"MG"},{name:"Malawi",dial_code:"265",code:"MW"},{name:"Malaysia",dial_code:"60",code:"MY"},{name:"Maldives",dial_code:"960",code:"MV"},{name:"Mali",dial_code:"223",code:"ML"},{name:"Malta",dial_code:"356",code:"MT"},{name:"Marshall Islands",dial_code:"692",code:"MH"},{name:"Martinique",dial_code:"596",code:"MQ"},{name:"Mauritania",dial_code:"222",code:"MR"},{name:"Mauritius",dial_code:"230",code:"MU"},{name:"Mayotte",dial_code:"262",code:"YT"},{name:"Mexico",dial_code:"52",code:"MX"},{name:"Micronesia, Federated States of Micronesia",dial_code:"691",code:"FM"},{name:"Moldova",dial_code:"373",code:"MD"},{name:"Monaco",dial_code:"377",code:"MC"},{name:"Mongolia",dial_code:"976",code:"MN"},{name:"Montenegro",dial_code:"382",code:"ME"},{name:"Montserrat",dial_code:"1664",code:"MS"},{name:"Morocco",dial_code:"212",code:"MA"},{name:"Mozambique",dial_code:"258",code:"MZ"},{name:"Myanmar",dial_code:"95",code:"MM"},{name:"Namibia",dial_code:"264",code:"NA"},{name:"Nauru",dial_code:"674",code:"NR"},{name:"Nepal",dial_code:"977",code:"NP"},{name:"Netherlands",dial_code:"31",code:"NL"},{name:"Netherlands Antilles",dial_code:"599",code:"AN"},{name:"New Caledonia",dial_code:"687",code:"NC"},{name:"New Zealand",dial_code:"64",code:"NZ"},{name:"Nicaragua",dial_code:"505",code:"NI"},{name:"Niger",dial_code:"227",code:"NE"},{name:"Nigeria",dial_code:"234",code:"NG"},{name:"Niue",dial_code:"683",code:"NU"},{name:"Norfolk Island",dial_code:"672",code:"NF"},{name:"Northern Mariana Islands",dial_code:"1670",code:"MP"},{name:"Norway",dial_code:"47",code:"NO"},{name:"Oman",dial_code:"968",code:"OM"},{name:"Pakistan",dial_code:"92",code:"PK"},{name:"Palau",dial_code:"680",code:"PW"},{name:"Palestinian Territory, Occupied",dial_code:"970",code:"PS"},{name:"Panama",dial_code:"507",code:"PA"},{name:"Papua New Guinea",dial_code:"675",code:"PG"},{name:"Paraguay",dial_code:"595",code:"PY"},{name:"Peru",dial_code:"51",code:"PE"},{name:"Philippines",dial_code:"63",code:"PH"},{name:"Pitcairn",dial_code:"872",code:"PN"},{name:"Poland",dial_code:"48",code:"PL"},{name:"Portugal",dial_code:"351",code:"PT"},{name:"Puerto Rico",dial_code:"1939",code:"PR"},{name:"Qatar",dial_code:"974",code:"QA"},{name:"Romania",dial_code:"40",code:"RO"},{name:"Russia",dial_code:"7",code:"RU"},{name:"Rwanda",dial_code:"250",code:"RW"},{name:"Reunion",dial_code:"262",code:"RE"},{name:"Saint Barthelemy",dial_code:"590",code:"BL"},{name:"Saint Helena, Ascension and Tristan Da Cunha",dial_code:"290",code:"SH"},{name:"Saint Kitts and Nevis",dial_code:"1869",code:"KN"},{name:"Saint Lucia",dial_code:"1758",code:"LC"},{name:"Saint Martin",dial_code:"590",code:"MF"},{name:"Saint Pierre and Miquelon",dial_code:"508",code:"PM"},{name:"Saint Vincent and the Grenadines",dial_code:"1784",code:"VC"},{name:"Samoa",dial_code:"685",code:"WS"},{name:"San Marino",dial_code:"378",code:"SM"},{name:"Sao Tome and Principe",dial_code:"239",code:"ST"},{name:"Saudi Arabia",dial_code:"966",code:"SA"},{name:"Senegal",dial_code:"221",code:"SN"},{name:"Serbia",dial_code:"381",code:"RS"},{name:"Seychelles",dial_code:"248",code:"SC"},{name:"Sierra Leone",dial_code:"232",code:"SL"},{name:"Singapore",dial_code:"65",code:"SG"},{name:"Slovakia",dial_code:"421",code:"SK"},{name:"Slovenia",dial_code:"386",code:"SI"},{name:"Solomon Islands",dial_code:"677",code:"SB"},{name:"Somalia",dial_code:"252",code:"SO"},{name:"South Africa",dial_code:"27",code:"ZA"},{name:"South Sudan",dial_code:"211",code:"SS"},{name:"South Georgia and the South Sandwich Islands",dial_code:"500",code:"GS"},{name:"Spain",dial_code:"34",code:"ES"},{name:"Sri Lanka",dial_code:"94",code:"LK"},{name:"Sudan",dial_code:"249",code:"SD"},{name:"Suriname",dial_code:"597",code:"SR"},{name:"Svalbard and Jan Mayen",dial_code:"47",code:"SJ"},{name:"Swaziland",dial_code:"268",code:"SZ"},{name:"Sweden",dial_code:"46",code:"SE"},{name:"Switzerland",dial_code:"41",code:"CH"},{name:"Syrian Arab Republic",dial_code:"963",code:"SY"},{name:"Taiwan",dial_code:"886",code:"TW"},{name:"Tajikistan",dial_code:"992",code:"TJ"},{name:"Tanzania, United Republic of Tanzania",dial_code:"255",code:"TZ"},{name:"Thailand",dial_code:"66",code:"TH"},{name:"Timor-Leste",dial_code:"670",code:"TL"},{name:"Togo",dial_code:"228",code:"TG"},{name:"Tokelau",dial_code:"690",code:"TK"},{name:"Tonga",dial_code:"676",code:"TO"},{name:"Trinidad and Tobago",dial_code:"1868",code:"TT"},{name:"Tunisia",dial_code:"216",code:"TN"},{name:"Turkey",dial_code:"90",code:"TR"},{name:"Turkmenistan",dial_code:"993",code:"TM"},{name:"Turks and Caicos Islands",dial_code:"1649",code:"TC"},{name:"Tuvalu",dial_code:"688",code:"TV"},{name:"Uganda",dial_code:"256",code:"UG"},{name:"Ukraine",dial_code:"380",code:"UA"},{name:"United Arab Emirates",dial_code:"971",code:"AE"},{name:"United Kingdom",dial_code:"44",code:"GB"},{name:"United States",dial_code:"1",code:"US"},{name:"Uruguay",dial_code:"598",code:"UY"},{name:"Uzbekistan",dial_code:"998",code:"UZ"},{name:"Vanuatu",dial_code:"678",code:"VU"},{name:"Venezuela, Bolivarian Republic of Venezuela",dial_code:"58",code:"VE"},{name:"Vietnam",dial_code:"84",code:"VN"},{name:"Virgin Islands, British",dial_code:"1284",code:"VG"},{name:"Virgin Islands, U.S.",dial_code:"1340",code:"VI"},{name:"Wallis and Futuna",dial_code:"681",code:"WF"},{name:"Yemen",dial_code:"967",code:"YE"},{name:"Zambia",dial_code:"260",code:"ZM"},{name:"Zimbabwe",dial_code:"263",code:"ZW"}]);Ln=Ln.sort((function(e,t){return parseInt(t.dial_code)>parseInt(e.dial_code)}));var Dn=function(e){var t=jn(xn(e.field),2),n=t[0],r=t[1];Tn((function(){r(e.field)}),[e.field]);return wp.element.createElement("span",null,function(e){if(!e)return e;var t=e.replace(/[^\d]/g,""),n=t.length;return n<4?""+t:n<7?"".concat(""," (").concat(t.slice(0,3),") ").concat(t.slice(3)):n<15?"(".concat(t.slice(0,3),") ").concat(t.slice(3,6),"-").concat(t.slice(6,15)):wp.element.createElement(Cn,null,wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:""}})," `($",t.slice(0,3),") $",t.slice(3,6),"-$",t.slice(6,15),"`")}(n.value),wp.element.createElement("input",{type:"number",value:n.value,onChange:function(e){r(Pn(Pn({},n),{},{value:e.target.value}))},onBlur:function(t){return e.update(Pn(Pn({},n),{},{value:t.target.value}))}}))};function Un(){return(Un=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Rn(e){return function(e){if(Array.isArray(e))return Hn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Bn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jn(e,t,n,r,a,o,i){try{var l=e[o](i),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,a)}function Fn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fn(Object(n),!0).forEach((function(t){qn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||Bn(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Bn(e,t){if(e){if("string"==typeof e)return Hn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hn(e,t):void 0}}function Hn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Kn=wp.element,Vn=(Kn.createElement,Kn.useState),$n=Kn.useEffect,Wn=Kn.Fragment,Yn=(Kn.render,Kn.useRef),Zn=wp.data,Qn=Zn.dispatch,Xn=Zn.select,er=!1,tr=function(e){var t=zn(Vn(!1),2),n=t[0],r=t[1],a=zn(Vn(!1),2),o=a[0],i=a[1],l=zn(Vn({}),2),c=l[0],s=l[1],d=zn(Vn(null),2),u=d[0],p=d[1],m=Yn(null);$n((function(){}),[]),$((function(){var t;"checkbox"!=e.field.type&&"selectbox"!=e.field.type&&"radio"!=e.field.type&&"multiselect"!=e.field.type&&"multiselectbox"!=e.field.type||e.field.hasOwnProperty("options")&&e.field.options.length||((null===(t=c.options)||void 0===t?void 0:t.length)||fetch("".concat(window.vibebp.api.url,"/xprofile/field/options?field_id=").concat(e.field.id,"&client_id=").concat(window.vibebp.settings.client_id,"&force"),{method:"post",body:JSON.stringify(Gn({field_id:e.field.id,type:e.field.type,token:Xn("vibebp").getToken()},e))}).then((function(e){return e.json()})).then((function(t){t.status?(s(Gn(Gn({},e.field),{},{options:t.values})),e.update&&e.update(Gn(Gn({},e.field),{},{options:t.values}))):s(Gn(Gn({},e.field),{},{options:[]}))})));var n=new CustomEvent("field_loaded",{detail:{field:e.field}});document.dispatchEvent(n),s(e.field)}),500,[e.field]),$n((function(){return function(){m&&m.hasOwnProperty("current")&&m.current&&"undefined"!=typeof flatpickr&&m.current.flatpickr().destroy()}}),[e.field.id]);$n((function(){if(m&&m.hasOwnProperty("current")&&m.current&&"undefined"!=typeof flatpickr){var e={altInput:!0,dateFormat:"Y-m-d",defaultDate:c.hasOwnProperty("value")&&c.value.length?c.value:[],onChange:f};flatpickr(m.current,e)}}),[c]),$n((function(){if(e.hasOwnProperty("registration")&&e.registration)e.update(c);else if(n&&"checkbox"==c.type){er&&er.abort();var t={},a=new AbortController;er&&(t={signal:a.signal}),er=a,i(!0),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),Gn(Gn({method:"post"},t),{},{body:JSON.stringify(Gn({field_id:c.id,type:c.type,value:c.value,token:Xn("vibebp").getToken()},e))})).then((function(e){return e.json()})).then((function(t){i(!1),r(!1),document.dispatchEvent(new CustomEvent("xprofile_field_saved",{detail:{field_id:c.id}})),e.hasOwnProperty("update")&&e.update(c),t.hasOwnProperty("message")&&Qn("vibebp").addNotification({icon:t.status?"vicon vicon-check-box":"vicon vicon-alert",text:t.message})}))}}),[c.value,n]),$((function(){if(e.hasOwnProperty("registration")&&e.registration)e.update(c);else if(n&&"checkbox"!=c.type){er&&er.abort();var t={},a=new AbortController;er&&(t={signal:a.signal}),er=a,i(!0),fetch("".concat(window.vibebp.api.url,"/xprofile/field/save?post"),Gn(Gn({method:"post"},t),{},{body:JSON.stringify(Gn({field_id:c.id,type:c.type,value:c.value,token:Xn("vibebp").getToken()},e))})).then((function(e){return e.json()})).then((function(t){i(!1),r(!1),document.dispatchEvent(new CustomEvent("xprofile_field_saved",{detail:{field_id:c.id}})),e.hasOwnProperty("update")&&e.update(c),t.hasOwnProperty("message")&&Qn("vibebp").addNotification({icon:t.status?"vicon vicon-check-box":"vicon vicon-alert",text:t.message})}))}}),100,[n]);var f=function(e){var t=Gn({},c);if(e&&e.length){var n=e[0].getDate();(n=n.toString()).length<2&&(n="0"+n);var a=e[0].getMonth()+1;(a=a.toString()).length<2&&(a="0"+a);var o=e[0].getFullYear()+"-"+a+"-"+n;t.value=o}else t.value="";s(t),r(!0)};return wp.element.createElement("div",{className:o?"vibebp_form_field control is-loading":"vibebp_form_field control"},"checkbox_acceptance"!==c.type?wp.element.createElement("label",null,wp.element.createElement("span",null,wp.element.createElement("strong",{dangerouslySetInnerHTML:{__html:c.name}}),c.description&&c.description.length?wp.element.createElement(Wn,null,wp.element.createElement("span",{className:"vicon vicon-help-alt"}),wp.element.createElement("div",{className:"field_description",dangerouslySetInnerHTML:{__html:c.description}})):""),window.vibebp.components.hasOwnProperty("xprofile")&&window.vibebp.components.xprofile.hasOwnProperty("visibility")?wp.element.createElement("span",null,window.vibebp.components.xprofile.visibility[c.visibility]):""):"",c.hasOwnProperty("type")?"textbox"===c.type?wp.element.createElement("input",{type:"text",value:c.value,onChange:function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s(Gn(Gn({},c),{},{value:t.target.value}));case 1:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){Jn(o,r,a,i,l,"next",e)}function l(e){Jn(o,r,a,i,l,"throw",e)}i(void 0)}))});return function(e){return t.apply(this,arguments)}}(),onBlur:function(){r(!0)}}):"number"===c.type?wp.element.createElement("input",{type:"number",value:c.value,onChange:function(e){s(Gn(Gn({},c),{},{value:e.target.value})),r(!0)}}):"telephone"===c.type?wp.element.createElement(Dn,{field:c,update:function(e){s(e),r(!0)}}):"url"===c.type?wp.element.createElement("input",{type:"text",value:c.value,onChange:function(e){s(Gn(Gn({},c),{},{value:e.target.value})),r(!0)}}):"range"===c.type?wp.element.createElement("input",{type:"range",value:c.value,min:"0",max:"100",onChange:function(e){s(Gn(Gn({},c),{},{value:e.target.value})),r(!0)}}):"points"===c.type?wp.element.createElement("input",{type:"range",value:c.value,min:"0",max:"5",onChange:function(e){s(Gn(Gn({},c),{},{value:e.target.value})),r(!0)}}):"textarea"===c.type?wp.element.createElement("textarea",{onChange:function(e){s(Gn(Gn({},c),{},{value:e.target.value}))},onBlur:function(){r(!0)}},c.value):"selectbox"===c.type?wp.element.createElement("select",{onChange:function(e){s(Gn(Gn({},c),{},{value:e.target.value})),r(!0)},value:c.value},c.hasOwnProperty("options")?c.options.map((function(e,t){return wp.element.createElement("option",{value:e.name},e.name)})):""):"radio"===c.type?wp.element.createElement("div",{className:"vibebp_field_group"},c.hasOwnProperty("options")?c.options.map((function(t,a){return wp.element.createElement("div",{className:"radio"},wp.element.createElement("input",{id:t.id,type:"radio",value:t.name,checked:c.value===t.name,onChange:function(t){n||(s(Gn(Gn({},c),{},{value:t.target.value})),e.registration||r(!0))}}),wp.element.createElement("label",{for:t.id},t.name))})):""):"checkbox"===c.type?wp.element.createElement("div",{className:"vibebp_field_group"},c.hasOwnProperty("options")?c.options.map((function(e,t){return wp.element.createElement("div",{className:"checkbox"},wp.element.createElement("input",{type:"checkbox",id:e.id,value:e.name,checked:c.value&&c.value.indexOf(e.name)>-1,onChange:function(t){if(Array.isArray(c.value)||(c.value=[]),c.value&&-1===c.value.indexOf(e.name)){var n=Rn(c.value);n.push(e.name),s(Gn(Gn({},c),{},{value:n}))}else{var a=Rn(c.value);a.splice(c.value.indexOf(e.name),1),s(Gn(Gn({},c),{},{value:a}))}r(!0)}}),wp.element.createElement("label",{for:e.id},e.name))})):""):"multiselectbox"===c.type?wp.element.createElement(Ye,{update:function(e,t,n){s(Gn(Gn({},c),{},{value:e.value})),r(!0)},field:c}):"datebox"===c.type?wp.element.createElement("input",{type:"date",ref:m}):"country"===c.type?wp.element.createElement("select",{onChange:function(e){s(Gn(Gn({},c),{},{value:e.target.value})),r(!0)},value:c.value},window.vibebp.components.hasOwnProperty("xprofile")&&Object.keys(window.vibebp.components.xprofile.countries).length?Object.keys(window.vibebp.components.xprofile.countries).map((function(e,t){return wp.element.createElement("option",{value:e},window.vibebp.components.xprofile.countries[e])})):""):"color"===c.type?wp.element.createElement(Wn,null,"undefined"==typeof Picker?wp.element.createElement("input",{type:"color",value:c.value,onChange:function(t){e.update(Gn(Gn({},c),{},{value:t.target.value})),r(!0)}}):wp.element.createElement("span",{className:"vibebp_color_field",style:{background:c.value},ref:function(t){if(!u){var n=new Picker(t);n.onChange=function(n){t.style.background=n.rgbaString,console.log("change detected"),e.hasOwnProperty("update")&&e.update(Gn(Gn({},c),{},{value:n.rgbaString})),s(Gn(Gn({},c),{},{value:n.rgbaString})),r(!0)},p(n)}}})):"location"===c.type?wp.element.createElement(Re,Un({field:c},e)):"social"===c.type?wp.element.createElement(se,Un({field:c},e)):"repeatable"===c.type?wp.element.createElement(Oe,Un({field:c},e)):"upload"===c.type?wp.element.createElement(st,Un({field:c},e)):"video"===c.type?wp.element.createElement(Jt,Un({field:c},e)):"gallery"===c.type?wp.element.createElement(tn,Un({field:c},e)):"table"===c.type?wp.element.createElement(On,Un({field:c},e)):"checkbox_acceptance"===c.type?wp.element.createElement("div",{className:"checkbox"},wp.element.createElement("input",{type:"checkbox",id:c.id,value:c.id,onChange:function(e){c.value&&c.value===c.id?s(Gn(Gn({},c),{},{value:null})):s(Gn(Gn({},c),{},{value:e.target.value})),r(!0)}}),wp.element.createElement("label",{for:c.id},wp.element.createElement("strong",{dangerouslySetInnerHTML:{__html:c.name}}))):"":"")};function nr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nr(Object(n),!0).forEach((function(t){ar(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ar(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function or(e){return function(e){if(Array.isArray(e))return cr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||lr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ir(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||lr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lr(e,t){if(e){if("string"==typeof e)return cr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cr(e,t):void 0}}function cr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var sr=wp.element,dr=(sr.createElement,sr.useState),ur=sr.useEffect,pr=sr.Fragment,mr=(sr.render,wp.data),fr=(mr.dispatch,mr.select,function(e){var t=ir(dr(window.vibebp.settings.registration_fields),2),n=t[0],r=t[1],a=ir(dr(!1),2),o=a[0],i=a[1],l=ir(dr(!1),2),c=l[0],s=l[1],d=ir(dr(""),2),u=d[0],p=d[1],m=ir(dr(!0),2),f=m[0],b=m[1],v=ir(dr(!1),2),w=v[0],g=v[1],y=ir(dr(!1),2),h=(y[0],y[1]),_=ir(dr(!1),2),E=_[0],O=_[1],S=ir(dr(0),2),N=S[0],P=S[1],k=ir(dr(null),2),j=k[0],I=k[1],A=ir(dr(!1),2),x=A[0],T=A[1],C=ir(dr({}),2),M=C[0],L=C[1],D=ir(dr(""),2),U=D[0],R=D[1];ur((function(){window.vibebp.translations.registration_checkbox.length&&b(!1),T(!0),fetch("".concat(window.vibebp.api.xprofile_url,"/get/allfields?client_id=").concat(window.vibebp.settings.client_id,"&register&force"),{method:"post"}).then((function(e){return e.json()})).then((function(e){e.status&&L(e.data),e.hasOwnProperty("default_member_type")&&e.default_member_type&&e.default_member_type.length&&e.data.hasOwnProperty(e.default_member_type)&&I(e.default_member_type),T(!1)}))}),[]);var J=function(e){if(!e.length)return!1;var t=[],n=0;return e.length<window.vibebp.settings.password_length?t.push(window.vibebp.translations.password_6_chars):n++,e.search(/[a-z]/i)<0?t.push(window.vibebp.translations.password_one_letter):n++,e.search(/[0-9]/)<0?t.push(window.vibebp.translations.password_digit):n++,e.search(/[A-Z]/)<0?t.push(window.vibebp.translations.password_uppercase):n++,e.search(/[!@#$%^&*]/)<0?t.push(window.vibebp.translations.special_char):n++,P(n),t.length>0?(w.length&&g(t),t):(g(!1),!0)};return wp.element.createElement(pr,null,wp.element.createElement("h2",null,window.vibebp.translations.register_account_heading),wp.element.createElement("p",null,window.vibebp.translations.register_account_description),wp.element.createElement("div",{className:"loginform"},u.length?wp.element.createElement("div",{className:"registration_message",dangerouslySetInnerHTML:{__html:u}}):n.length?wp.element.createElement(pr,null,n.map((function(e,t){return wp.element.createElement("div",{className:"field"},wp.element.createElement("div",{className:"control"},wp.element.createElement("label",null,wp.element.createElement("strong",null,e.label)),"email"==e.type?wp.element.createElement("input",{className:e.class,type:"text",value:e.value,onChange:function(e){var a=or(n);a[t].value=e.target.value,n.map((function(e,t){"email"!=e.type||a[t].value.match(/^([\w.%+-]+)@([\w-]+\.)+([\w]{2,})$/i)||-1!=a[t].class.indexOf("is-danger")?a[t].class=a[t].class.split("is-danger").join(" "):a[t].class+=" is-danger"})),r(a)}}):"password"==e.type?wp.element.createElement("div",{className:"passwordfield"},wp.element.createElement("span",{className:E?"vicon vicon-na":"vicon vicon-eye",onClick:function(e){return O(!E)}}),wp.element.createElement("input",{className:e.class,type:E?"text":"password",value:e.value,onChange:function(e){!function(e,t){var a=or(n);a[t].value=e.target.value;J(a[t].value);r(a)}(e,t)}}),wp.element.createElement("div",{className:"password_strength_wrapper"},wp.element.createElement("span",{className:"password_strength"},wp.element.createElement("span",{className:N>=1?"pass_active":""}),wp.element.createElement("span",{className:N>=2?"pass_active":""}),wp.element.createElement("span",{className:N>=3?"pass_active":""}),wp.element.createElement("span",{className:N>=4?"pass_active":""}),wp.element.createElement("span",{className:N>=5?"pass_active":""})),wp.element.createElement("span",null,window.vibebp.translations.password_strength[N])),window.vibebp.settings.hasOwnProperty("strong_password")&&window.vibebp.settings.strong_password&&e.value.length&&w&&w.length?wp.element.createElement("span",{className:"passworderrorwrapper"},w.map((function(e){return wp.element.createElement("span",{className:"password_error"},wp.element.createElement("span",{className:"vicon vicon-alert"})," ",e)}))):""):"phone"==e.type||"mobile"==e.type?wp.element.createElement("input",{className:e.class,type:"telephone",value:e.value,onChange:function(e){var a=or(n);a[t].value=e.target.value,n.map((function(e,t){"phone"!=e.type&&"mobile"!=e.type||a[t].value.match(/^(\+\d{1,3}[- ]?)?\d{10}$/)||a[t].value.match(/0{5,}/)||-1!=a[t].class.indexOf("is-danger")?a[t].class=a[t].class.split("is-danger").join(" "):a[t].class+=" is-danger"})),r(a)}}):"select"==e.type?wp.element.createElement("select",{className:e.class,type:"text",value:e.value,onChange:function(e){var a=or(n);a[t].value=e.target.value,r(a)}},wp.element.createElement("option",null),e.options.map((function(e){return wp.element.createElement("option",{value:e.value},e.label)}))):wp.element.createElement("input",{className:e.class,type:"text",value:e.value,onChange:function(e){var a=or(n);a[t].value=e.target.value,r(a)}})))})),window.vibebp.translations.registration_checkbox.length?wp.element.createElement("div",{className:f?"checkbox":"checkbox error"},wp.element.createElement("input",{id:"registration_checkbox",type:"checkbox",onClick:function(){return b(!f)}}),wp.element.createElement("label",{for:"registration_checkbox",dangerouslySetInnerHTML:{__html:window.vibebp.translations.registration_checkbox}})):"",x?wp.element.createElement("div",{className:"loader"},wp.element.createElement("div",{class:"lds-ellipsis"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null))):Object.keys(M).length?wp.element.createElement("div",{className:"register_member_type_wrap"},window.vibebp.settings.member_types_registration?wp.element.createElement("div",{className:"reg_header"},wp.element.createElement("label",null,window.vibebp.translations.register_as),wp.element.createElement("select",{onChange:function(e){I(e.target.value)}},Object.keys(M).map((function(e,t){return wp.element.createElement("option",{selected:j===e,value:e},M[e].label)})))):"",wp.element.createElement("div",{className:"field_wrap"},M.hasOwnProperty(j)&&M[j].hasOwnProperty("fields")&&M[j].fields.length?wp.element.createElement("div",{className:""},M[j].fields.map((function(e,t){return wp.element.createElement(tr,{field:e,update:function(e){return function(e){var t=rr({},M),n=t[j].fields.findIndex((function(t){return t.id===e.id}));n>-1&&(t[j].fields[n]=rr({},e),L(t))}(e)},registration:!0})}))):"")):"",window.vibebp.hasOwnProperty("settings")&&window.vibebp.settings.hasOwnProperty("registration_invite_codes")&&window.vibebp.settings.registration_invite_codes?wp.element.createElement("div",{className:"field"},wp.element.createElement("div",{className:"control"},wp.element.createElement("label",null,wp.element.createElement("strong",null,window.vibebp.translations.have_a_invitation_code)),wp.element.createElement("input",{className:"invitation_code input",type:"text",value:U,onChange:function(e){R(e.target.value)}}))):"",x?"":wp.element.createElement("a",{className:c?"button is-primary is-loading":"button is-primary",onClick:function(){g(!1);var e=!1;if(window.vibebp.settings.hasOwnProperty("strong_password")&&window.vibebp.settings.strong_password){var t=n[n.findIndex((function(e){return"password"==e.type}))].value,r=or(n),a=n.findIndex((function(e){return"password"==e.type})),o=J(t);!0!==o?t.length&&(r[a].class+=" is-danger",g(o),window.vibebp.settings.hasOwnProperty("password_strength_colors")&&window.vibebp.settings.password_strength_colors&&vibebp.settings.password_strength_colors.length&&h(vibebp.settings.password_strength_colors[o.length])):(r[a].class=r[a].class.split("is-danger").join(" "),g(!1),r[a].value.length&&window.vibebp.settings.hasOwnProperty("password_strength_colors")&&window.vibebp.settings.password_strength_colors&&vibebp.settings.password_strength_colors.length&&h(vibebp.settings.password_strength_colors[0])),r[a].value.length||(h(!1),g(!1)),o.length&&(e=!0)}if(f||(e=!0),!e){var l={};"undefined"!=typeof grecaptcha?grecaptcha.ready((function(){grecaptcha.execute(window.vibebp.settings.recaptcha_key,{action:"submit"}).then((function(e){s(!0),l=[].concat(or(n),[{type:"token",recaptchaToken:e}]),M.hasOwnProperty(j)&&M[j].fields&&M[j].fields.length&&(l=[].concat(or(l),or(M[j].fields))).push({id:"member_type",value:j}),U&&U.length&&l.push({id:"invite_code",value:U}),fetch("".concat(window.vibebp.api.url,"/registerUser?client_id=").concat(window.vibebp.settings.client_id,"&force"),{method:"post",body:JSON.stringify(l)}).then((function(e){return e.json()})).then((function(e){s(!1),e.status?p(e.message):i(e.message)}))}))})):(l=or(n),M.hasOwnProperty(j)&&M[j].fields&&M[j].fields.length&&(l=[].concat(or(l),or(M[j].fields))).push({id:"member_type",value:j}),U&&U.length&&l.push({id:"invite_code",value:U}),s(!0),fetch("".concat(window.vibebp.api.url,"/registerUser?client_id=").concat(window.vibebp.settings.client_id,"&force"),{method:"post",body:JSON.stringify(l)}).then((function(e){return e.json()})).then((function(e){s(!1),e.status?p(e.message):i(e.message)})))}}},window.vibebp.translations.create_account),o?wp.element.createElement("div",{className:"error",dangerouslySetInnerHTML:{__html:o}}):""):""),wp.element.createElement("div",{className:"extra_details"},wp.element.createElement("p",null,window.vibebp.translations.account_already,wp.element.createElement("a",{className:"vibebp_forward_link",onClick:function(){e.inviteRegister?e.setInviteRegistration(!1):e.setRegistration(!1)}},window.vibebp.translations.signin," ",wp.element.createElement("span",{className:"vicon vicon-arrow-right"}))),wp.element.createElement("p",{dangerouslySetInnerHTML:{__html:window.vibebp.translations.login_terms}})))});function br(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return vr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var wr=wp.element,gr=(wr.createElement,wr.useState),yr=wr.useEffect,hr=(wr.Fragment,wr.render,wp.data),_r=hr.dispatch,Er=hr.select,Or=function(e){var t=br(gr("user_menu"),2),n=t[0],r=t[1],a=br(gr(""),2),o=(a[0],a[1],br(gr(Er("vibebp").getData("loggedinMenu")),2)),i=o[0],l=(o[1],br(gr(!1),2)),c=(l[0],l[1],Er("vibebp").getUser());yr((function(){setTimeout((function(){r(n.replace(/active/g,"")+" active")}),30)}),[]);var s=function(e){return window.vibebp.hasOwnProperty("profile_link")&&window.vibebp.profile_link&&window.vibebp.profile_link.length?window.vibebp.profile_link+"#component="+e.css_id:c.profile_link+"#component="+e.css_id};return wp.element.createElement("div",{className:n},wp.element.createElement("div",{className:"usermenu_content"},i.length?i.map((function(e){return wp.element.createElement("a",{href:s(e),className:e.classes.join(" "),onClick:function(t){t.preventDefault(),function(e){var t=Er("vibebp").getUser();e.classes.indexOf("bp-menu")>-1?window.location===t.profile_link?_r("vibebp").setComponent(e.css_id):(window.vibebp.hasOwnProperty("profile_link")&&window.vibebp.profile_link&&window.vibebp.profile_link.length,window.location=t.profile_link+"#component="+e.css_id):window.location.href=e.url}(e)},dangerouslySetInnerHTML:{__html:e.title}})})):wp.element.createElement("a",{href:c.profile_link},window.vibebp.translations.profile)),wp.element.createElement("a",{onClick:e.logout},wp.element.createElement("span",{className:"vicon vicon-power-off"}),window.vibebp.translations.logout))};function Sr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Nr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Sr(Object(n),!0).forEach((function(t){Pr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Pr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return jr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ir=wp.element,Ar=(Ir.createElement,Ir.useState),xr=Ir.useEffect,Tr=(Ir.Fragment,Ir.render,wp.data),Cr=Tr.dispatch,Mr=(Tr.select,function(e){var t=kr(Ar(),2),n=(t[0],t[1],kr(Ar({first:!0,second:!0}),2)),r=n[0],a=n[1],o=kr(Ar(0),2),i=o[0],l=o[1],c=kr(Ar({first:"",second:""}),2),s=c[0],d=c[1],u=kr(Ar(!1),2),p=u[0],m=u[1],f=kr(Ar(!1),2),b=(f[0],f[1],kr(Ar(!1),2)),v=b[0],w=b[1],g=kr(Ar({}),2),y=g[0],h=g[1],_=kr(Ar({}),2),E=_[0],O=_[1];xr((function(){}),[e.resetPwdArgs]);var S=function(e,t){h({});var n=Nr({},s);if(n[t]=e.target.value,"first"==t)(function(e){if(!e.length)return!1;var t=[],n=0;e.length<window.vibebp.settings.password_length?t.push(window.vibebp.translations.password_6_chars):n++,e.search(/[a-z]/i)<0?t.push(window.vibebp.translations.password_one_letter):n++,e.search(/[0-9]/)<0?t.push(window.vibebp.translations.password_digit):n++,e.search(/[A-Z]/)<0?t.push(window.vibebp.translations.password_uppercase):n++,e.search(/[!@#$%^&*]/)<0?t.push(window.vibebp.translations.special_char):n++,l(n),t.length>0?t.length&&m(t):m(!1)})(n[t]);d(n)};return wp.element.createElement("div",{className:"new_password_wrap"},wp.element.createElement("h1",null,window.vibebp.translations.set_new_password),wp.element.createElement("div",{className:"field"},wp.element.createElement("div",{className:"control passwordfield"},wp.element.createElement("span",{className:r.first?"vicon vicon-na":"vicon vicon-eye",onClick:function(e){return a(Nr(Nr({},r),{},{first:!r.first}))}}),wp.element.createElement("input",{className:"input",type:r.first?"text":"password",onChange:function(e){S(e,"first")},placeholder:window.vibebp.translations.enter_password}),wp.element.createElement("div",{className:"password_strength_wrapper"},wp.element.createElement("span",{className:"password_strength"},wp.element.createElement("span",{className:i>=1?"pass_active":""}),wp.element.createElement("span",{className:i>=2?"pass_active":""}),wp.element.createElement("span",{className:i>=3?"pass_active":""}),wp.element.createElement("span",{className:i>=4?"pass_active":""}),wp.element.createElement("span",{className:i>=5?"pass_active":""})),wp.element.createElement("span",null,window.vibebp.translations.password_strength[i])))),wp.element.createElement("div",{className:"field"},wp.element.createElement("div",{className:"control passwordfield"},wp.element.createElement("span",{className:r.second?"vicon vicon-na":"vicon vicon-eye",onClick:function(e){return a(Nr(Nr({},r),{},{second:!r.second}))}}),wp.element.createElement("input",{className:"input",type:r.second?"text":"password",onChange:function(e){S(e,"second")},placeholder:window.vibebp.translations.re_enter_password}))),y.hasOwnProperty("message")&&y.message.length?wp.element.createElement("span",{className:"password_error "+y.code},wp.element.createElement("span",{className:"vicon vicon-alert"})," ",y.message):"",wp.element.createElement("a",{className:v?"button is-primary is-loading":"button is-primary",onClick:function(t){if(s.first.length&&s.second.length)if(s.second===s.first){if(window.vibebp.settings.hasOwnProperty("strong_password")&&window.vibebp.settings.strong_password&&p&&p.length)return h({code:"restriction",message:p[0]}),!1;w(!0),fetch("".concat(window.vibebp.api.url,"/resetPassword?nocache&client_id=").concat(window.vibebp.settings.client_id),{method:"post",body:JSON.stringify({password:s,args:e.resetPwdArgs})}).then((function(e){return e.json()})).then((function(e){w(!1),console.log(e),e.hasOwnProperty("message")&&(Cr("vibebp").addNotification({text:e.message}),e.status?O({icon:"success",message:e.message}):O({icon:"error",message:e.message}))}))}else h({code:"match",message:window.vibebp.translations.passwords_does_not_match});else h({code:"blank",message:window.vibebp.translations.please_enter_pwd})}},window.vibebp.translations.reset_password),E.hasOwnProperty("message")&&E.message.length?wp.element.createElement("div",{className:"message "+E.icon},E.message):"",wp.element.createElement("a",{className:"",onClick:e.back},wp.element.createElement("span",{className:"vicon vicon-arrow-left"}),window.vibebp.translations.back_to_signin))});function Lr(e,t,n,r,a,o,i){try{var l=e[o](i),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,a)}function Dr(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){Lr(o,r,a,i,l,"next",e)}function l(e){Lr(o,r,a,i,l,"throw",e)}i(void 0)}))}}var Ur=wp.data,Rr=Ur.dispatch,Jr=(Ur.select,0),Fr=function(e){var t=null;if(e.detail&&e.detail.hasOwnProperty("userLoaded")&&(t=e.detail.userLoaded),!Jr&&"undefined"!=typeof firebase&&firebase.hasOwnProperty("database")&&t&&void 0!==t.id){console.log("#1");var n=firebase.database().ref("stale_requests/global"),r=firebase.database().ref("stale_requests/".concat(t.id)),a=localforage.createInstance({name:"vibebp_stale_requests",storeName:"user"}),o=localforage.createInstance({name:"vibebp_stale_requests",storeName:"global"}),i=localforage.createInstance({name:"vibebp_last_requests"});Math.round((new Date).getTime()/1e3);n.on("value",(function(e){e.exists()&&Dr(regeneratorRuntime.mark((function t(){var n,r,a,l;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.val(),[],t.next=4,i.keys();case 4:for(a in r=t.sent,console.log(r),n)l=decodeURIComponent(a),n[a].hasOwnProperty("time")?o.setItem(l,n[a].time):o.setItem(l,n[a]);case 7:case"end":return t.stop()}}),t)})))()})),r.on("value",(function(e){e.exists()&&Dr(regeneratorRuntime.mark((function t(){var n,o,l,c,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.val(),o=[],t.next=4,i.keys();case 4:for(s in l=t.sent,c=function(e){var t=decodeURIComponent(e);o.push(a.keys().then((function(r){var o=r.findIndex((function(e){return e.indexOf(t)>-1}));o>-1?n[e].hasOwnProperty("time")?a.setItem(r[o],n[e].time):a.setItem(r[o],n[e]):n[e].hasOwnProperty("time")?a.setItem(t,n[e].time):a.setItem(t,n[e])}))),l&&l.length&&l[l.length-1].indexOf(t)>-1&&localforage.getItem(l[l.length-1]).then((function(t){(t=JSON.parse(t))&&parseInt(t.vibebp_timestamp)<parseInt(n[e].time)&&Rr("vibebp").addNotification({icon:"vicon vicon-reload",position:"topCenter",text:window.vibebp.translations.load_new_data,actions:[{label:window.vibebp.translations.refresh,event:"reload_last_request",url:l[l.length-1]}]})}))},n)c(s);Promise.all(o).then((function(){r.remove()}));case 8:case"end":return t.stop()}}),t)})))()})),Jr=1}};function Gr(e){return function(e){if(Array.isArray(e))return Yr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Wr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function zr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qr(Object(n),!0).forEach((function(t){Br(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Br(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hr(e){return(Hr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kr(e,t,n,r,a,o,i){try{var l=e[o](i),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,a)}function Vr(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){Kr(o,r,a,i,l,"next",e)}function l(e){Kr(o,r,a,i,l,"throw",e)}i(void 0)}))}}function $r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||Wr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wr(e,t){if(e){if("string"==typeof e)return Yr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yr(e,t):void 0}}function Yr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Zr=wp.element,Qr=(Zr.createElement,Zr.useState),Xr=Zr.useEffect,ea=Zr.Fragment,ta=Zr.render,na=wp.data,ra=na.dispatch,aa=na.select,oa=1,ia=function(e){var t=null,n=null,r=$r(Qr(!1),2),a=r[0],o=r[1],l=$r(Qr(!1),2),c=l[0],s=l[1],d=$r(Qr({}),2),u=d[0],p=d[1],m=$r(Qr(!0),2),f=m[0],b=m[1],w=$r(Qr(!1),2),g=w[0],y=w[1],h=$r(Qr(!1),2),_=h[0],E=h[1],O=$r(Qr(!1),2),S=(O[0],O[1],$r(Qr(!0),2)),N=S[0],P=S[1],k=$r(Qr(!1),2),j=k[0],I=k[1],A=$r(Qr(!1),2),x=A[0],C=A[1],M=$r(Qr("login_popup "+window.vibebp.style),2),L=M[0],D=M[1],U=$r(Qr(!1),2),R=(U[0],U[1],$r(Qr([]),2)),J=(R[0],R[1],$r(Qr(!1),2)),F=(J[0],J[1]),G=$r(Qr(!0),2),z=G[0],B=G[1],H=$r(Qr(!0),2),K=H[0],V=H[1],$=$r(Qr(!1),2),W=$[0],Y=$[1],Z=$r(Qr(!1),2),Q=Z[0],X=Z[1],ee=$r(Qr(!1),2),te=ee[0],ne=ee[1],re=$r(Qr({}),2),ae=re[0],oe=re[1];window.vibebp.settings.firebase_config&&"undefined"!=typeof firebase&&(firebase.apps.length||firebase.initializeApp(JSON.parse(window.vibebp.settings.firebase_config)));Xr((function(){return function(){0}}),[]),Xr((function(){if(!f){var e=new URL(window.location.href),t=e.searchParams.get("action"),n=e.searchParams.get("key"),r=decodeURIComponent(e.searchParams.get("login"));"rp"==t&&n&&n.length&&r&&r.length&&(s(!0),D(L+" active"),oe({key:n,user_login:r}))}}),[f]),Xr((function(){return Vr(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(new Date).getTime(),e.next=3,localforage.getItem("vibebp_last_post_requests_time");case 3:(r=e.sent)?(r=parseInt(r),window.vibebp.settings.post_data_check_interval=parseInt(window.vibebp.settings.post_data_check_interval),n=t-r<window.vibebp.settings.post_data_check_interval?setTimeout(se,window.vibebp.settings.post_data_check_interval-(t-r)):setTimeout(se,window.vibebp.settings.post_data_check_interval)):n=setTimeout(se,window.vibebp.settings.post_data_check_interval);case 5:case"end":return e.stop()}}),e)})))(),function(){n&&clearTimeout(n)}}),[te]),Xr((function(){return Q&&(t=setTimeout((function(){fetch("".concat(window.vibebp.api.regenerate_token,"?client_id=").concat(window.vibebp.settings.client_id,"&force"),{method:"post",body:JSON.stringify({token:aa("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){console.log("refresh VibeBP token"),ra("vibebp").setToken(e.token),localforage.setItem("bp_login_token",e.token),X(parseInt(e.expires))}))}),1e3*parseInt(Q)-(new Date).getTime()-12e4)),function(){t&&clearTimeout(t)}}),[Q]),Xr((function(){document.addEventListener("tokenGenerated",(function(){Y(!W)})),window.vibebp.settings.email_login&&I(!0),localforage.getItem("bp_user").then((function(e){e&&("object"!==Hr(e)?y(JSON.parse(e)):y(e))}));var e=setTimeout((function(){B(!1)}),5e3);return localforage.getItem("loggedInNumber").then((function(e){e&&ra("vibebp").setData("loggedInNumber",e)})),document.addEventListener("userLoaded",Fr,{once:!0,passive:!0}),document.addEventListener("reload_last_request",ie,{once:!1,passive:!0}),function(){clearTimeout(e),document.removeEventListener("userLoaded",Fr),document.removeEventListener("reload_last_request",ie)}}),[]),Xr((function(){new Promise((function(e){e(localforage.getItem("bp_login_token"))})).then((function(e){e?(b(!0),aa("vibebp").setToken(e),console.log("found"),aa("vibebp").verifyUser("".concat(window.vibebp.api.validate_token,"?client_id=").concat(window.vibebp.settings.client_id,"&force"),e),T.subscribe((function(){if(N){void 0!==T.getState().user&&p(T.getState().user),aa("vibebp").getUser()&&Object.keys(aa("vibebp").getUser()).length&&document.dispatchEvent(new CustomEvent("userLoaded",{detail:{userLoaded:T.getState().user}}));var t=aa("vibebp").getNotifications();if(t&&t.length?t.map((function(e,t){var n="var(--dark)",r="",a="var(--white)";if(e.hasOwnProperty("backgroundColor")&&e.backgroundColor)n=e.backgroundColor;else switch(e.type){case"error":n="var(--error)",r="vicon vicon-alert";break;case"success":n="var(--success)",r="vicon vicon-check";break;default:n="var(--dark)"}e.hasOwnProperty("textColor")&&e.textColor&&(a=e.textColor);var o="bottomRight";if(e.hasOwnProperty("position")&&e.position&&(o=e.position),!("object"!==Hr(window.iziToast)||e.hasOwnProperty("read")&&e.read)){var i={title:void 0!==e.title?e.title:"",message:void 0!==e.text?e.text:"",icon:r,backgroundColor:n,titleColor:a,messageColor:a,iconColor:a,progressBarColor:"var(--primary)",rtl:window.vibebp.settings.is_rtl,position:o,onOpened:function(){}};e.iconUrl&&(i.iconUrl=e.iconUrl),e.icon&&(i.icon=e.icon),e.hasOwnProperty("actions")&&e.actions&&e.actions.length&&(i.buttons=[],e.actions.map((function(t){i.buttons.push(['<a className="link">'+t.label+"</a>",function(n,r){var a=new CustomEvent(t.event,{detail:zr(zr({},t),{},{item_id:e.item_id,user_id:aa("vibebp").getUser().id})});document.dispatchEvent(a)}])}))),window.iziToast.show(i)}ce(e)})):F(!1),document.querySelector("body").classList.remove("logged-out"),document.querySelector("body").classList.add("logged-in"),P(!1),T.getState().user&&Object.keys(T.getState().user).length&&(B(!1),window.vibebp.settings.firebase_config&&"undefined"!=typeof firebase&&firebase.auth()&&!firebase.auth().currentUser)){var n=aa("vibebp").getUser();firebase.auth().signInWithEmailAndPassword(n.email,n.refresh_token)}!aa("vibebp").getData("loggedinMenu")&&oa?(oa=0,fetch("".concat(window.vibebp.api.url,"/loggedinmenu"),{method:"post",body:JSON.stringify({token:e})}).then((function(e){return e.json()})).then((function(e){var t;e.hasOwnProperty("data")&&e.data.hasOwnProperty("status")&&401===e.data.status&&b(!1),T.getState().user&&Object.keys(T.getState().user).length&&b(!1),e.status&&(ra("vibebp").setData("loggedinMenu",e.menu),document.querySelector(".vibebp-login").setAttribute("href","#")),e.hasOwnProperty("code")&&401==(null===(t=e.data)||void 0===t?void 0:t.status)&&document.dispatchEvent(new Event("vibebp_logout"))}))):document.querySelector(".vibebp-login").setAttribute("href","#")}}))):(B(!1),b(!1))}))}),[W]),Xr((function(){var e=[];return window.vibebp.settings.firebase_config&&"undefined"!=typeof firebase&&"function"==typeof firebase.database&&Object.keys(u).length&&(K&&firebase.auth()&&firebase.auth().currentUser&&(firebase.database().ref("users/".concat(u.id,"/status")).once("value").then((function(e){if(e.exists()){var t=e.val();firebase.database().ref("users/".concat(u.id,"/status")).set(t+1)}else firebase.database().ref("users/".concat(u.id,"/status")).set(1)})),firebase.database().ref("users/".concat(u.id,"/status")).onDisconnect().set(0),fetch("".concat(window.vibebp.api.url,"/followers"),{method:"post",body:JSON.stringify({token:aa("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&e.followers.map((function(e){firebase.database().ref("users/".concat(e.ID,"/status")).once("value").then((function(t){t.exists()&&t.val()&&firebase.database().ref("notifications/".concat(e.ID)).push({sender:aa("vibebp").getUser().id,type:"user_online",status:1,time:(new Date).getTime()})}))}))})),V(!1)),window.addEventListener("online",(function(){ra("vibebp").addNotification({text:window.vibebp.translations.online})}),!1),window.addEventListener("offline",(function(){ra("vibebp").addNotification({text:window.vibebp.translations.offline})}),!1)),u.hasOwnProperty("exp")&&Q!=u.exp&&X(parseInt(u.exp)),function(){e.length&&e.map((function(e){clearTimeout(e)}))}}),[u]),Xr((function(){T.getState().user&&Object.keys(T.getState().user)&&p(T.getState().user)}),[T.getState().user]),Xr((function(){document.addEventListener("vibebp_show_login_popup",(function(){T.getState().user&&Object.keys(T.getState().user).length||(s(!0),setTimeout((function(){D(L+" active")}),30))})),window.innerWidth<1024&&"undefined"!=typeof firebase&&firebase.hasOwnProperty("auth")&&firebase.auth().getRedirectResult().then((function(e){if(e.credential){var t=e.user,n=e.credential;n.hasOwnProperty("providerId")&&n.providerId&&a!==n.providerId&&(o(n.providerId),document.dispatchEvent(new Event("vibebp_show_login_popup")));n.accessToken;ra("vibebp").setData("firebaseUser",t),t.getIdToken().then((function(t){le(e,t).then((function(e){ra("vibebp").setUser(e)}))}))}e.user})).catch((function(e){console.log(e)}))}),[]);var ie=function(e){e.detail.hasOwnProperty("url")&&e.detail.url&&(console.log(e.detail.url),localforage.removeItem(e.detail.url).then((function(){document.dispatchEvent(new Event("vibebp_component_reload"))})))},le=function(e,t){return fetch("".concat(window.vibebp.api.url,"/sociallogin?client_id=").concat(window.vibebp.settings.client_id,"&nocache"),{method:"post",body:JSON.stringify({social:e.credential.signInMethod,client_id:window.vibebp.settings.client_id,user:{email:e.user.email,uid:e.user.uid,name:e.user.displayName,avatar:e.user.photoURL,phoneNumber:e.user.phoneNumber,last_login:e.user.metadata.lastSignInTime,create_time:e.user.metadata.creationTime},idToken:t})}).then((function(e){return e.json()})).then((function(t){if(t.status)return localforage.setItem("bp_login_token",t.token),fetch("".concat(window.vibebp.api.validate_token,"?client_id=").concat(window.vibebp.settings.client_id,"&force"),{method:"post",body:t.token}).then((function(e){return e.json()})).then((function(n){if(n.hasOwnProperty("data"))return"undefined"!=typeof firebase&&firebase&&firebase.hasOwnProperty("database")&&window.vibebp.settings.firebase_config&&firebase.database().ref("users/".concat(n.data.data.user.id,"/firebaseUid")).set(e.user.uid),i(e.user.uid).then((function(e){if(!e||!e.length){if(localforage.setItem("bp_user",JSON.stringify(n.data.data.user)),sessionStorage.setItem("bp_user",JSON.stringify(n.data.data.user)),p(n.data.data.user),ra("vibebp").setToken(t.token),ra("vibebp").setUser(n.data.data.user),document.querySelector("body").classList.add("vibebp-logged-in"),window.vibebp.settings.login_redirect&&n.hasOwnProperty("redirect_component")&&n.redirect_component){var r="";r=n.redirect_component.split("http").length>1?n.redirect_component:n.redirect_component.split("#").length>1?window.vibebp.settings.login_redirect+n.data.data.user.slug+n.redirect_component:window.vibebp.settings.login_redirect+n.data.data.user.slug+"#"+n.redirect_component,window.location.href=r}var a=sessionStorage.getItem("loggedinmenu");return a?(ra("vibebp").setData("loggedinMenu",JSON.parse(a)),document.querySelector(".vibebp-login").setAttribute("href","#")):fetch("".concat(window.vibebp.api.url,"/loggedinmenu"),{method:"post",body:JSON.stringify({token:t.token})}).then((function(e){return e.json()})).then((function(e){var t;e.status&&(ra("vibebp").setData("loggedinMenu",e.menu),document.querySelector(".vibebp-login").setAttribute("href","#")),e.hasOwnProperty("code")&&401==(null===(t=e.data)||void 0===t?void 0:t.status)&&document.dispatchEvent(new Event("vibebp_logout")),e.menu})),n.data.data.user}document.dispatchEvent(new Event("vibebp_logout"))}));document.dispatchEvent(new Event("vibebp_logout"))}))}))},ce=function(e){if(e.hasOwnProperty("read")&&e.read)return!1;var t=Gr(aa("vibebp").getNotifications()),n=t.findIndex((function(t){return t.id===e.id}));n>=0&&(t[n].read=!0,e.read=!0,aa("vibebp").updateNotification(e))},se=function(){Vr(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,localforage.getItem("post_data");case 2:if(!(t=e.sent)){e.next=7;break}return e.delegateYield(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=JSON.parse(t),Gr(t),r=[],!t||!t.length){e.next=23;break}n=0;case 5:if(!(n<t.length)){e.next=14;break}return(a=t[n].data).hasOwnProperty("token")&&(a.token=aa("vibebp").getToken()),e.next=10,fetch(t[n].url+"&nocache",{method:"post",headers:t[n].headers,body:JSON.stringify(a)}).then(function(){var e=Vr(regeneratorRuntime.mark((function e(a){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.ok||r.push(t[n]);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){console.log(e),r.push(t[n])}));case 10:console.log("hit ended");case 11:n++,e.next=5;break;case 14:return e.next=16,localforage.setItem("vibebp_last_post_requests_time",(new Date).getTime());case 16:if(console.log(r),r.length)for(n=r.length-1;n>=0;n--)r[n].hasOwnProperty("count")||(r[n].count=0),r[n].count++,r[n].count>10&&r.splice(n,1);return e.next=20,localforage.setItem("post_data",JSON.stringify(r));case 20:ne(Math.random()),e.next=26;break;case 23:return e.next=25,localforage.setItem("vibebp_last_post_requests_time",(new Date).getTime());case 25:ne(Math.random());case 26:case"end":return e.stop()}}),e)}))(),"t0",5);case 5:e.next=10;break;case 7:return e.next=9,localforage.setItem("vibebp_last_post_requests_time",(new Date).getTime());case 9:ne(Math.random());case 10:case"end":return e.stop()}}),e)})))()};return wp.element.createElement(ea,null,"static"!=e.type?u&&Object.keys(u).length?wp.element.createElement("div",{className:"loggedin_user_div"},wp.element.createElement("a",{className:"loggedin_user","data-id":u.id,onClick:function(){E(!_)}},wp.element.createElement("img",{src:u.avatar,alt:u.displayname}),wp.element.createElement("span",{className:"vibebp_name"},u.displayname)),_?wp.element.createElement(Or,{logout:function(){if("undefined"!=typeof firebase&&firebase&&firebase.hasOwnProperty("database")&&window.vibebp.settings.firebase_config&&window.vibebp.settings.session_lock&&firebase.auth().currentUser){var e=new CustomEvent("userLogout",{detail:{userLoaded:!0,loggedOut:!0}});document.dispatchEvent(e),firebase.database().ref("users/".concat(u.id,"/status")).set(0).then((function(){document.querySelector("body").classList.add("vibebp_logout"),firebase.auth().signOut().then((function(){p({}),aa("vibebp").logout()}),(function(e){console.log("logout failed")}))}))}else{e=new CustomEvent("userLogout",{detail:{userLoaded:!0,loggedOut:!0}});document.dispatchEvent(e),document.querySelector("body").classList.add("vibebp_logout"),window.vibebp.settings.firebase_config?firebase.auth().signOut().then((function(){p({}),aa("vibebp").logout()}),(function(e){console.log("logout failed")})):(p({}),aa("vibebp").logout())}}}):""):wp.element.createElement("a",{onClick:function(e){e.stopPropagation(),e.target.parentElement.classList.contains("is_loading")||(s(!0),setTimeout((function(){D(L+" active")}),30))}},z?"...":wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:e.title}})):"",c||"static"==e.type&&u&&!Object.keys(u).length?ReactDOM.createPortal(wp.element.createElement("div",{className:e.hasOwnProperty("type")&&"static"==e.type?"static_wrapper":"loginpopup_wrapper",onClick:function(e){e.stopPropagation(),-1!==e.target.className.indexOf("loginpopup_wrapper")&&(D(L.replace(/active/g)),s(!1))}},wp.element.createElement("div",{className:L},window.vibebp.settings.customizer.login_image.length?wp.element.createElement("div",{className:"login_popup_bg_img"},wp.element.createElement("img",{src:window.vibebp.settings.customizer.login_image})):"",e.hasOwnProperty("type")&&"static"==e.type&&f?wp.element.createElement("div",{className:"login_popup_content"},wp.element.createElement("h2",{dangerouslySetInnerHTML:{__html:window.vibebp.translations.login_heading}}),g?wp.element.createElement("h2",{dangerouslySetInnerHTML:{__html:g.displayname}}):wp.element.createElement("h2",null,"...")):wp.element.createElement("div",{className:window.vibebp.settings.email_login?"login_popup_content email_login":"login_popup_content"},ae.hasOwnProperty("key")&&ae.key.length?wp.element.createElement(Mr,{resetPwdArgs:ae,back:function(){oe({})}}):window.vibebp.settings.email_login?x?wp.element.createElement(fr,{setRegistration:C}):wp.element.createElement(ea,null,wp.element.createElement(q,{setemailSignIn:I,setUser:function(e){p(e),s(!1)}}),j?wp.element.createElement(v,{setLoginpopupClass:D,setUser:function(e){p(e),s(!1)},setRegistration:C,setemailSignIn:I,childProviderId:a}):""):j?wp.element.createElement(q,{setemailSignIn:I,setUser:function(e){p(e),s(!1)}}):x?wp.element.createElement(fr,{setRegistration:C}):wp.element.createElement(v,{setLoginpopupClass:D,setUser:function(e){p(e),s(!1)},setRegistration:C,setemailSignIn:I,childProviderId:a}),"static"!=e.type?wp.element.createElement("a",{onClick:function(e){e.stopPropagation(),D(L.replace(/active/g)),s(!1)},className:"vicon-close"}):""))),document.querySelector("#vibebp_login_wrapper")):"","")},la=0;document.addEventListener("DOMContentLoaded",(function(){document.querySelector(".vibebp-login")&&(la||(document.querySelectorAll(".vibebp-login").forEach((function(e){ta(wp.element.createElement(ia,{type:document.querySelector(".vibebp-login").getAttribute("type"),title:e.innerHTML}),e)})),la=1)),document.addEventListener("wp_login_sync",(function(){document.querySelector(".vibebp-login")&&document.querySelectorAll(".vibebp-login").forEach((function(e){ta(wp.element.createElement(ia,{type:document.querySelector(".vibebp-login").getAttribute("type"),title:e.innerHTML}),e)}))}))}),!1),document.addEventListener("vibebp_logout",(function(){window.vibebp.settings.firebase_config&&firebase&&firebase.auth()?firebase.auth().signOut().then((function(){aa("vibebp").logout()}),(function(e){console.log("logout failed")})):aa("vibebp").logout()})),document.querySelector(".vibebp-login")&&document.querySelector(".vibebp-login")&&(la||(document.querySelectorAll(".vibebp-login").forEach((function(e){ta(wp.element.createElement(ia,{type:document.querySelector(".vibebp-login").getAttribute("type"),title:e.innerHTML}),e)})),la=1))}]);