!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){},function(t,n,r){"use strict";r.r(n);r(0);var a=wp.element.createContext,o=wp.data,l=(o.select,o.dispatch,a({value:{},update:function(e){}})),s=wp.element,c=(s.createElement,s.useState,s.useEffect,s.Fragment,s.render,function(e){var t,n,r=e.progress;switch(e.size){case"xs":t=10,n=1;break;case"s":t=12,n=1.2;break;case"sm":t=25,n=2.5;break;case"med":t=50,n=5;break;case"lg":t=75,n=7.5;break;case"xl":t=100,n=10;break;default:t=50,n=5}var a=t-2*n,i=2*a*Math.PI,o=i-r/100*i;return wp.element.createElement("div",{className:"react-progress-circle"},wp.element.createElement("svg",{height:2*t,width:2*t},wp.element.createElement("circle",{className:"ReactProgressCircle_circleBackground",strokeWidth:n,style:{strokeDashoffset:o},r:a,cx:t,cy:t}),wp.element.createElement("circle",{className:"ReactProgressCircle_circle",strokeWidth:n,strokeDasharray:i+" "+i,style:{strokeDashoffset:o},r:a,cx:t,cy:t})))});function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||u(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e){return function(e){if(Array.isArray(e))return m(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||u(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=wp.element,b=(f.createElement,f.useState),v=f.useEffect,w=(f.Fragment,f.render,f.useRef),h=wp.data;h.dispatch,h.select;function y(e){if(void 0===e)return!0;if("undefined"===e)return!0;if(null==e)return!0;if("number"==typeof e)return!1;if(Array.isArray(e)||"string"==typeof e||e instanceof String)return 0===e.length;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var g=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=w(Date.now());v((function(){var n=setTimeout((function(){Date.now()-r.current>=t&&(e(),r.current=Date.now())}),t-(Date.now()-r.current));return function(){clearTimeout(n)}}),[t].concat(p(n)))};function _(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))if(n){for(var r=0;r<t.length;r++)if(t[r][n]===e[n])return r}else for(var a=0;a<t.length;a++)if(t[a].id===e.id)return a;return-1}var E=function(e){var t=d(b(e.timestamp),2),n=(t[0],t[1]),r=d(b(0),2),a=r[0],i=r[1],o=Math.floor(Date.now()/1e3);v((function(){if(n(parseInt(e.timestamp)),e.timestamp)if(e.hasOwnProperty("notimediff"))i(parseInt(e.timestamp));else{var t=e.timestamp;e.timestamp.toString().includes("-")&&(t=new Date(t).getTime()/1e3),parseInt(t)>o?i(parseInt(t)-o):i(o-parseInt(t))}}),[e.timestamp]);return wp.element.createElement("span",{className:"friendly_time"},function(){if(a<0)return window.vibeprojects.translations.just_now;var t,n,r,i=0,o=0,l=0,s=[{label:window.vibeprojects.time_labels.year.single,multi:window.vibeprojects.time_labels.year.multi,value:31536e3},{label:window.vibeprojects.time_labels.month.single,multi:window.vibeprojects.time_labels.month.multi,value:2592e3,max:12},{label:window.vibeprojects.time_labels.week.single,multi:window.vibeprojects.time_labels.week.multi,value:604800,max:7},{label:window.vibeprojects.time_labels.day.single,multi:window.vibeprojects.time_labels.day.multi,value:86400,max:31},{label:window.vibeprojects.time_labels.hour.single,multi:window.vibeprojects.time_labels.hour.multi,value:3600,max:24},{label:window.vibeprojects.time_labels.minute.single,multi:window.vibeprojects.time_labels.minute.multi,value:60,max:60},{label:window.vibeprojects.time_labels.second.single,multi:window.vibeprojects.time_labels.second.multi,value:1,max:60}];if(a>=776736e3)return window.vibeprojects.translations.unlimited_time;if(a<=0)return e.hasOwnProperty("notimediff")?a+" "+window.vibeprojects.time_labels.second.multi:window.vibeprojects.translations.just_now;for(var c=0;c<s.length;c++)if(o=c,(n=s[c]).value<a){(i=Math.floor(a/n.value))>n.max&&(i=n.max);break}return t=i+" "+(i>1?n.multi:n.label),n.value>1&&(r=s[o+1],(l=Math.floor(a%n.value/r.value))&&(t+=", "+l+" "+(l>1?r.multi:r.label))),t}())};const{createElement:j,useState:O,useEffect:k,Fragment:N,render:x}=wp.element,{dispatch:S,select:P}=wp.data;var I=e=>{const[t,n]=O({});return k(()=>{let t="",r="";switch(e.type){case"friends":r="user",t=e.id.item_id;break;case"forum":r="forum",t=e.id.item_id;break;case"group":r="group",t=e.id.item_id;break;case"activity":r="user",t=e.id.secondary_item_id;break;case"member":case"name":case"user_tip":case"user":r="user",t=e.id.user_id;break;default:r=e.type,t=e.id.item_id}r||(r="user");let a=P("vibebp").getData(r+"_"+t);a?n(a):localforage.getItem(r+"_"+t).then(a=>{null!==a?(n(JSON.parse(a)),S("vibebp").setData(r+"_"+t,JSON.parse(a))):fetch(`${window.vibebp.api.url}/avatar?id=${r+"_"+t}&client_id=${window.vibebp.settings.client_id}`,{method:"post",body:JSON.stringify({type:e.type,ids:e.id,token:P("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.hasOwnProperty("avatar")&&(S("vibebp").setData(r+"_"+t,e),localforage.setItem(r+"_"+t,JSON.stringify(e)),n(e))})})},[e.id.item_id,e.id.user_id]),t.hasOwnProperty("avatar")||t.hasOwnProperty("name")?"member"==e.type?React.createElement("span",{className:"vibebp_member"},React.createElement("img",{src:t.avatar,className:"vibebp_avatar",onClick:e.click,alt:t.name,title:t.name}),React.createElement("span",null,t.name)):"group"==e.type?React.createElement("span",{className:"vibebp_group"},React.createElement("img",{src:t.avatar,className:"vibebp_avatar",onClick:e.click,alt:t.name,title:t.name}),React.createElement("span",null,t.name)):"user_tip"==e.type?React.createElement("span",{className:"vibebp_member tip",title:t.name},React.createElement("img",{src:t.avatar,className:"vibebp_avatar",onClick:e.click,alt:t.name,title:t.name})):"name"==e.type||"forum"==e.type?React.createElement("span",null,t.name):React.createElement("img",{src:t.avatar,className:"vibebp_avatar",onClick:e.click,alt:t.name,title:t.name}):""};const C=e=>{const[t,n]=O(!0),[r,a]=O(null);return k(()=>{n(!0);let t=[];r&&r.abort();let i={},o=new AbortController;r&&(i={signal:o.signal}),a(o),e.hasOwnProperty("avatars")&&(t=e.avatars);let l="user";if(e.hasOwnProperty("type")&&(l=e.type),e.hasOwnProperty("user_ids")){let n=e.user_ids;Array.isArray(e.user_ids)||(n=Object.values(e.user_ids)),n.map(e=>{Array.isArray(e)?e.map(e=>{-1==t.findIndex(t=>t.id.user_id==e)&&t.push({type:l,id:{user_id:e}})}):-1==t.findIndex(t=>t.id.user_id==e)&&t.push({type:l,id:{user_id:e}})})}let s=[],c=[];t.map((e,t)=>{let n="",r="";switch(e.type){case"friends":r="user",n=e.id.item_id;break;case"forum":r="forum",n=e.id.item_id;break;case"group":r="group",n=e.id.item_id;break;case"activity":r="user",n=e.id.secondary_item_id;break;case"member":case"name":case"user_tip":case"user":r="user",n=e.id.user_id;break;default:r=e.type,n=e.id.item_id}let a=P("vibebp").getData(r+"_"+n);a&&void 0!==a||c.push(localforage.getItem(r+"_"+n).then(e=>{e?S("vibebp").setData(r+"_"+n,JSON.parse(e)):s.push({type:r,key:n})}))}),c.length?Promise.all(c).then(()=>{s.length?fetch(`${window.vibebp.api.url}/avatars?ids=${JSON.stringify(s)}&client_id=${window.vibebp.settings.client_id}`,{...i,method:"post",body:JSON.stringify({ids:s,type:l,token:P("vibebp").getToken()})}).then(e=>e.json()).then(e=>{let t=[];e.status&&e.values.map(e=>{S("vibebp").setData(e.type+"_"+e.key,e.value),t.push(localforage.setItem(e.type+"_"+e.key,JSON.stringify(e.value)))}),t.length?Promise.all(t).then(()=>{n(!1)}):n(!1)}):n(!1)}):n(!1)},[e.user_ids,e.type]),React.createElement(N,null,t?"":e.children)};function A(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return D(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var R=wp.element,T=(R.createElement,R.render,R.useState),M=R.useEffect,U=R.Fragment,$=R.useContext,L=(window.vibeprojects&&window.vibeprojects.apiUrl,function(e){$(l);var t,n,r=A(T(e.projectListItems),2),a=r[0],i=r[1];M((function(){i(e.projectListItems)}),[e.projectListItems]);var o=window.vibeprojects.settings.statuses.project.findIndex((function(t){return t.value==e.project.status}));return o<0&&(o=0),e.hasOwnProperty("project")&&void 0!==e.project?wp.element.createElement(U,null,"list"==e.view?wp.element.createElement("div",{className:"project_list_item",onClick:function(){e.open()}},a.filter((function(e){return e.selected})).map((function(t){return wp.element.createElement("div",{className:"project_info_"+t.key},function(t){var n,r;if("project_image"==t)return null!==(n=e.project)&&void 0!==n&&null!==(r=n.image)&&void 0!==r&&r.length?wp.element.createElement("img",{src:e.project.image,alt:"project image"}):wp.element.createElement("span",{className:"project_image"});if("project_title"==t)return wp.element.createElement("strong",null,e.project.name);if("project_type"==t)return e.project.type.length?e.project.type.map((function(e){return wp.element.createElement("span",{className:"project_type"},e.name)})):"";if("project_status"==t){var a=window.vibeprojects.settings.statuses.project.findIndex((function(t){return t.value==e.project.status}));return wp.element.createElement("div",{className:"project_status"},wp.element.createElement("span",{className:"status "+e.project.status,style:{background:window.vibeprojects.settings.statuses.project[a].color}},window.vibeprojects.settings.statuses.project[a].label))}if("project_progress"==t)return wp.element.createElement("div",{className:"progress_wrap"},wp.element.createElement("span",{className:"progress_wrapper"},wp.element.createElement("span",{className:"increment",style:{width:e.project.project_progress+"%"}})),wp.element.createElement("span",{className:"progress_label"},e.project.project_progress+"%"));if("members"==t)return wp.element.createElement("div",{className:"vibe_project_members"},wp.element.createElement(C,{user_id:e.project.members.filter((function(e,t){return t<5}))},e.project.members.filter((function(e,t){return t<5})).map((function(e){return wp.element.createElement(I,{type:"user",id:{user_id:e},not_show_name:!0})}))),e.project.members.length>5?wp.element.createElement("span",null,"+",e.project.members.length-5):"");if(e.project.meta.length&&e.project.meta.findIndex((function(e){return e.key==t}))>-1){var i=e.project.meta[e.project.meta.findIndex((function(e){return e.key==t}))];if(window.vibeprojects.settings.project.listView.findIndex((function(e){return e.key==t}))>-1){var o=window.vibeprojects.settings.project.listView,l=window.vibeprojects.settings.project.listView.findIndex((function(e){return e.key==t}));"select"==o[l].type&&(i.value=o[l].options[i.value]),"switch"==o[l].type&&("S"==i.value?i.value=window.vibeprojects.translations.yes:i.value=window.vibeprojects.translations.no)}return i.value.length?wp.element.createElement("span",{className:"tip",title:i.desc},"start_date"==i.key||"end_date"==i.key?wp.element.createElement(E,{timestamp:i.value}):"S"==i.value?window.vibeprojects.translations.on:window.vibeprojects.settings.additional_fields.create_project_fields.findIndex((function(e){return e.key==i.key}))>-1&&"select"==window.vibeprojects.settings.additional_fields.create_project_fields[window.vibeprojects.settings.additional_fields.create_project_fields.findIndex((function(e){return e.key==i.key}))].type&&window.vibeprojects.settings.additional_fields.create_project_fields[window.vibeprojects.settings.additional_fields.create_project_fields.findIndex((function(e){return e.key==i.key}))].options.findIndex((function(e){return e.value==i.value}))>-1?window.vibeprojects.settings.additional_fields.create_project_fields[window.vibeprojects.settings.additional_fields.create_project_fields.findIndex((function(e){return e.key==i.key}))].options[window.vibeprojects.settings.additional_fields.create_project_fields[window.vibeprojects.settings.additional_fields.create_project_fields.findIndex((function(e){return e.key==i.key}))].options.findIndex((function(e){return e.value==i.value}))].label:i.value):""}}(t.key))}))):wp.element.createElement("div",{className:"project",onClick:function(){e.open()}},wp.element.createElement("div",{className:"project_title"},wp.element.createElement("span",null,wp.element.createElement("div",{className:"project_status"},wp.element.createElement("span",{className:"status "+e.project.status,style:{background:window.vibeprojects.settings.statuses.project[o].color}},window.vibeprojects.settings.statuses.project[o].label)),wp.element.createElement("strong",{dangerouslySetInnerHTML:{__html:e.project.name}}),e.project.type.length?wp.element.createElement("div",{className:"project_types"},e.project.type.map((function(e){return wp.element.createElement("span",{className:"project_type"},e.name)}))):""),null!==(t=e.project)&&void 0!==t&&null!==(n=t.image)&&void 0!==n&&n.length?wp.element.createElement("img",{src:e.project.image,alt:"project image"}):""),wp.element.createElement("div",{className:"project_body"},e.project.meta.length?wp.element.createElement("div",{className:"project_meta"},e.project.meta.map((function(e){if(e.value&&"start_date"!=e.key)return wp.element.createElement("span",{className:"tip",title:e.desc},e.icon?wp.element.createElement("span",{className:e.icon}):"","start_date"==e.key||"end_date"==e.key?wp.element.createElement(E,{timestamp:e.value}):"S"==e.value?window.vibeprojects.translations.on:window.vibeprojects.settings.additional_fields.create_project_fields.findIndex((function(t){return t.key==e.key}))>-1&&"select"==window.vibeprojects.settings.additional_fields.create_project_fields[window.vibeprojects.settings.additional_fields.create_project_fields.findIndex((function(t){return t.key==e.key}))].type&&window.vibeprojects.settings.additional_fields.create_project_fields[window.vibeprojects.settings.additional_fields.create_project_fields.findIndex((function(t){return t.key==e.key}))].options.findIndex((function(t){return t.value==e.value}))>-1?window.vibeprojects.settings.additional_fields.create_project_fields[window.vibeprojects.settings.additional_fields.create_project_fields.findIndex((function(t){return t.key==e.key}))].options[window.vibeprojects.settings.additional_fields.create_project_fields[window.vibeprojects.settings.additional_fields.create_project_fields.findIndex((function(t){return t.key==e.key}))].options.findIndex((function(t){return t.value==e.value}))].label:e.value)}))):""),wp.element.createElement("div",{className:"progress_wrap"},wp.element.createElement("span",{className:"progress_wrapper"},wp.element.createElement("span",{className:"increment",style:{width:e.project.project_progress+"%"}})),wp.element.createElement("span",{className:"progress_label"},e.project.project_progress+"%")),wp.element.createElement("div",{className:"project_footer"},wp.element.createElement("div",{className:"vibe_project_members"},wp.element.createElement(C,{user_id:e.project.members.filter((function(e,t){return t<5}))},e.project.members.filter((function(e,t){return t<5})).map((function(e){return wp.element.createElement(I,{type:"user",id:{user_id:e},not_show_name:!0})}))),e.project.members.length>5?wp.element.createElement("span",null,"+",e.project.members.length-5):""),wp.element.createElement("span",{className:"vicon vicon-arrow-right link"})))):""}),F=wp.data,J=F.select,H=(F.dispatch,function(e){var t,n,r;return J("vibebp").getUser().roles.indexOf("administrator")>-1||(e.indexOf("project")>-1&&(!Object.keys(window.vibeprojects.settings.capabilitites.project_capability).length||(null===(t=window.vibeprojects.settings.capabilitites.project_capability[J("vibebp").getUser().member_type])||void 0===t?void 0:t.indexOf(e))>-1)||(e.indexOf("board")>-1&&(!Object.keys(window.vibeprojects.settings.capabilitites.board_capability).length||(null===(n=window.vibeprojects.settings.capabilitites.board_capability[J("vibebp").getUser().member_type])||void 0===n?void 0:n.indexOf(e))>-1)||e.indexOf("card")>-1&&(!Object.keys(window.vibeprojects.settings.capabilitites.card_capability).length||(null===(r=window.vibeprojects.settings.capabilitites.card_capability[J("vibebp").getUser().member_type])||void 0===r?void 0:r.indexOf(e))>-1)))}),Y=function(e){var t=e.children,n=e.onClose;return e.open?ReactDOM.createPortal(wp.element.createElement("div",{className:"vibe_editor_modal projects_modal"},wp.element.createElement("span",{onClick:n}),wp.element.createElement("div",{className:"ve_modal-content"},wp.element.createElement("div",{className:"ve_modal-header"},wp.element.createElement("div",null),wp.element.createElement("span",{className:"vicon vicon-close",onClick:n})),wp.element.createElement("div",{className:"ve_modal-body"},t))),document.body):null};function V(e){return function(e){if(Array.isArray(e))return B(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||X(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){G(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||X(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function X(e,t){if(e){if("string"==typeof e)return B(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B(e,t):void 0}}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Z=wp.element,Q=(Z.createElement,Z.render,Z.useState),K=Z.useEffect,ee=Z.Fragment,te=Z.useContext,ne=Z.useRef,re=wp.data,ae=re.select,ie=re.dispatch,oe=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",le=function(e){var t=ne(),n=(te(l),z(Q(!1),2)),r=n[0],a=n[1],o=z(Q(!1),2),s=o[0],c=o[1],d=z(Q({page:1,search_terms:"",type:"",project_id:e.project.id}),2),p=d[0],u=d[1],m=z(Q([]),2),f=m[0],b=m[1],v=z(Q([]),2),w=v[0],h=v[1],y=z(Q([]),2),g=y[0],_=y[1],E=z(Q(!1),2),j=E[0],O=E[1],k=z(Q(0),2),N=k[0],x=k[1],S=z(Q(!1),2),P=S[0],C=S[1],A=z(Q({project_id:e.project.id}),2),D=A[0],R=A[1],T=z(Q(""),2),M=T[0],U=T[1],$=z(Q(""),2),L=$[0],F=$[1],J=z(Q({}),2),Y=J[0],q=J[1],G=z(Q([]),2),X=G[0],B=G[1],Z=z(Q({name:"",email:"",type:"",team:""}),2),re=Z[0],le=Z[1],se=z(Q(!1),2),ce=se[0],de=se[1];K((function(){if(t){var e=t.current.getBoundingClientRect(),n={maxWidth:e.width+"px"};window.innerWidth<720&&(n.maxWidth=e.width+60+"px",n.paddingLeft="60px"),q(n)}}),[t]),K((function(){R({project_id:e.project.id}),u(W(W({},p),{},{project_id:e.project.id}))}),[e.project]),K((function(){a(!0),fetch("".concat(oe,"/project/members/?args=").concat(JSON.stringify(p)),{method:"post",body:JSON.stringify(W(W({},p),{},{token:ae("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){if(e.status)if(j){if(b([].concat(V(f),V(e.data.users))),O(!1),e.data.member_types.length){var t=V(w);e.data.member_types.map((function(e){w.length&&-1!=w.findIndex((function(t){return t.term_id==e.term_id}))||t.push(e)})),h(t)}if(e.data.teams.length){var n=V(g);e.data.teams.map((function(e){g.length&&-1!=g.findIndex((function(t){return t.term_id==e.term_id}))||n.push(e)})),_(n)}}else b(e.data.users),x(e.data.total),h(e.data.member_types),_(e.data.teams);a(!1)}))}),[p]),K((function(){M.length>3&&fetch("".concat(oe,"/search/member?nocache"),{method:"post",body:JSON.stringify({s:M,token:ae("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&R(e.members)}))}),[M]);K((function(){if(s){var t=[],n=[];f.map((function(e){-1==t.findIndex((function(t){return t.term_id==e.member_type.term_id}))&&t.push(e.member_type),-1==n.findIndex((function(t){return t.term_id==e.team.term_id}))&&n.push(e.team)})),h(t),_(n),fetch("".concat(oe,"/project/updateMembers/?post"),{method:"post",body:JSON.stringify({project_id:e.project.id,members:f,token:ae("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){document.dispatchEvent(new CustomEvent("vibebp_project_member_updated",{detail:{members:f,project:e.project.id}})),console.log(f),c(!1),t.hasOwnProperty("message")&&ie("vibebp").addNotification({text:t.message})}))}}),[s]);return wp.element.createElement("div",{className:"project_members"},wp.element.createElement("div",{className:"project_member_header"},wp.element.createElement("div",{className:"search_project_member"},wp.element.createElement("input",{type:"text",placeholder:window.vibeprojects.translations.type_to_search,onBlur:function(e){u(W(W({},p),{},{search:e.target.value}))}}),wp.element.createElement("span",{className:"vicon vicon-search"})),wp.element.createElement("select",{onChange:function(e){u(W(W({},p),{},{type:e.target.value}))},value:p.type},Object.keys(window.vibeprojects.sorters.members).map((function(e){return wp.element.createElement("option",{value:e},window.vibeprojects.sorters.members[e])})))),wp.element.createElement("div",{className:"project_members_list_wrapper"},r?wp.element.createElement("div",{class:"lds-ellipsis"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):wp.element.createElement(ee,null,wp.element.createElement("div",{className:"member_levels"},wp.element.createElement("div",{className:"button-group"},wp.element.createElement("a",{className:L?"":"active",onClick:function(){return F("")}},window.vibeprojects.translations.all),wp.element.createElement("a",{className:"member_type"==L?"active":"",onClick:function(){return F("member_type")}},window.vibeprojects.translations.member_types),wp.element.createElement("a",{className:"teams"==L?"active":"",onClick:function(){return F("teams")}},window.vibeprojects.translations.teams))),wp.element.createElement("div",{className:"project_members_list_wrapper",ref:t},wp.element.createElement(ee,null,f.length?"member_type"==L?wp.element.createElement("div",{className:"project_members_member_type_wrapper"},Object.keys(Y).length?w.map((function(e,t){return wp.element.createElement("div",{className:"member_type_row"},wp.element.createElement("div",{className:"member_type_label"},wp.element.createElement("span",{onClick:function(){if(t>0){var e=V(w);e[t]=e.splice(t-1,1,e[t])[0],h(e)}}},e.name)),wp.element.createElement("div",{className:"member_type_members",style:Y},f.filter((function(t){return t.member_type.term_id==e.term_id})).map((function(e,t){return wp.element.createElement("div",{className:"vibe_projects_member"},wp.element.createElement(I,{type:"member",id:{user_id:e.id}}),"remove_member"==P?wp.element.createElement("span",{onClick:function(){var e=V(f);e.splice(t,1),b(e),c(!0)},className:"vicon vicon-close"}):"",e.team?wp.element.createElement("div",{className:"member_teams"},wp.element.createElement("span",{className:"member_team",style:{background:e.team.color}},e.team.name)):"")}))))})):""):"teams"==L?wp.element.createElement("div",{className:"project_members_member_type_wrapper"},Object.keys(Y).length?g.map((function(e){return wp.element.createElement("div",{className:"member_type_row"},wp.element.createElement("div",{className:"member_type_label",style:{background:e.color,color:"#fff"}},wp.element.createElement("span",{onClick:function(){if(i>0){var e=V(w);e[i]=e.splice(i-1,1,e[i])[0],h(e)}}},e.name)),wp.element.createElement("div",{className:"member_type_members"},f.filter((function(t){return t.team.term_id==e.term_id})).map((function(e,t){return wp.element.createElement("div",{className:"vibe_projects_member"},e.member_type?wp.element.createElement("span",{className:"member_type"},e.member_type.name):wp.element.createElement("span",{className:"member_type"}),wp.element.createElement(I,{type:"member",id:{user_id:e.id}}),"remove_member"==P?wp.element.createElement("span",{onClick:function(){var e=V(f);e.splice(t,1),b(e),c(!0)},className:"vicon vicon-close"}):"")}))))})):""):wp.element.createElement("div",{className:"project_members_list"},f.map((function(e,t){return wp.element.createElement("div",{className:"vibe_projects_member"},e.member_type?wp.element.createElement("span",{className:"member_type"},e.member_type.name):wp.element.createElement("span",{className:"member_type"}),wp.element.createElement(I,{type:"member",id:{user_id:e.id}}),"remove_member"==P?wp.element.createElement("span",{onClick:function(){var e=V(f);e.splice(t,1),b(e),c(!0)},className:"vicon vicon-close"}):"",e.team?wp.element.createElement("div",{className:"member_teams"},wp.element.createElement("span",{className:"member_team",style:{background:e.team.color}},e.team.name)):"")}))):""),wp.element.createElement(ee,null,N-f.length>0?wp.element.createElement("span",{onClick:function(){O(!0),u(W(W({},p),{},{page:p.page+1}))}},N-f.length+window.vibeprojects.translations.more_members):""))),wp.element.createElement("div",{className:"project_member_actions"},wp.element.createElement(ee,null,P?wp.element.createElement("span",{onClick:function(){return C(!1)}},wp.element.createElement("span",{className:"vicon vicon-close"})," ",window.vibebp.translations.cancel):wp.element.createElement(ee,null,H("project_member_invite")?wp.element.createElement("a",{className:"tip",title:window.vibeprojects.translations.invite_members,onClick:function(){C("invite_members")}},wp.element.createElement("span",{className:"vicon vicon-user"})):"",H("add_project_member")?wp.element.createElement("a",{className:"tip",title:window.vibeprojects.translations.add_members,onClick:function(){C("add_member")}},wp.element.createElement("span",{className:"vicon vicon-plus"})):"",H("add_project_member")?wp.element.createElement("a",{className:"tip",title:window.vibeprojects.translations.remove_members,onClick:function(){C("remove_member")}},wp.element.createElement("span",{className:"vicon vicon-trash"})):"")),wp.element.createElement(ee,null,"add_member"==P?wp.element.createElement("div",{className:"add_new_members"},wp.element.createElement("div",null,wp.element.createElement("input",{type:"text",value:M,onChange:function(e){return U(e.target.value)},placeholder:window.vibeprojects.translations.enter_characters})),D.length?wp.element.createElement("div",{className:"show_search_results"},wp.element.createElement("ul",null,D.map((function(e,t){return wp.element.createElement("li",{onClick:function(){var n=V(f);n.push(e),b(n);var r=V(D);r.splice(t,1),R(r),c(!0)}},wp.element.createElement("img",{src:e.avatar}),e.label)})))):""):"invite_members"==P?wp.element.createElement("div",{className:"invite_new_members"},X.length?X.map((function(e,t){return wp.element.createElement("div",{className:"invite_new_member"},wp.element.createElement("input",{type:"text",value:e.name,onChange:function(e){var n=V(X);n[t].name=e.target.value,B(n)},placeholder:window.vibeprojects.translations.member_name}),wp.element.createElement("input",{type:"text",value:e.email,onChange:function(e){var n=V(X);n[t].name=e.target.value,B(n)},placeholder:window.vibeprojects.translations.member_email}),wp.element.createElement("select",{value:e.type,onChange:function(e){var n=V(X);n[t].type=e.target.value,B(n)}},wp.element.createElement("option",null,window.vibeprojects.translations.select_member_type),w.map((function(e){return wp.element.createElement("option",{value:e.slug},e.name)}))),wp.element.createElement("select",{value:e.team,onChange:function(e){var n=V(X);n[t].team=e.target.value,B(n)}}," >",wp.element.createElement("option",null,window.vibeprojects.translations.select_member_team),g.map((function(e){return wp.element.createElement("option",{value:e.slug},e.name)}))),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){var e=V(X);e.splice(t,1),B(e)}}))})):"",wp.element.createElement("div",{className:"invite_new_member"},wp.element.createElement("input",{type:"text",value:re.name,onChange:function(e){return le(W(W({},re),{},{name:e.target.value}))},placeholder:window.vibeprojects.translations.member_name}),wp.element.createElement("input",{type:"text",value:re.email,onChange:function(e){return le(W(W({},re),{},{email:e.target.value}))},placeholder:window.vibeprojects.translations.member_email}),wp.element.createElement("select",{value:re.type,onChange:function(e){return le(W(W({},re),{},{type:e.target.value}))},placeholder:window.vibeprojects.translations.select_member_type},wp.element.createElement("option",null,window.vibeprojects.translations.select_member_type),w.map((function(e){return wp.element.createElement("option",{value:e.slug},e.name)}))),wp.element.createElement("select",{value:re.team,onChange:function(e){return le(W(W({},re),{},{team:e.target.value}))},placeholder:window.vibeprojects.translations.select_member_team},wp.element.createElement("option",null,window.vibeprojects.translations.select_member_team),g.map((function(e){return wp.element.createElement("option",{value:e.slug},e.name)}))),wp.element.createElement("a",{className:"button is-primary",onClick:function(){var e=V(X);new RegExp("([!#-'*+/-9=?A-Z^-~-]+(.[!#-'*+/-9=?A-Z^-~-]+)*|\"([]!#-[^-~ \t]|(\\[\t -~]))+\")@([!#-'*+/-9=?A-Z^-~-]+(.[!#-'*+/-9=?A-Z^-~-]+)*|[[\t -Z^-~]*])").test(re.email)&&re.team.length&&re.type.length&&re.name.length?(e.push(re),B(e),le({name:"",email:"",type:"",team:""})):ie("vibebp").addNotification({text:window.vibeprojects.translations.invalid_email})}},window.vibeprojects.translations.add_member)),X.length?wp.element.createElement("div",{className:"invlite_members_action"},wp.element.createElement("a",{className:ce?"button is-primary is-loading":"button is-primary",onClick:function(){de(!0),fetch("".concat(oe,"/project/sendMemberInvites/?post"),{method:"post",body:JSON.stringify({project_id:e.project.id,members:X,token:ae("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){de(!1),e.status&&(B([]),le({name:"",email:"",type:""}),C(!1)),e.hasOwnProperty("message")&&ie("vibebp").addNotification({text:e.message})}))}},window.vibeprojects.translations.send_invites),wp.element.createElement("a",{className:"link",onClick:function(){return C(!1)}}," ",window.vibeprojects.translations.cancel)):""):""))))},se=wp.element,ce=(se.createElement,se.render,se.useState,se.useEffect,se.Fragment,se.useContext),de=(window.vibeprojects&&window.vibeprojects.apiUrl,function(e){ce(l);return wp.element.createElement("div",{className:"project_notes_wrapper"},"Notes")});var pe=wp.element,ue=(pe.createElement,pe.useState,pe.useEffect,pe.Fragment,pe.render,wp.data);ue.dispatch,ue.select;function me(e){return function(e){if(Array.isArray(e))return ye(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||he(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){ve(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ve(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function we(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||he(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function he(e,t){if(e){if("string"==typeof e)return ye(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ye(e,t):void 0}}function ye(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ge=wp.data,_e=ge.dispatch,Ee=ge.select,je=wp.element,Oe=(je.createElement,je.render,je.useState),ke=je.useEffect,Ne=je.Fragment,xe=je.useContext,Se=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",Pe=function(e){var t,n,r=xe(l),a=we(Oe(""),2),o=a[0],s=a[1],c=we(Oe([]),2),d=c[0],p=c[1],u=we(Oe(!0),2),m=(u[0],u[1],we(Oe(!1),2)),f=m[0],b=m[1],v=we(Oe(!1),2),w=(v[0],v[1],we(Oe({label:"",color:""}),2)),h=w[0],y=w[1],g=we(Oe(!1),2),_=g[0],E=g[1],j=we(Oe(!1),2),O=j[0],k=j[1],N=we(Oe(!1),2),x=N[0],S=N[1];ke((function(){r.hasOwnProperty("board")&&p(r.board.labels)}),[r.board]);return wp.element.createElement("div",{className:"card_popup"},wp.element.createElement("div",{className:"card_labels_popup_wrapper"},wp.element.createElement("div",{className:"card_popup_title"},f?wp.element.createElement("span",{onClick:function(){b(!1),y({label:"",color:""})},className:"vicon vicon-angle-left"}):"",wp.element.createElement("span",null,window.vibeprojects.translations.label_header),wp.element.createElement("span",{className:"vicon vicon-close",onClick:e.close})),d&&d.length>8?wp.element.createElement("div",{className:"card_popup_search_label_section",style:{display:f?"none":""}},wp.element.createElement("input",{type:"text",value:o,placeholder:window.vibeprojects.translations.search_labels,onChange:function(e){s(e.target.value)}}),wp.element.createElement("span",{className:"vicon vicon-search"})):"",wp.element.createElement("div",{className:"card_labels_list_header",style:{display:f?"none":""}},wp.element.createElement("div",{className:"labels_list"},d&&d.length?d.map((function(t,n){var a;if(!o.length||t.label.toLowerCase().includes(o.toLowerCase()))return wp.element.createElement("div",{className:(null===(a=e.card.labels)||void 0===a?void 0:a.indexOf(t.id))>-1?"label_item selected":"label_item",style:{background:t.color}},wp.element.createElement("span",{onClick:function(){!function(t){var n,a=be({},e.card),i=1;a.hasOwnProperty("labels")?i=-1==(null===(n=a.labels)||void 0===n?void 0:n.indexOf(t)):a.labels=[];if(i){a.labels.push(t);var o=me(r.board.cards);o[o.findIndex((function(e){return e.card_id==a.card_id}))]=a;var l={id:a.card_id,type:"add_label",value:t};r.update("multiple",{board:be(be({},r.board),{},{cards:o}),automate:l})}else{a.labels.splice(a.labels.indexOf(t),1);var s=me(r.board.cards);s[s.findIndex((function(e){return e.card_id==a.card_id}))]=a;var c={id:a.card_id,type:"remove_label",value:t};r.update("multiple",{board:be(be({},r.board),{},{cards:s}),automate:c})}fetch("".concat(Se,"/card/labels/").concat(e.card.card_id,"/action?post"),{method:"post",body:JSON.stringify({label:t,token:Ee("vibebp").getToken(),added:i})}).then((function(e){return e.json()})).then((function(e){e.status&&_e("vibebp").addNotification({text:e.message})}))}(t.id)}},t.label),wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){b(!0),y(t)}}))})):wp.element.createElement("div",{className:"vbp_message"},window.vibeprojects.translations.no_labels_found))),f?wp.element.createElement("div",{className:"create_label_form_wrapper"},wp.element.createElement("div",{className:"create_label_text"},wp.element.createElement("input",{type:"text",placeholder:window.vibeprojects.translations.label_color_name,value:h.label,onChange:function(e){y(be(be({},h),{},{label:e.target.value}))}})),wp.element.createElement("div",{className:"vibe_projects_label_color_pallete"},wp.element.createElement("label",null,window.vibeprojects.translations.select_color),wp.element.createElement("div",{className:"vibe_color_pallete_wrapper"},window.vibeprojects.settings.label_colors&&Object.keys(window.vibeprojects.settings.label_colors).length?Object.keys(window.vibeprojects.settings.label_colors).map((function(e){return wp.element.createElement("span",{style:{background:e},onClick:function(){y(be(be({},h),{},{color:e}))},title:window.vibeprojects.settings.label_colors[e]},h.color==e?wp.element.createElement("span",{className:"vicon vicon-check"}):"")})):"")),wp.element.createElement("div",{className:"vibe_create_label_button"},h&&null!==(t=h.id)&&void 0!==t&&t.length?wp.element.createElement(Ne,null,wp.element.createElement("a",{onClick:function(){S(!0),fetch("".concat(Se,"/card/").concat(e.card.card_id,"/edit_label?post"),{method:"post",body:JSON.stringify({label:h,board_id:null==r?void 0:r.board.id,token:Ee("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){if(S(!1),e.status){var t=me(r.board.labels);t[t.findIndex((function(e){return e.id==h.id}))]=h,r.update("board",be(be({},r.board),{},{labels:t}))}e.hasOwnProperty("message")&&_e("vibebp").addNotification({text:e.message})}))},className:x?"button is-primary is-loading":" button is-primary "},window.vibeprojects.translations.edit_label),wp.element.createElement("a",{onClick:function(){k(!0),fetch("".concat(Se,"/card/").concat(e.card.card_id,"/delete_label?post"),{method:"post",body:JSON.stringify(be(be({},h),{},{board_id:null==r?void 0:r.board.id,token:Ee("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){if(e.status&&h.hasOwnProperty("id")&&h.id.length){var t=me(r.board.labels);t.splice(t.findIndex((function(e){return e.id==h.id})),1),cards=me(r.board.cards);var n=[];cards.filter((function(e){return e.labels.indexOf(h.id)>-1})).map((function(e){cards[i]=e.labels.splice(e.labels.indexOf(h.id),1),n.push(e.card_id)})),fetch("".concat(Se,"/project/board/bulkAction?post"),{method:"post",body:JSON.stringify({bulkAction:"remove_label",selectedCards:n,token:Ee("vibebp").getToken(),added:added})}),r.update("board",be(be({},r.board),{},{labels:t,cards:cards})),y({label:"",color:""}),b(!1)}e.hasOwnProperty("message")&&_e("vibebp").addNotification({text:e.message}),k(!1)}))},className:O?" button is-primary ":"is-primary button"},window.vibeprojects.translations.delete_label," [",null===(n=r.board)||void 0===n?void 0:n.cards.filter((function(e){var t;return(null===(t=e.labels)||void 0===t?void 0:t.indexOf((function(e){return e.id==h.id})))>-1})).length,"]")):wp.element.createElement("a",{onClick:function(){var t;h.hasOwnProperty("color")&&h.color.length?h.hasOwnProperty("label")&&h.label.length?(E(!0),fetch("".concat(Se,"/card/").concat(e.card.card_id,"/create_label?post"),{method:"post",body:JSON.stringify(be(be({},h),{},{board_id:null===(t=r.path)||void 0===t?void 0:t.board,token:Ee("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){e.status&&(e.hasOwnProperty("labels")&&e.labels.length&&(r.update("board",be(be({},r.board),{},{labels:e.labels})),b(!1)),e.hasOwnProperty("message")&&_e("vibebp").addNotification({text:e.message})),E(!1)}))):_e("vibebp").addNotification({text:window.vibeprojects.translations.please_enter_label_name,icon:"vicon vicon-alert"}):_e("vibebp").addNotification({text:window.vibeprojects.translations.please_select_color,icon:"vicon vicon-alert"})},className:_?"create_label button is-loading":"create_label button"},window.vibeprojects.translations.label_button))):wp.element.createElement("div",{className:"create_new_label_actions"},wp.element.createElement("a",{onClick:function(){b(!0)},className:"create_label button"},window.vibeprojects.translations.create_new_label))))};function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(n),!0).forEach((function(t){Ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function De(e){return function(e){if(Array.isArray(e))return Me(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Te(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Re(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||Te(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Te(e,t){if(e){if("string"==typeof e)return Me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Me(e,t):void 0}}function Me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ue=wp.element,$e=(Ue.createElement,Ue.render,Ue.useState),Le=Ue.useEffect,Fe=(Ue.Fragment,Ue.useContext),Je=(Ue.useRef,wp.data),He=Je.dispatch,Ye=Je.select,Ve=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",qe=function(e){var t=Fe(l),n=Re($e(e.card.status),2),r=n[0],a=n[1],i=Re($e(!1),2),o=i[0],s=i[1];Le((function(){a(e.card.status)}),[e.card]);return wp.element.createElement("div",{className:"due_date_popup_wrapper card_popup"},wp.element.createElement("div",{className:"card_popup_title"},wp.element.createElement("span",null,window.vibeprojects.translations.change_status),wp.element.createElement("span",{className:"vicon vicon-close",onClick:e.close})),wp.element.createElement("div",{className:"change_status_select"},wp.element.createElement("select",{value:r,onChange:function(e){return a(e.target.value)}},window.vibeprojects.settings.statuses.card.map((function(e){return wp.element.createElement("option",{value:e.value},e.label)}))),wp.element.createElement("div",{className:"popup_action_buttons"},wp.element.createElement("a",{className:"select_due_date button ".concat(o?"is-loading":""),onClick:function(){var n,a;s(!0);var i=0;null!==(n=t.path)&&void 0!==n&&null!==(a=n.project)&&void 0!==a&&a.length&&(i=t.path.project),e.card.hasOwnProperty("project")&&(i=e.card.project.id),fetch("".concat(Ve,"/card/changeStatus?post"),{method:"post",body:JSON.stringify({status:r,card_id:e.card.card_id,project_id:i,token:Ye("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(n){if(s(!1),n.status){var a,i,o;if(t.hasOwnProperty("board")&&null!==(a=t.board)&&void 0!==a&&null!==(i=a.cards)&&void 0!==i&&i.length){var l=De(t.board.cards);l[l.findIndex((function(t){return t.card_id==e.card.card_id}))].status=r;var c={id:e.card.card_id,type:"change_status",value:r};t.update("multiple",{board:Ce(Ce({},t.board),{},{cards:l}),automate:c})}if(null!==(o=t.tasks)&&void 0!==o&&o.length&&t.tasks.findIndex((function(t){return t.card_id==e.card.card_id}))>-1){var d=De(t.tasks);d[d.findIndex((function(t){return t.card_id==e.card.card_id}))].status=r,t.update("tasks",d)}e.close()}n.hasOwnProperty("message")&&He("vibebp").addNotification({text:n.message})}))}},window.vibeprojects.translations.save),wp.element.createElement("a",{className:"link",onClick:e.close},window.vibeprojects.translations.cancel))))};function We(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?We(Object(n),!0).forEach((function(t){ze(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):We(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ze(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Be(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ze=wp.element,Qe=(Ze.createElement,Ze.render,Ze.useState),Ke=Ze.useEffect,et=(Ze.Fragment,Ze.useContext),tt=Ze.useRef,nt=wp.data,rt=(nt.dispatch,nt.select),at=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",it=function(e){et(l);console.log(e);var t=Xe(Qe(e.duedate),2),n=(t[0],t[1],Xe(Qe((function(){var t,n,r={startdate:Math.round((new Date).getTime()/1e3)-86400,duedate:Math.round((new Date).getTime()/1e3)};return null!==(t=e.duedate)&&void 0!==t&&null!==(n=t.badges)&&void 0!==n&&n.length&&(e.duedate.badges.findIndex((function(e){return"startdate"==e.key}))>-1&&(r.startdate=parseInt(e.duedate.badges[e.duedate.badges.findIndex((function(e){return"startdate"==e.key}))].value)),e.duedate.badges.findIndex((function(e){return"duedate"==e.key}))>-1&&(r.duedate=parseInt(e.duedate.badges[e.duedate.badges.findIndex((function(e){return"duedate"==e.key}))].value))),r})),2)),r=n[0],a=n[1],i=Xe(Qe(!1),2),o=i[0],s=i[1],c=tt(null),d=Xe(Qe(!1),2),p=d[0],u=d[1];Ke((function(){if(c&&c.current)if(o)o.set("onChange",m);else{var e={altInput:!0,mode:"range",dateFormat:"F-d",defaultDate:r.hasOwnProperty("startdate")&&r.startdate?[new Date(1e3*parseInt(r.startdate)),new Date(1e3*parseInt(r.duedate))]:[],onChange:m},t=flatpickr(c.current,e);s(t)}}));var m=function(e){e.length>1&&a(Ge(Ge({},r),{},{startdate:Math.round(e[0].getTime()/1e3),duedate:Math.round(e[1].getTime()/1e3)}))};return wp.element.createElement("div",{className:"due_date_popup_wrapper card_popup"},wp.element.createElement("div",{className:"card_popup_title"},wp.element.createElement("span",null,window.vibeprojects.translations.change_due_date),wp.element.createElement("span",{className:"vicon vicon-close",onClick:e.close})),wp.element.createElement("div",{className:"due_date_select_date"},wp.element.createElement("input",{type:"text",ref:c}),wp.element.createElement("a",{className:"select_due_date button ".concat(p?"is-loading":""),onClick:function(){u(!0),fetch("".concat(at,"/card/").concat(e.duedate.card_id,"/setduedate?post"),{method:"post",body:JSON.stringify(Ge(Ge({},r),{},{token:rt("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(t){if(u(!1),t.status){var n=Ge({},e.duedate);n.badges&&n.badges.length?n.badges.findIndex((function(e){return"duedate"==e.key}))>-1&&n.badges.splice(n.badges.findIndex((function(e){return"duedate"==e.key})),1):n.badges=[],parseInt(r.duedate)+1728e3>Math.round(new Date((new Date).getUTCFullYear()+"-"+((new Date).getUTCMonth()+1)+"-"+(new Date).getUTCDate()).getTime()/1e3)?n.badges.push({bg:"#3f86d8",color:"#fff",value:r.duedate,key:"duedate",type:window.vibeprojects.translations.due_in,icon:"vicon vicon-timer",label:window.vibeprojects.translations.upcoming}):r.duedata.timestamp>Math.round(new Date((new Date).getUTCFullYear()+"-"+((new Date).getUTCMonth()+1)+"-"+(new Date).getUTCDate()).getTime()/1e3)&&n.badges.push({bg:"#dc7676",color:"#fff",value:r.duedate,key:"duedate",type:window.vibeprojects.translations.due_by,icon:"vicon vicon-timer",label:window.vibeprojects.translations.overdue}),n.badges.findIndex((function(e){return"startdate"==e.key}))>-1&&n.badges.splice(n.badges.findIndex((function(e){return"startdate"==e.key})),1),r.startdate>Math.round(new Date((new Date).getUTCFullYear()+"-"+(new Date).getUTCMonth()+"-"+(new Date).getUTCDate()).getTime()/1e3)?n.badges.push({bg:"#3f86d8",color:"#fff",value:r.startdate,key:"startdate",type:window.vibeprojects.translations.start_date,icon:"vicon vicon-timer",label:window.vibeprojects.translations.upcoming}):n.badges.push({bg:"#3f86d8",color:"#fff",value:r.startdate,key:"startdate",type:window.vibeprojects.translations.start_date,icon:"vicon vicon-timer",label:window.vibeprojects.translations.on_going}),e.update(n),e.close()}}))}},window.vibeprojects.translations.select_due_date)))};function ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ot(Object(n),!0).forEach((function(t){st(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function st(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ct(e){return function(e){if(Array.isArray(e))return ut(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||pt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function dt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||pt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pt(e,t){if(e){if("string"==typeof e)return ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ut(e,t):void 0}}function ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var mt=wp.data,ft=(mt.dispatch,mt.select),bt=wp.element,vt=(bt.createElement,bt.render,bt.useState),wt=bt.useEffect,ht=bt.Fragment,yt=bt.useContext,gt=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",_t=function(e){var t=yt(l),n=dt(vt(-1),2),r=n[0],a=n[1],i=dt(vt(-1),2),o=i[0],s=i[1],c=dt(vt([]),2),d=c[0],p=c[1];wt((function(){var n,r;if(null!==(n=t.board)&&void 0!==n&&null!==(r=n.lists)&&void 0!==r&&r.length){var i=t.board.lists.findIndex((function(t){var n;return(null===(n=t.cards)||void 0===n?void 0:n.length)&&t.cards.indexOf(e.card.card_id)>-1}));i>-1&&a(i)}}),[e.card]),wt((function(){r>-1&&(u(),t.board.lists[r].hasOwnProperty("cards")&&t.board.lists[r].cards.length&&s(t.board.lists[r].cards.length))}),[r]);var u=function(){var n=[],a=-1;if(r>-1&&t.board.lists[r].hasOwnProperty("cards")&&t.board.lists[r].cards.length){a=t.board.lists[r].cards.findIndex((function(t){return t===e.card.card_id}));for(var i=0;i<=t.board.lists[r].cards.length;i++)i==t.board.lists[r].cards.length&&-1!=a||n.push(wp.element.createElement("option",{selected:o===i,value:i},i+1," ",i===a?"("+window.vibeprojects.translations.current+")":""))}n.length||n.push(wp.element.createElement("option",{selected:0===o,value:0},1," ",1===a?window.vibeprojects.translations.current:"")),p(n)};return e.card.hasOwnProperty("card_id")?wp.element.createElement("div",{className:"card_popup"},wp.element.createElement("div",{className:"card_popup_title"},wp.element.createElement("span",null,window.vibeprojects.translations.move_card),wp.element.createElement("span",{className:"vicon vicon-close",onClick:e.close})),t.board.hasOwnProperty("lists")&&t.board.lists.length?wp.element.createElement(ht,null,wp.element.createElement("div",{className:"vibe_select_label_move"},wp.element.createElement("label",{for:"list-move"},wp.element.createElement("span",null,window.vibeprojects.translations.list),wp.element.createElement("select",{id:"list-move",value:r,onChange:function(e){a(e.target.value)}},t.board.lists.map((function(e,t){return wp.element.createElement("option",{value:t},e.name)})))),wp.element.createElement("label",{for:"card-index-move"},wp.element.createElement("span",null,window.vibeprojects.translations.position),wp.element.createElement("select",{id:"card-index-move",value:o,onChange:function(e){s(e.target.value)}},d))),wp.element.createElement("a",{className:"button is-primary",onClick:function(){var n,a,i=ct(t.board.lists),l=-1,s=-1;null!==(n=e.card)&&void 0!==n&&null!==(a=n.list)&&void 0!==a&&a.term_id&&(l=t.board.lists.findIndex((function(t){var n,r;return(null===(n=e.card)||void 0===n||null===(r=n.list)||void 0===r?void 0:r.term_id)==t.term_id})),s=t.board.lists[l].cards.findIndex((function(t){return t==e.card.card_id})));var c,d=o-1;s>-1?(i[l].cards.splice(s,1),i[l].is_changed=!0,e.card.list={term_id:i[r].term_id,name:i[r].name},null!==(c=i[r].cards)&&void 0!==c&&c.length||(i[r].cards=[]),i[r].cards.splice(d,0,e.card.card_id),i[r].is_changed=!0):(e.card.list={term_id:i[r].term_id,name:i[r].name},i[r].cards.splice(d,0,parseInt(e.card.card_id)),i[r].is_changed=!0);fetch("".concat(gt,"/card/").concat(e.card.card_id,"/movecard?post"),{method:"post",body:JSON.stringify({list_id:i[r].term_id,order:i[r].cards,token:ft("vibebp").getToken()})}),t.update("board",lt(lt({},t.board),{},{lists:i})),e.close()}},window.vibeprojects.translations.move)):""):""};function Et(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function jt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(n),!0).forEach((function(t){Ot(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Et(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ot(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kt(e){return function(e){if(Array.isArray(e))return St(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||xt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||xt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xt(e,t){if(e){if("string"==typeof e)return St(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?St(e,t):void 0}}function St(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Pt=wp.element,It=(Pt.createElement,Pt.render,Pt.useState),Ct=Pt.useEffect,At=(Pt.Fragment,Pt.useContext),Dt=Pt.useRef,Rt=wp.data,Tt=(Rt.dispatch,Rt.select),Mt=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",Ut=function(e){var t,n,r=At(l),a=Dt(null),i=Nt(It(!0),2),o=(i[0],i[1],Nt(It(!1),2)),s=o[0],c=o[1],d=Nt(It(e.card),2),p=d[0],u=d[1],m=Nt(It([]),2),f=(m[0],m[1],Nt(It({}),2)),b=(f[0],f[1],Nt(It(!1),2)),v=b[0],w=b[1];return Ct((function(){var t=function(t){a.current.contains(t.target)||(e.close(),c(!1))};return a&&document.addEventListener("mousedown",t),function(){document.removeEventListener("mousedown",t)}}),[]),wp.element.createElement("div",{className:"short_card_popup_wrapper",ref:a},wp.element.createElement("span",{onClick:function(){return e.close()}}),wp.element.createElement("div",{className:"short_card_quick_editor"},"title"==s?wp.element.createElement("div",{className:"card_popup"},wp.element.createElement("div",{class:"card_popup_title"},wp.element.createElement("span",null,window.vibeprojects.translations.edit_list_title),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){return c(!1)}})),wp.element.createElement("input",{type:"text",value:p.title,onChange:function(e){return u(jt(jt({},p),{},{title:e.target.value}))}}),wp.element.createElement("div",{className:"popup_action_buttons"},wp.element.createElement("a",{className:v?"button is-loading":"button",onClick:function(){w(!0),fetch("".concat(Mt,"/card/changeTitle?post"),{method:"post",body:JSON.stringify({title:p.title,card_id:p.card_id,project_id:r.path.project,token:Tt("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){if(w(!1),t.status){c(!1);var n=kt(r.board.cards);n[n.findIndex((function(t){return t.card_id==e.card.card_id}))].title=p.title,r.update("board",jt(jt({},r.board),{},{cards:n}))}}))}},window.vibeprojects.translations.save),wp.element.createElement("a",{className:"link",onClick:function(){return c(!1)}},window.vibeprojects.translations.cancel))):"labels"==s?wp.element.createElement(Pe,{card:e.card,update:e.updateCard,close:function(){c(!1)}}):"status"==s?wp.element.createElement(qe,{card:e.card,update:e.updateCard,close:function(){c(!1)}}):"date"==s?wp.element.createElement(it,{duedate:e.card,update:e.updateCard,close:function(){c(!1)}}):"move"==s?wp.element.createElement(_t,{card:e.card,close:function(){c(!1)}}):wp.element.createElement("div",{className:"short_card_buttons"},wp.element.createElement("a",{className:"edit_labels"},wp.element.createElement("span",{className:"vicon vicon-pencil"}),wp.element.createElement("span",{className:"card_editor_label_text",onClick:function(){return c("title")}},window.vibeprojects.translations.edit_list_title)),H("add_card_label")?wp.element.createElement("a",{className:"edit_labels"},wp.element.createElement("span",{className:"vicon vicon-tag"}),wp.element.createElement("span",{className:"card_editor_label_text",onClick:function(){return c("labels")}},window.vibeprojects.translations.edit_labels)):"",wp.element.createElement("a",{className:"archive_card"},wp.element.createElement("span",{className:"vicon vicon-archive"}),wp.element.createElement("span",{className:"card_editor_label_text",onClick:function(){return c("status")}},window.vibeprojects.translations.change_status)),null!==(t=r.board)&&void 0!==t&&null!==(n=t.lists)&&void 0!==n&&n.length?wp.element.createElement("a",{className:"archive_card"},wp.element.createElement("span",{className:"vicon vicon-move"}),wp.element.createElement("span",{className:"card_editor_label_text",onClick:function(){return c("move")}},window.vibeprojects.translations.move_card)):"",wp.element.createElement("a",{className:"card_due_date"},wp.element.createElement("span",{className:"vicon vicon-timer"}),wp.element.createElement("span",{className:"card_editor_label_text",onClick:function(){return c("date")}},window.vibeprojects.translations.change_due_date)))))};function $t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Lt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$t(Object(n),!0).forEach((function(t){Ft(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ft(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jt(e){return function(e){if(Array.isArray(e))return qt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Vt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ht(e){return(Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||Vt(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vt(e,t){if(e){if("string"==typeof e)return qt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?qt(e,t):void 0}}function qt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Wt=wp.element,Gt=(Wt.createElement,Wt.render,Wt.useState),zt=Wt.useEffect,Xt=Wt.Fragment,Bt=Wt.useContext,Zt=Wt.useRef,Qt=wp.data,Kt=(Qt.dispatch,Qt.select),en=(window.vibeprojects&&window.vibeprojects.apiUrl,function(e){var t,n,r,a,i,o,s,d,p,u,m=Bt(l),f=Zt(null),b=Yt(Gt({}),2),v=(b[0],b[1],Yt(Gt(e.card),2)),w=v[0],h=v[1],y=Yt(Gt([]),2),g=y[0],_=y[1],E=Yt(Gt(!1),2),j=E[0],O=E[1],k=Yt(Gt(!1),2),N=k[0],x=k[1],S=Yt(Gt(!1),2),P=S[0],A=S[1];zt((function(){"object"==Ht(e.card)&&h(e.card)}),[e.card]),zt((function(){var t,n;(null===(t=m.board)||void 0===t||null===(n=t.cards)||void 0===n?void 0:n.findIndex((function(t){return t.card_id==e.card})))>-1&&h(m.board.cards[m.board.cards.findIndex((function(t){return t.card_id==e.card}))])}),[m.board]),zt((function(){m.hasOwnProperty("bulkAction")&&m.bulkAction?(console.log(m.bulkAction,"<<<<"),x(!0)):x(!1)}),[m.bulkAction]),zt((function(){var e,t;if(P)if(null!==(e=m.selectedCards)&&void 0!==e&&e.length&&-1==m.selectedCards.indexOf(w.card_id)){var n=Jt(m.selectedCards);n.push(w.card_id),m.update("selectedCards",n)}else m.update("selectedCards",[w.card_id]);else if(null!==(t=m.selectedCards)&&void 0!==t&&t.length&&m.selectedCards.findIndex((function(e){return w.card_id}))>-1){var r=Jt(m.selectedCards);r.splice(m.selectedCards.findIndex((function(e){return w.card_id})),1),m.update("selectedCards",r)}else m.update("selectedCards",[])}),[P]),zt((function(){f&&e.hasOwnProperty("inCal")}),[f,w]),zt((function(){m.hasOwnProperty("board")&&m.board.hasOwnProperty("labels")&&_(m.board.labels)}),[null==m?void 0:m.board]);zt((function(){var t,n;if(e.card&&m.hasOwnProperty("boardFilters")&&null!==(t=m.board)&&void 0!==t&&null!==(n=t.cards)&&void 0!==n&&n.length){m.boardFilters;var r=Lt({},m.board.cards[m.board.cards.findIndex((function(t){return t.card_id==e.card}))]);r=D(r),Object.keys(r).length?h(m.board.cards[m.board.cards.findIndex((function(t){return t.card_id==e.card}))]):h({})}}),[null===(t=m.board)||void 0===t?void 0:t.cards,m.boardFilters,e.card]);var D=function(e){var t=m.boardFilters;if(t){var n,r,a=1;if(Object.keys(e).length&&t.searchText.length&&w.hasOwnProperty("title")&&-1==w.title.indexOf(t.searchText)&&(e={}),Object.keys(e).length&&t.dates.length>1&&(w.hasOwnProperty("badges")&&w.badges.findIndex((function(e){return"duedate"==e.key}))>-1&&1e3*parseInt(w.badges[w.badges.findIndex((function(e){return"duedate"==e.key}))].value)>t.dates[0].getTime()&&1e3*parseInt(w.badges[w.badges.findIndex((function(e){return"duedate"==e.key}))].value)<t.dates[1].getTime()||(e={})),Object.keys(e).length&&t.selectedMembers.length)a=1,null!==(n=w.members)&&void 0!==n&&n.length&&t.selectedMembers.map((function(e){w.members.indexOf(e)>-1&&(a=0)})),a&&(e={});if(Object.keys(e).length&&t.selectedLabels.length)a=1,null!==(r=w.labels)&&void 0!==r&&r.length&&t.selectedLabels.map((function(e){w.labels.indexOf(e.id)>-1&&(a=0)})),a&&(e={});Object.keys(e).length&&t.selectedStatus.length&&-1==t.selectedStatus.findIndex((function(e){return e.value==w.status}))&&(e={}),Object.keys(e).length&&t.hasOwnProperty("showCompleted")&&(t.showCompleted||w.hasOwnProperty("icons")&&w.icons.findIndex((function(e){return"complete"==e.key}))>-1&&(e={}))}return e},R=D(Lt({},w)),T=(w.hasOwnProperty("meta")&&w.meta.findIndex((function(e){return"duedate"==e.key})),"card_wrapper ");j&&(T+="active "),w.hasOwnProperty("milestone")&&w.milestone&&(T+="milestone "),w.hasOwnProperty("completed")&&w.completed&&(T+="completed "),w.hasOwnProperty("archived")&&w.archived&&(T+="archived ");return w.hasOwnProperty("status")&&window.vibeprojects.settings.statuses.card.findIndex((function(e){return e.value==w.status})),"object"===Ht(R)&&Object.keys(R).length?wp.element.createElement("div",{id:"card_"+w.card_id,className:T,draggable:!j,onDragEnd:function(){m.update("board",Lt(Lt({},m.board),{},{cardDragging:!1}))},onDragStart:function(e){return m.board.cardDragging||m.update("board",Lt(Lt({},m.board),{},{cardDragging:Lt(Lt({},w),{},{user:Kt("vibebp").getUser()})})),!1},onDragOver:function(e){e.preventDefault(),function(e){if(!m.board.cardDragging||!H("move_card"))return!1;var t=w;if(m.board.cardDragging.card_id==t.card_id)return!1;var n=Lt({},m.board),r=n.lists.findIndex((function(e){return n.lists[n.lists.findIndex((function(e){var t;return(null===(t=e.cards)||void 0===t?void 0:t.indexOf(n.cardDragging.card_id))>-1}))].term_id==e.term_id})),a=n.lists.findIndex((function(e){return n.lists[n.lists.findIndex((function(e){var t;return(null===(t=e.cards)||void 0===t?void 0:t.indexOf(w.card_id))>-1}))].term_id==e.term_id}));if(r>-1){if(r===a){var i=m.board.lists[r].cards.findIndex((function(e){return e==t.card_id}));n.lists[r].cards=n.lists[r].cards.filter((function(e){return e!=n.cardDragging.card_id})),n.lists[r].is_changed=!0,n.lists[r].cards=n.lists[r].cards.filter((function(e,t,n){return n.indexOf(e)===t})),n.lists[r].cards.splice(i,0,n.cardDragging.card_id)}else{n.lists[r].cards.findIndex((function(e){return e===n.cardDragging.card_id}));var o,l=null===(o=n.lists[a].cards)||void 0===o?void 0:o.findIndex((function(e){return e===w.card_id}));l>-1&&(n.cardDragging.is_list_changed=!0,n.lists[r].is_changed=!0,n.cardDragging.list.term_id=n.lists[a].term_id,n.cardDragging.list.name=n.lists[a].name,n.lists[r].cards=n.lists[r].cards.filter((function(e){return e!=n.cardDragging.card_id})),n.lists[a].cards.splice(l,0,n.cardDragging.card_id),n.lists[a].is_changed=!0)}n.lists.map((function(e){var t;null===(t=e.cards)||void 0===t||t.map((function(t){n.cards=n.cards.map((function(t){return Lt(Lt({},t),{},{list:{name:e.name,term_id:e.term_id}})}))}))})),m.update("board",n)}else if(-1==r){var s,c=null===(s=n.lists[a].cards)||void 0===s?void 0:s.findIndex((function(e){return e===w.card_id}));n.cardDragging.list={term_id:n.lists[a].term_id,name:n.lists[a].name},c>-1&&(n.cardDragging.is_list_changed=!0,n.lists[a].cards.splice(c,0,n.cardDragging.card_id),n.lists[a].is_changed=!0),m.update("board",n)}}()},ref:f,"data-user":null!==(n=m.board)&&void 0!==n&&null!==(r=n.cardDragging)&&void 0!==r&&r.card_id&&(null===(a=m.board)||void 0===a||null===(i=a.cardDragging)||void 0===i?void 0:i.card_id)==w.card_id&&(null===(o=m.board)||void 0===o||null===(s=o.cardDragging)||void 0===s||null===(d=s.user)||void 0===d?void 0:d.id)!=Kt("vibebp").getUser().id?m.board.cardDragging.user.displayname:""},wp.element.createElement("div",{className:"card_view_wrapper"},function(){if(w.hasOwnProperty("labels")&&w.labels.length&&g&&g.length)return wp.element.createElement("div",{className:"card_labels_overview"},w.labels.length?wp.element.createElement("div",{className:"existing_card_labels"},w.labels.map((function(e){var t=g.findIndex((function(t){return t.id===e}));if(t>-1)return wp.element.createElement("span",{style:{background:g[t].color},title:g[t].label,className:"tip"})}))):"",wp.element.createElement(Xt,null,H("move_card")?wp.element.createElement("span",{className:j?"vicon vicon-close":"vicon vicon-more rotate90",onClick:function(){O(!j)}}):""))}(),wp.element.createElement("div",{className:"card_short_name"},null!==(p=m.bulkAction)&&void 0!==p&&p.length&&N?wp.element.createElement("span",null,wp.element.createElement("span",{className:P?"vicon vicon-check-box":"vicon vicon-layout-width-full",onClick:function(){return A(!P)}}),wp.element.createElement("span",{onClick:function(){return m.update("path",Lt(Lt({},m.path),{},{card:w.card_id}))},dangerouslySetInnerHTML:{__html:w.title}})):wp.element.createElement("span",{onClick:function(){return m.update("path",Lt(Lt({},m.path),{},{card:w.card_id}))},dangerouslySetInnerHTML:{__html:w.title}}),w.hasOwnProperty("labels")&&w.labels.length&&g&&g.length||!H("move_card")?"":wp.element.createElement("span",{className:j?"vicon vicon-close":"vicon vicon-more rotate90",onClick:function(){O(!j)}}),j?wp.element.createElement(Ut,{card:w,close:function(){return O(!1)},updateCard:function(e){return h(e)}}):""),wp.element.createElement("div",{className:"card_details"},w.hasOwnProperty("icons")&&w.icons.length?wp.element.createElement("div",{className:"card_icons"},w.icons.map((function(e){return wp.element.createElement("span",{title:e.label,className:"tip"},wp.element.createElement("span",{className:e.icon}))}))):"",w.hasOwnProperty("badges")&&w.badges.length?wp.element.createElement("div",{className:"card_badges"},w.badges.map((function(e){return wp.element.createElement("span",{style:{background:e.bg,color:e.color},className:"tip",title:e.label},wp.element.createElement("span",{className:e.icon}))}))):"",wp.element.createElement("span",{className:"tip",title:window.vibeprojects.translations.progress+" "+w.progress+"%"},wp.element.createElement(c,{progress:w.progress,size:"xs"})),wp.element.createElement("div",{className:"card_members"},null!==(u=w.members)&&void 0!==u&&u.length?wp.element.createElement(C,{user_id:w.members},w.members.map((function(e){return wp.element.createElement(I,{type:"user",id:{user_id:e}})}))):"")))):""});function tn(e){return function(e){if(Array.isArray(e))return sn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ln(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nn(Object(n),!0).forEach((function(t){an(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function an(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function on(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||ln(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ln(e,t){if(e){if("string"==typeof e)return sn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sn(e,t):void 0}}function sn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var cn=wp.element,dn=(cn.createElement,cn.render,cn.useState),pn=cn.useEffect,un=cn.Fragment,mn=cn.useContext,fn=(cn.useMemo,cn.useRef),bn=(window.vibeprojects&&window.vibeprojects.apiUrl,function(e){fn(null);var t,n,r,a=mn(l),i=on(dn(null),2),o=i[0],s=i[1],c=on(dn([]),2),d=c[0],p=c[1],u=on(dn(!1),2),m=(u[0],u[1],on(dn(!1),2)),f=m[0],b=m[1],v=on(dn(!1),2),w=v[0],h=v[1];pn((function(){var t,n,r;null!==(t=a.path)&&void 0!==t&&t.project&&(null===(n=a.board)||void 0===n||null===(r=n.cards)||void 0===r?void 0:r.findIndex((function(t){return t.card_id==e.card})))>-1&&s(a.board.cards[a.board.cards.findIndex((function(t){return t.card_id==e.card}))])}),[null===(t=a.board)||void 0===t?void 0:t.cards]),pn((function(){var t;null!==(t=a.tasks)&&void 0!==t&&t.length&&s(a.tasks[a.tasks.findIndex((function(t){return t.card_id==e.card}))])}),[a.tasks]),pn((function(){e.task&&e.task.card_id==e.card&&s(e.task)}),[e.task]),pn((function(){a.hasOwnProperty("bulkAction")&&a.bulkAction.length?b(!0):b(!1)}),[a.bulkAction]),pn((function(){var t;if(e.card&&null!==(t=a.path)&&void 0!==t&&t.board&&a.hasOwnProperty("boardFilters")&&a.hasOwnProperty("board")){var n,r,i,l=a.boardFilters,c=1,d=rn({},a.board.cards[a.board.cards.findIndex((function(t){return t.card_id==e.card}))]);if(Object.keys(d).length&&l.searchText.length&&o.hasOwnProperty("title")&&-1==o.title.indexOf(l.searchText)&&(d={}),Object.keys(d).length&&l.dates.length&&null!==(n=o.badges)&&void 0!==n&&n.length)o.hasOwnProperty("badges")&&(null===(r=o.badges)||void 0===r?void 0:r.findIndex((function(e){return"duedate"==e.key})))>-1&&1e3*parseInt(o.badges[o.badges.findIndex((function(e){return"duedate"==e.key}))].value)>l.dates[0].getTime()&&1e3*parseInt(o.badges[o.badges.findIndex((function(e){return"duedate"==e.key}))].value)<l.dates[1].getTime()||(d={});if(Object.keys(d).length&&l.selectedMembers.length&&(c=1,o.members.length&&l.selectedMembers.map((function(e){o.members.indexOf(e)>-1&&(c=0)})),c&&(d={})),Object.keys(d).length&&l.selectedLabels.length)c=1,null!==(i=o.labels)&&void 0!==i&&i.length&&l.selectedLabels.map((function(e){o.labels.indexOf(e.id)>-1&&(c=0)})),c&&(d={});Object.keys(d).length&&l.selectedStatus.length&&-1==l.selectedStatus.findIndex((function(e){return e.value==o.status}))&&(d={}),Object.keys(d).length&&l.hasOwnProperty("showCompleted")&&(l.showCompleted||o.hasOwnProperty("icons")&&o.icons.findIndex((function(e){return"complete"==e.key}))>-1&&(d={})),Object.keys(d).length?s(a.board.cards[a.board.cards.findIndex((function(t){return t.card_id==e.card}))]):s({})}}),[null==a?void 0:a.boardFilters]),pn((function(){var e,t;null!==(e=a.board)&&void 0!==e&&null!==(t=e.labels)&&void 0!==t&&t.length&&p(a.board.labels)}),[null===(n=a.board)||void 0===n?void 0:n.labels]),pn((function(){var e,t;if(w)if(null!==(e=a.selectedCards)&&void 0!==e&&e.length&&-1==a.selectedCards.indexOf(o.card_id)){var n=tn(a.selectedCards);n.push(o.card_id),a.update("selectedCards",n)}else a.update("selectedCards",[o.card_id]);else if(null!==(t=a.selectedCards)&&void 0!==t&&t.length&&a.selectedCards.findIndex((function(e){return o.card_id}))>-1){var r=tn(a.selectedCards);r.splice(a.selectedCards.findIndex((function(e){return o.card_id})),1),a.update("selectedCards",r)}else a.update("selectedCards",[])}),[w]);var y=0;o&&(y=window.vibeprojects.settings.statuses.card.findIndex((function(e){return e.value==o.status})));var g=Math.round(new Date((new Date).getUTCFullYear()+"-"+((new Date).getUTCMonth()+1)+"-"+(new Date).getUTCDate()).getTime()/1e3),_=Math.round(new Date((new Date).getUTCFullYear()+"-"+((new Date).getUTCMonth()+1)+"-"+((new Date).getUTCDate()+2)).getTime()/1e3),E=Math.round(new Date((new Date).getUTCFullYear()+"-"+((new Date).getUTCMonth()+2)+"-1").getTime()/1e3);return o?wp.element.createElement("div",{className:"list_item_wrapper"},wp.element.createElement("div",{className:"list_item"},null===(r=e.fields)||void 0===r?void 0:r.map((function(e){var t,n,r,i,l,s,c,p,u,m,b,v=-1;return e.key&&e.hasOwnProperty("from")&&"meta"==e.from&&(v=window.vibeprojects.settings.additional_fields.create_card_fields.findIndex((function(t){return t.key==e.key}))),wp.element.createElement("div",{className:"card_field field_"+e.key},"title"==e.key?wp.element.createElement(un,null,null!==(t=a.bulkAction)&&void 0!==t&&t.length&&f?wp.element.createElement("span",null,wp.element.createElement("span",{className:w?"vicon vicon-check-box":"vicon vicon-layout-width-full",onClick:function(){return h(!w)}}),wp.element.createElement("strong",{onClick:function(){return a.update("path",rn(rn({},a.path),{},{card:o.card_id}))},dangerouslySetInnerHTML:{__html:o.title}})):wp.element.createElement("strong",{onClick:function(){return a.update("path",rn(rn({},a.path),{},{card:o.card_id}))},dangerouslySetInnerHTML:{__html:o.title}})):"status"==e.key?wp.element.createElement("span",{className:"card_status",style:{background:null===(n=window.vibeprojects.settings.statuses.card[y])||void 0===n?void 0:n.color}},null===(r=window.vibeprojects.settings.statuses.card[y])||void 0===r?void 0:r.label):"project"==e.key?wp.element.createElement("span",{className:"card_project"},null===(i=o.project)||void 0===i?void 0:i.title):"progress"==e.key?wp.element.createElement("div",{className:"card_progress progress_wrap"},wp.element.createElement("span",{className:"progress_wrapper"},wp.element.createElement("span",{className:"increment",style:{width:o.progress+"%"}})),wp.element.createElement("span",{className:"progress_label"},o.progress+"%")):"labels"==e.key?function(){if(o.hasOwnProperty("labels")&&o.labels.length&&d&&d.length)return wp.element.createElement("div",{className:"card_labels_overview"},o.labels.length?wp.element.createElement("div",{className:"existing_card_labels"},o.labels.map((function(e){var t=d.findIndex((function(t){return t.id===e}));if(t>-1)return wp.element.createElement("span",{style:{background:d[t].color},className:"card_item_label"},d[t].label)}))):"")}():"milestone"==e.key?wp.element.createElement("span",{className:"card_status",style:(null===(l=o.icons)||void 0===l?void 0:l.findIndex((function(e){return"milestone"==e.key})))>-1?{background:"var(--primary)"}:{}},(null===(s=o.icons)||void 0===s?void 0:s.findIndex((function(e){return"milestone"==e.key})))>-1?window.vibeprojects.translations.milestone:""):"list"==e.key?wp.element.createElement("span",{className:"card_list"},a.board.lists.findIndex((function(e){return e.cards.indexOf(o.card_id)>-1}))>-1?a.board.lists[a.board.lists.findIndex((function(e){return e.cards.indexOf(o.card_id)>-1}))].name:o.list?o.list.name:""):"date"==e.key?wp.element.createElement("span",{className:"card_dates"},(null===(c=o.badges)||void 0===c?void 0:c.findIndex((function(e){return"duedate"==e.key})))>-1&&o.badges[o.badges.findIndex((function(e){return"duedate"==e.key}))].value<=g?wp.element.createElement("span",{style:{color:"#f67f7f"}},window.vibeprojects.translations.due_today):(null===(p=o.badges)||void 0===p?void 0:p.findIndex((function(e){return"duedate"==e.key})))>-1&&o.badges[o.badges.findIndex((function(e){return"duedate"==e.key}))].value>g&&o.badges[o.badges.findIndex((function(e){return"duedate"==e.key}))].value<=_?wp.element.createElement("span",{style:{color:"#b89c41"}},window.vibeprojects.translations.due_tomorrow):(null===(u=o.badges)||void 0===u?void 0:u.findIndex((function(e){return"duedate"==e.key})))>-1&&o.badges[o.badges.findIndex((function(e){return"duedate"==e.key}))].value>_&&o.badges[o.badges.findIndex((function(e){return"duedate"==e.key}))].value<=E?wp.element.createElement("span",{style:{color:"#28b835"}},window.vibeprojects.translations.due_this_month):(null===(m=o.badges)||void 0===m?void 0:m.findIndex((function(e){return"duedate"==e.key})))>-1?wp.element.createElement("span",{style:{color:"#4199b8"}},o.badges[o.badges.findIndex((function(e){return"duedate"==e.key}))].date):wp.element.createElement("span",{style:{color:"#909090"}},window.vibeprojects.translations.due_later)):e.key&&"meta"==e.from?wp.element.createElement("span",{className:"card_meta "+e.key},v>-1?"select"==window.vibeprojects.settings.additional_fields.create_card_fields[v].type?window.vibeprojects.settings.additional_fields.create_card_fields[v].options.findIndex((function(t){var n;return t.value==(null===(n=o.meta[o.meta.findIndex((function(t){return t.meta_key==e.key}))])||void 0===n?void 0:n.meta_value)}))>-1?window.vibeprojects.settings.additional_fields.create_card_fields[v].options[window.vibeprojects.settings.additional_fields.create_card_fields[v].options.findIndex((function(t){return t.value==o.meta[o.meta.findIndex((function(t){return t.meta_key==e.key}))].meta_value}))].label:"":null===(b=o.meta[o.meta.findIndex((function(t){return t.meta_key==e.key}))])||void 0===b?void 0:b.meta_value:""):"members"==e.key?wp.element.createElement("div",{className:"card_members"},o.members.map((function(e){return wp.element.createElement(I,{type:"user",id:{user_id:e}})}))):"")})))):""});function vn(e){return function(e){if(Array.isArray(e))return En(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wn(Object(n),!0).forEach((function(t){yn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function yn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||_n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _n(e,t){if(e){if("string"==typeof e)return En(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?En(e,t):void 0}}function En(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var jn=wp.data,On=jn.dispatch,kn=jn.select,Nn=wp.element,xn=(Nn.createElement,Nn.render,Nn.useState),Sn=Nn.useEffect,Pn=(Nn.Fragment,Nn.useContext),In=Nn.useRef,Cn=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",An=function(e){var t,n,r=Pn(l),a=In(null),i=gn(xn(0),2),o=i[0],s=i[1],c=gn(xn({}),2),d=c[0],p=c[1],u=gn(xn(!1),2),m=(u[0],u[1],gn(xn({}),2)),f=(m[0],m[1],gn(xn({}),2)),b=f[0],v=(f[1],gn(xn({}),2)),w=(v[0],v[1],gn(xn(!1),2)),h=w[0],y=w[1],g=gn(xn(!1),2),_=g[0],E=g[1],j=gn(xn({title:"",token:kn("vibebp").getToken()}),2),O=j[0],k=j[1],N=gn(xn([]),2),x=(N[0],N[1],gn(xn(!1),2)),S=x[0],P=x[1],I=gn(xn(!1),2),C=I[0],A=I[1],D=gn(xn(!1),2),R=(D[0],D[1],gn(xn(!1),2)),T=R[0],M=R[1],U=gn(xn(!1),2),$=U[0],L=U[1];Sn((function(){p(e.list),s(o+1)}),[e.list]),Sn((function(){e.list&&e.list.hasOwnProperty("term_id")&&k(hn(hn({},O),{},{list_id:e.list.term_id}))}),[e.list]);return d&&d.hasOwnProperty("term_id")?wp.element.createElement("div",{className:r.board&&d.hasOwnProperty("term_id")&&r.board.draggedList===d.term_id?"list_wrapper list_on_move":"list_wrapper",style:b},wp.element.createElement("div",{className:d.hasOwnProperty("term_id")&&r.board.draggedList===d.term_id?"list list_dragged":"list",style:d.hasOwnProperty("style")?d.style:{},ref:a},wp.element.createElement("div",{className:"list_header"},C?wp.element.createElement("div",{className:"list_title_edit_wrapper"},wp.element.createElement("input",{type:"text",value:d.name,onChange:function(e){p(hn(hn({},d),{},{name:e.target.value}))},onBlur:function(t){if(t.target.value.length){var n=vn(r.board.lists),a=n.findIndex((function(e){return e.term_id==d.term_id}));a>-1&&(n[a].name=t.target.value,r.update("board",hn(hn({},r.board),{},{lists:n}))),fetch("".concat(Cn,"/list/").concat(e.list.term_id,"/editlisttitle/?post"),{method:"post",body:JSON.stringify({name:d.name,token:kn("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&On("vibebp").addNotification({text:e.message})})),A(!1)}}})):wp.element.createElement("strong",null,d.name),H("create_board_list")?wp.element.createElement("span",{title:window.vibeprojects.translations.delete_card_list,className:S?"vicon vicon-close":"vicon vicon-more rotate90",onClick:function(e){P(!S),A(!1)}}):"",S?wp.element.createElement("div",{className:"list_context_menu"},wp.element.createElement("div",null,wp.element.createElement("span",{className:"card_editor_label_text",onClick:function(){A(!C),P(!S)}},window.vibeprojects.translations.edit_list_title)," ",wp.element.createElement("span",{className:"vicon vicon-pencil"})),wp.element.createElement("div",null,wp.element.createElement("span",{className:"card_editor_label_text",onClick:function(){var e=hn({},r.board);e.lists.splice(e.lists.findIndex((function(e){return e.term_id==d.term_id})),1),r.update("board",e),fetch("".concat(Cn,"/list/deletelist/?post"),{method:"post",body:JSON.stringify({list_id:d.term_id,token:kn("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&On("vibebp").addNotification({text:e.message})}))}},window.vibeprojects.translations.delete_list)," ",wp.element.createElement("span",{className:"vicon vicon-trash"})),wp.element.createElement("div",null,wp.element.createElement("span",{className:"card_editor_label_text",onClick:function(){return M(!T)}},window.vibeprojects.translations.move_list_cards)," ",wp.element.createElement("span",{className:"vicon vicon-share"}))):"",T?wp.element.createElement("div",{className:"list_context_menu"},wp.element.createElement("label",null,window.vibeprojects.translations.select_list_to_move_cards),wp.element.createElement("select",{onChange:function(e){L(e.target.value)}},wp.element.createElement("option",{value:""},window.vibeprojects.translations.select_list),null!==(t=r.board)&&void 0!==t&&null!==(n=t.lists)&&void 0!==n&&n.length?r.board.lists.map((function(e){return wp.element.createElement("option",{value:e.term_id},e.name)})):""),wp.element.createElement("div",{className:"card_actions"},wp.element.createElement("a",{className:"button is-primary",onClick:function(){!function(){var e,t;if($&&null!==(e=r.board)&&void 0!==e&&null!==(t=e.lists)&&void 0!==t&&t.length){var n=vn(r.board.lists),a=n.findIndex((function(e){return parseInt(e.term_id)===parseInt($)})),i=n.findIndex((function(e){return parseInt(e.term_id)===parseInt(d.term_id)}));a>-1&&a!==i&&(n[i].cards.map((function(e){n[a].hasOwnProperty("cards")||(n[a].cards=[]),n[a].cards.push(e)})),n[i].cards=[]),r.update("board",hn(hn({},r.board),{},{lists:n})),M(!1)}}()}},window.vibeprojects.translations.move),wp.element.createElement("a",{className:"link",onClick:function(){M(!1)}},window.vibeprojects.translations.cancel))):""),wp.element.createElement("div",{className:"cards_container"},d.hasOwnProperty("cards")&&d.cards.length?d.cards.map((function(t,n){return wp.element.createElement("div",{className:r.board.draggedCard&&r.board.draggedCard==t?"card_container dragged_card":"card_container",style:t.hasOwnProperty("style")?t.style:{}},"list"==e.view?wp.element.createElement(bn,{card:t}):wp.element.createElement(en,{card:t,list:d}))})):""),h?wp.element.createElement("div",{className:"newcard_form"},wp.element.createElement("label",null,window.vibeprojects.translations.card_title),wp.element.createElement("input",{type:"text",value:O.title,placeholder:window.vibeprojects.translations.enter_card_title,onChange:function(e){k(hn(hn({},O),{},{title:e.target.value}))}}),wp.element.createElement("a",{className:_?"button is-primary is-loading":"button is-primary",onClick:function(){E(!0),fetch("".concat(Cn,"/card/newcard/?post"),{method:"post",body:JSON.stringify(hn(hn({},O),r.path))}).then((function(e){return e.json()})).then((function(e){if(E(!1),e.status){var t=hn({},r.board),n=t.lists.findIndex((function(e){return e.term_id==d.term_id}));n>-1&&(e.card.list={term_id:t.lists[n].term_id,name:t.lists[n].name},t.lists[n].hasOwnProperty("cards")||(t.lists[n].cards=[]),t.hasOwnProperty("cards")||(t.cards=[]),t.lists[n].cards.push(e.card.card_id),t.cards.push(e.card),r.update("board",t),k(hn(hn({},O),{},{title:""})))}y(!1)}))}},window.vibeprojects.translations.add_new_card),wp.element.createElement("a",{className:"vicon vicon-close",onClick:function(){y(!1)}})):H("create_card")?wp.element.createElement("a",{className:"invisible_button is-loading",onClick:function(){y(!0)}},window.vibeprojects.translations.add_new_card):"")):""},Dn=(0,wp.element.createContext)({course:{},activeTab:"create_course",update:function(e){}});function Rn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Tn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Mn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Un(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Un(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Un(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var $n=wp.element,Ln=($n.createElement,$n.render,$n.useState),Fn=$n.useEffect,Jn=$n.useContext,Hn=($n.Fragment,$n.RawHTML,function(e){Jn(Dn);var t=Mn(Ln({}),2),n=t[0],r=t[1];Fn((function(){r(e.field)}),[e.field]);var a=function(t){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rn(Object(n),!0).forEach((function(t){Tn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);a.value=t,r(a),e.update(a,e.fieldIndex,"fieldvaluechanged")};return wp.element.createElement("div",{className:"switch"},"S"==n.value?wp.element.createElement("input",{type:"checkbox",id:n.id,checked:!0,onClick:function(){return a("H")}}):wp.element.createElement("input",{type:"checkbox",id:n.id,onClick:function(){return a("S")}}),wp.element.createElement("label",{for:n.id,className:"slider"}))});function Yn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Wn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wn(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Gn=wp.element,zn=(Gn.createElement,Gn.render,Gn.useState),Xn=Gn.useEffect,Bn=Gn.useContext,Zn=(Gn.Fragment,Gn.RawHTML,function(e){var t=qn(zn(e.field),2),n=t[0],r=t[1];Bn(Dn);Xn((function(){r(e.field)}),[e.field]);var a=function(t){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yn(Object(n),!0).forEach((function(t){Vn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);a.value=t.target.value,r(a),r(a),e.update(a,e.fieldIndex,"fieldvaluechanged")};return wp.element.createElement("div",{className:"textarea_field"},wp.element.createElement("textarea",{id:n.id,value:n.value,onChange:function(e){return a(e)},placeholder:n.default},n.value))});function Qn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qn(Object(n),!0).forEach((function(t){er(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function er(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return nr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var rr=wp.element,ar=(rr.createElement,rr.render,rr.useState),ir=rr.useEffect,or=rr.useContext,lr=(rr.Fragment,rr.RawHTML,function(e){or(Dn);var t=tr(ar(!1),2),n=t[0],r=t[1],a=tr(ar({}),2),i=a[0],o=a[1];ir((function(){var t=Kn({},e.field);y(e.field.value)&&!y(e.field.default)&&(t.value=e.field.default),o(t)}),[e.field]);return wp.element.createElement("div",{className:"number"},n||9999!==i.value?wp.element.createElement("input",{type:"number",id:i.id,value:i.value,onChange:function(t){return function(t){var n=Kn({},i);n.value=t.target.value,o(n),e.update(n,e.fieldIndex,"fieldvaluechanged")}(t)},placeholder:i.default}):wp.element.createElement("span",{onClick:function(){return r(!n)}},window.vibeprojects.translations.unlimited))});function sr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function cr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return pr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ur=wp.element,mr=(ur.createElement,ur.render,ur.useState),fr=ur.useEffect,br=ur.useContext,vr=(ur.Fragment,ur.RawHTML,function(e){br(Dn);var t=dr(mr({}),2),n=t[0],r=t[1];fr((function(){r(e.field)}),[e.field]);var a=function(t){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sr(Object(n),!0).forEach((function(t){cr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);a.value=t.target.value,r(a),e.update(a,e.fieldIndex,"fieldvaluechanged")};return wp.element.createElement("div",{className:"number"},wp.element.createElement("input",{type:"number",id:n.id,value:n.value,onChange:function(e){return a(e)},placeholder:n.default}))});function wr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return gr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _r=wp.element,Er=(_r.createElement,_r.render,_r.useState),jr=_r.useEffect,Or=_r.useContext,kr=(_r.Fragment,_r.RawHTML,function(e){var t=yr(Er({}),2),n=t[0],r=t[1];Or(Dn);jr((function(){r(e.field)}),[e.field]);var a=function(t){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wr(Object(n),!0).forEach((function(t){hr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);a.value=t.target.value,r(a),e.update(a,e.fieldIndex,"fieldvaluechanged")};return wp.element.createElement("div",{className:"vibe_form_field "+n.id},wp.element.createElement("input",{type:"text",id:n.id,value:n.value,onChange:function(e){return a(e)},placeholder:n.default}))});function Nr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ir=wp.element,Cr=(Ir.createElement,Ir.render,Ir.useState),Ar=Ir.useEffect,Dr=Ir.useContext,Rr=Ir.useRef,Tr=(Ir.Fragment,Ir.RawHTML,function(e){var t=Rr(null),n=Sr(Cr(e.field),2),r=n[0],a=n[1],i=Sr(Cr("vibe_form_field "+e.field.id),2),o=i[0],l=i[1];Dr(Dn);Ar((function(){a(e.field)}),[e.field]),Ar((function(){if(r.hasOwnProperty("isEmpty")&&r.isEmpty){l(o+" erroremptyvalue");var n=window.scrollX,a=window.scrollY;window.scrollTo(n,a),t.current.focus()}else{var i="vibe_form_field "+e.field.id;l(i)}}),[r,r.isEmpty,r.random]);var s=function(t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nr(Object(n),!0).forEach((function(t){xr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r);n.value=t,t.length&&(n.isEmpty=!1),a(n),e.update(n,e.fieldIndex,"fieldvaluechanged")};return wp.element.createElement("div",{className:o},wp.element.createElement("label",null,r.label," ",wp.element.createElement("span",{className:"tip",title:r.desc},wp.element.createElement("span",{className:"vicon vicon-info-alt"}))),wp.element.createElement("input",{ref:t,type:"text",className:"text_field",onChange:function(e){s(e.target.value)},placeholder:r.default,value:r.value,onBlur:function(t){e.update(r,e.fieldIndex,"enabledrafting")}}))});function Mr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ur(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Lr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Fr=wp.element,Jr=(Fr.createElement,Fr.render,Fr.useState),Hr=Fr.useEffect,Yr=Fr.useContext,Vr=(Fr.Fragment,Fr.RawHTML,function(e){Yr(Dn);var t=$r(Jr({}),2),n=t[0],r=t[1];Hr((function(){r(e.field)}),[e.field]);var a=function(t){var a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mr(Object(n),!0).forEach((function(t){Ur(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n);a.value=t.target.value,r(a),e.update(a,e.fieldIndex,"fieldvaluechanged")};return wp.element.createElement("div",{className:"vp_select_field"},wp.element.createElement("select",{id:n.id,onChange:function(e){return a(e)}},wp.element.createElement("option",null,window.vibeprojects.translations.select_option),n.options&&n.options.length?n.options.map((function(e,t){var r=!1;return e.value==n.value&&(r=!0),wp.element.createElement("option",{value:e.value,selected:r},e.label)})):""))});function qr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qr(Object(n),!0).forEach((function(t){Gr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Gr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Xr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Br=wp.element,Zr=(Br.createElement,Br.render,Br.useState),Qr=Br.useEffect,Kr=(Br.useContext,Br.Fragment,Br.RawHTML,Br.useRef),ea=function(e){var t=zr(Zr(e.field),2),n=t[0],r=t[1],a=zr(Zr(null),2),i=a[0],o=(a[1],Kr(null));Qr((function(){r(e.field)}),[e.field]),Qr((function(){if(o&&o.hasOwnProperty("current")&&o.current&&"undefined"!=typeof flatpickr){var t,n={altInput:!0,dateFormat:"Y-m-d",defaultDate:e.field.hasOwnProperty("value")&&null!==(t=e.field.value)&&void 0!==t&&t.length?e.field.value:[],onChange:l};window.vibebp.settings.flatpickrLang&&(n.locale=window.vibebp.settings.flatpickrLang),flatpickr(o.current,n)}}),[n]);var l=function(t){var a=Wr({},n);if(t&&t.length){var i=t[0].getDate();(i=i.toString()).length<2&&(i="0"+i);var o=t[0].getMonth()+1;(o=o.toString()).length<2&&(o="0"+o);var l=t[0].getFullYear()+"-"+o+"-"+i;a.value=l}else a.value="";r(a),e.update(a,e.fieldIndex,"fieldvaluechanged")};return wp.element.createElement("div",{className:"date"},wp.element.createElement("input",{type:"text",ref:o,placeholder:window.vibeprojects.translations.select_date}),n.hasOwnProperty("value")&&n.value&&n.value.length?wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){var t=Wr({},n);t.value=null,e.update(t,e.fieldIndex,"fieldvaluechanged"),i&&i.clear()}}):wp.element.createElement("span",{className:"vicon vicon-calendar"}))};function ta(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function na(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ta(Object(n),!0).forEach((function(t){ra(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ta(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ra(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function aa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ia(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ia(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ia(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var oa=wp.element,la=(oa.createElement,oa.render,oa.useState),sa=oa.useEffect,ca=(oa.useContext,oa.Fragment,oa.RawHTML,oa.useRef),da=function(e){var t=aa(la(e.field),2),n=t[0],r=t[1],a=aa(la(null),2),i=a[0],o=a[1],l=ca(null);sa((function(){r(e.field)}),[e.field]),sa((function(){if(o(null),l.current){var t={enableTime:!0,noCalendar:!0,dateFormat:"H:i",defaultDate:e.field.hasOwnProperty("value")&&e.field.value.length?e.field.value:[],onChange:s},n=flatpickr(l.current,t);window.vibebp.settings.flatpickrLang&&(t.locale=window.vibebp.settings.flatpickrLang),o(n)}}),[]);var s=function(t){var a=na({},n);if(t&&t.length){var i=t[0].getHours()+":"+t[0].getMinutes();a.value=i}else a.value="";r(a),e.update(a,e.fieldIndex,"fieldvaluechanged")};return wp.element.createElement("div",{className:"date time"},wp.element.createElement("input",{type:"text",ref:l}),n.hasOwnProperty("value")&&n.value&&n.value.length?wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){var t=na({},n);t.value=null,e.update(t,e.fieldIndex,"fieldvaluechanged"),i&&i.clear()}}):"")};function pa(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ua(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ma(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return fa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fa(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ba=wp.element,va=(ba.createElement,ba.render,ba.useState),wa=ba.useEffect,ha=(ba.useContext,ba.Fragment,ba.RawHTML,function(e){var t=ma(va(e.field),2),n=t[0],r=t[1],a=ma(va({post_content:"",raw:{}}),2),i=(a[0],a[1]),o=ma(va(Math.round(1e5*Math.random())),2),l=o[0];o[1];wa((function(){localforage.setItem("fixedToolbar",1)}),[]),wa((function(){if(e.field){var t=new CustomEvent("load_vibe_editor",{detail:{id:e.field.post_id?e.field.post_id:"",selector:".vibe_"+e.field.id+l+"_editor",content:e.field.hasOwnProperty("value")?e.field.value:"",raw:e.field.hasOwnProperty("raw")?e.field.raw:"",components:["editor"],updater:e.field.id+l}});document.dispatchEvent(t)}}),[e.field]),wa((function(){return e.field&&e.field.id&&document.addEventListener("vibe_editor_content_update_"+e.field.id+l,s,!1),function(){e.field&&e.field.id&&document.removeEventListener("vibe_editor_content_update_"+e.field.id+l,s)}}));var s=function(t){i({post_content:t.detail.raw_html,raw:t.detail.editor_content});var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pa(Object(n),!0).forEach((function(t){ua(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pa(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.field);n.value=t.detail.raw_html,n.raw=t.detail.editor_content,JSON.stringify(n.raw)!==JSON.stringify(e.field.raw)&&(r(n),e.update(n,e.fieldIndex,"fieldvaluechanged"))};return wp.element.createElement("div",{className:"vibe_projects_editor"},wp.element.createElement("div",{className:"vibe_"+n.id+l+"_editor"},wp.element.createElement("textarea",{value:n.value})))}),ya=wp.element,ga=(ya.createElement,ya.render,function(e){return wp.element.createElement("div",{class:"lds-ellipsis"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null))});function _a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ea(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_a(Object(n),!0).forEach((function(t){ja(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ja(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Oa(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ka(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ka(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ka(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Na=wp.element,xa=(Na.createElement,Na.render,Na.useState),Sa=Na.useEffect,Pa=Na.useContext,Ia=Na.Fragment,Ca=(Na.RawHTML,wp.data),Aa=Ca.dispatch,Da=Ca.select,Ra=function(e){Pa(Dn);var t=Oa(xa({}),2),n=t[0],r=t[1],a=Oa(xa(""),2),i=a[0],o=a[1],l=Oa(xa([]),2),s=l[0],c=l[1],d=Oa(xa({}),2),p=d[0],u=d[1],m=Oa(xa(!1),2),f=m[0],b=m[1],v=Da("vibebp").getUser();return v.token=Da("vibebp").getToken(),Sa((function(){e.field&&e.field.hasOwnProperty("show_value")&&u(e.field.show_value),r(e.field)}),[e.field]),Sa((function(){var t=Ea({},n);p.id&&(t.value=p.id,t.show_value=p,r(t),e.update(t,e.fieldIndex,"fieldvaluechanged"))}),[p]),Sa((function(){if(i.length>3){b(!0);var e="",t="";n.cpt&&(e=n.cpt,t="selectcpt"),n.post_type&&(e=n.post_type,t="selectcpt"),n.taxonomy&&(e=n.taxonomy,t="taxonomy"),fetch("".concat(window.vibeprojects.api_url,"/").concat(t,"/").concat(e),{method:"post",body:JSON.stringify({search:i,token:v.token})}).then((function(e){return e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}})).then((function(e){e.status&&Array.isArray(e.posts)&&(e.posts.map((function(e){localStorage.setItem("post_"+e.id,JSON.stringify(e))})),c(e.posts)),b(!1)})).catch((function(e){setIsSaving(!1),console.error("Uh oh, an error!",e),Aa("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})}))}}),[i]),wp.element.createElement("div",{className:"selectcptfield"},wp.element.createElement("div",{className:"selectcptfield_list"},p&&p.text?wp.element.createElement("div",{className:"selectcptfield_items"},wp.element.createElement("span",{type:n.cpt,onClick:function(){u({})}},p.text)):""),p&&p.text?"":wp.element.createElement(Ia,null,wp.element.createElement("div",{className:f?"control is-loading":"control"},wp.element.createElement("input",{type:"text",value:i,placeholder:window.vibeprojects.translations.type_keyword,onChange:function(e){o(e.target.value)}})),s.length?wp.element.createElement("div",{className:"search_results"},s.map((function(e,t){return wp.element.createElement("div",{className:"search_result selectcpt",onClick:function(){o("");var n=Ea({},p);n=e,s.splice(t,1),u(n)}},wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:e.text}}))}))):""))};function Ta(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ma(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ta(Object(n),!0).forEach((function(t){Ua(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ta(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ua(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $a(e){return function(e){if(Array.isArray(e))return Ja(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Fa(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function La(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||Fa(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fa(e,t){if(e){if("string"==typeof e)return Ja(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ja(e,t):void 0}}function Ja(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ha=wp.element,Ya=(Ha.createElement,Ha.render,Ha.useState),Va=Ha.useEffect,qa=Ha.useContext,Wa=(Ha.Fragment,Ha.RawHTML,wp.data),Ga=Wa.dispatch,za=Wa.select,Xa=function(e){qa(Dn);var t=La(Ya({}),2),n=t[0],r=t[1],a=La(Ya(""),2),i=a[0],o=a[1],l=La(Ya([]),2),s=l[0],c=l[1],d=La(Ya([]),2),p=d[0],u=d[1],m=La(Ya(!1),2),f=m[0],b=m[1],v=La(Ya(!1),2),w=v[0],h=v[1];return za("vibebp").getUser().token=za("vibebp").getToken(),Va((function(){e.field&&e.field.hasOwnProperty("show_value")&&u(e.field.show_value),r(e.field)}),[e.field]),Va((function(){if(i.length>3){h(!0);var e="",t="";n.cpt&&(e=n.cpt,t="selectcpt"),n.post_type&&(e=n.post_type,t="selectcpt"),n.taxonomy&&(e=n.taxonomy,t="taxonomy"),fetch("".concat(window.vibeprojects.api_url,"/").concat(t,"/").concat(e),{headers:{Authorization:window.vibeprojects.token},method:"post",body:JSON.stringify({search:i,token:za("vibebp").getToken()})}).then((function(e){return e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}})).then((function(e){e.status?Array.isArray(e.posts)&&(e.posts.map((function(e){localStorage.setItem("post_"+e.id,JSON.stringify(e))})),c(e.posts)):Ga("vibebp").addNotification({text:e.message}),h(!1)})).catch((function(e){h(!1),console.error("Uh oh, an error!",e),Ga("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})}))}}),[i]),wp.element.createElement("div",{className:"selectcptfield"},wp.element.createElement("div",{className:"selectcptfield_list"},p.length?wp.element.createElement("div",{className:"selectcptfield_items"},p.map((function(t){var a=n.cpt?n.taxonomy:"";return wp.element.createElement("span",{type:a,onClick:function(){var a=$a(p);a.splice(_(t,p),1),u(a);var i=Ma({},n);if(a&&a.length){var o=[];a.map((function(e){o.push(e.id)})),i.value=o,i.show_value=a,r(i),e.update(i,e.fieldIndex,"fieldvaluechanged")}else i.value=[],i.show_value=[],e.update(i,e.fieldIndex,"fieldvaluechanged")}},t.text)}))):""),f?wp.element.createElement("span",{className:"add_wrapper"},wp.element.createElement("div",{className:w?"control is-loading":"control"},wp.element.createElement("input",{type:"text",value:i,placeholder:n.hasOwnProperty("placeholder")?n.placeholder:window.vibeprojects.translations.type_keyword,onChange:function(e){o(e.target.value)}})),wp.element.createElement("span",{onClick:function(){b(!f)},className:"vicon vicon-close"})):wp.element.createElement("span",{className:"add_wrapper",onClick:function(){b(!f)}},window.vibeprojects.translations.add,wp.element.createElement("span",{className:"vicon vicon-plus"})),s.length?wp.element.createElement("div",{className:"search_results"},s.map((function(t,a){if(-1===_(t,p))return wp.element.createElement("div",{className:"search_result selectcpt",onClick:function(){o("");var i=$a(p);if(-1===_(t,i)){i.push(t),s.splice(a,1),u(i);var l=Ma({},n);if(i&&i.length){var c=[];i.map((function(e){c.push(e.id)})),l.value=c,l.show_value=i,r(l),e.update(l,e.fieldIndex,"fieldvaluechanged")}}}},wp.element.createElement("span",null,t.text))}))):"")};function Ba(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Za(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ba(Object(n),!0).forEach((function(t){Qa(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ba(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ka(e){return function(e){if(Array.isArray(e))return ni(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ti(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ei(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||ti(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ti(e,t){if(e){if("string"==typeof e)return ni(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ni(e,t):void 0}}function ni(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ri=wp.element,ai=(ri.createElement,ri.render,ri.useState),ii=ri.useEffect,oi=ri.useContext,li=(ri.Fragment,ri.RawHTML,function(e){oi(Dn);var t=ei(ai({}),2),n=t[0],r=t[1],a=ei(ai(""),2),i=(a[0],a[1]),o=ei(ai([]),2),l=o[0],s=o[1],c=ei(ai([]),2),d=c[0],p=c[1],u=ei(ai(!1),2),m=u[0],f=u[1],b=ei(ai(!1),2),v=b[0],w=b[1],h=ei(ai(!1),2),y=h[0],g=h[1];ii((function(){if(e.field&&e.field.hasOwnProperty("value")&&e.field.value.length){var t=[];e.field.value.map((function(n){e.field.options.map((function(e){e.value!=n&&e.id!=n||t.push(e)}))})),p(t)}r(e.field),g(!0)}),[e.field]),ii((function(){y&&(f(!0),s(Ka(n.options)),f(!1))}),[y]);var E="search_results";return v&&(E="search_results active"),wp.element.createElement("div",{className:"selectcptfield multiselect"},wp.element.createElement("div",{className:"selectcptfield_list"},d.length?wp.element.createElement("div",{className:"selectcptfield_items"},d.map((function(t){var a=n.cpt?n.multiselect:"";return wp.element.createElement("span",{type:a,onClick:function(){var a=Ka(d),i=Ka(l);a.splice(_(t,d,"value"),1),i.push(t),s(i),p(a);var o=Za({},n);if(a&&a.length){var c=[];a.map((function(e){e.hasOwnProperty("id")?c.push(e.id):e.hasOwnProperty("value")&&c.push(e.value)})),o.value=c,o.show_value=a,r(o),e.update(o,e.fieldIndex,"fieldvaluechanged")}else o.value=[],o.show_value=[],r(o),e.update(o,e.fieldIndex,"fieldvaluechanged")}},t.label)}))):""),wp.element.createElement("div",{className:"selectimitate",onClick:function(){w(!v)}},v?wp.element.createElement("i",{class:"vicon vicon-angle-up","aria-hidden":"true"}):wp.element.createElement("i",{class:"vicon vicon-angle-down","aria-hidden":"true"}),l.length?wp.element.createElement("div",{className:E},l.map((function(t,a){if(-1===_(t,d,"value"))return wp.element.createElement("div",{className:"search_result selectcpt",onClick:function(){i("");var o=Ka(d);if(-1===_(t,o,"value")){o.push(t),l.splice(a,1),p(o);var s=Za({},n);if(o&&o.length){var c=[];o.map((function(e){e.hasOwnProperty("id")?c.push(e.id):e.hasOwnProperty("value")&&c.push(e.value)})),s.value=c,s.show_value=o,r(s),e.update(s,e.fieldIndex,"fieldvaluechanged")}}}},wp.element.createElement("span",null,t.label))}))):m?wp.element.createElement("div",{className:"search_results"},wp.element.createElement(ga,null)):""))});function si(e){return function(e){if(Array.isArray(e))return fi(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||mi(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ci(e){return(ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function di(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ui(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||mi(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mi(e,t){if(e){if("string"==typeof e)return fi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fi(e,t):void 0}}function fi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var bi=wp.element,vi=(bi.createElement,bi.render,bi.useState),wi=bi.useEffect,hi=(bi.useContext,bi.Fragment),yi=(bi.RawHTML,wp.data),gi=(yi.dispatch,yi.select),_i=function(e){var t=ui(vi({}),2),n=t[0],r=t[1],a=ui(vi(""),2),i=a[0],o=a[1],l=ui(vi([]),2),s=l[0],c=l[1],d=ui(vi([]),2),p=d[0],u=d[1],m=ui(vi(!0),2),f=m[0],b=m[1],v=ui(vi(!1),2),w=v[0],h=v[1],y=ui(vi(!1),2),g=y[0],E=y[1],j=gi("vibebp").getUser();j.token=gi("vibebp").getToken(),wi((function(){r(e.field),E(!0)}),[e.field]),wi((function(){if(g&&!f){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?di(Object(n),!0).forEach((function(t){pi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):di(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},n),a=[];p&&p.length?(p.map((function(e){a.push(e.id)})),t.value=a,r(t),e.update(t,e.fieldIndex,"fieldvaluechanged")):(t.value=a,r(t),e.update(t,e.fieldIndex,"fieldvaluechanged"))}}),[p]),wi((function(){if(b(!0),n.hasOwnProperty("taxonomy")&&n.taxonomy.length){n.taxonomy&&(n.taxonomy,"taxonomy"),fetch("".concat(window.vibeprojects.apiUrl,"/taxonomy/?post"),{method:"post",body:JSON.stringify({taxonomy:n.taxonomy,token:j.token})}).then((function(e){return e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}})).then((function(t){if(t.status&&Array.isArray(t.terms)){if(e.field.hasOwnProperty("value")&&t.terms.length){var n,r,a,i=t.terms.filter((function(t){return e.field.value.indexOf(t.id)>-1}));if(null!==(n=e.field)&&void 0!==n&&n.value)null===(r=e.field)||void 0===r||null===(a=r.value)||void 0===a||a.map((function(e){"string"==typeof e&&e.includes("new_")&&i.push({id:e})})),u(i)}c(t.terms)}b(!1)}))}}),[g]);var O=si(s);return i.length&&(O=s.filter((function(e){return e.text.toLowerCase().indexOf(i.toLowerCase())>-1}))),wp.element.createElement("div",{className:"taxonomy_field"},p.length?wp.element.createElement("div",{className:"selected_term_list_wrapper"},wp.element.createElement("div",{className:"selected_term_list"},p.map((function(e,t){var r=n.cpt?n.taxonomy:"";return"number"==typeof e.id?wp.element.createElement("div",{className:"term_select"},wp.element.createElement("span",{type:r,onClick:function(){var n=si(p),r=si(s);n.splice(t,1),r.push(e),c(r),u(n)}},e.text)):wp.element.createElement("div",{className:"term_select"},wp.element.createElement("input",{type:"text",value:p[t].id.split("new_")[1],placeholder:window.vibeprojects.translations.type_here,onChange:function(e){var n=si(p);n[t]={id:"new_"+e.target.value},u(n)}}),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){var e=si(p);t>-1&&e.splice(t,1),u(e)}}))})))):"",wp.element.createElement("div",{className:"term_select"},wp.element.createElement("div",{class:"term_select_label",onClick:function(){h(!w)}},n.label,w?wp.element.createElement("i",{class:"vicon vicon-angle-down","aria-hidden":"true"}):wp.element.createElement("i",{class:"vicon vicon-plus","aria-hidden":"true"})),w?wp.element.createElement("div",{className:"search_term_list"},wp.element.createElement("div",{className:"search_term",onClick:function(){var e=si(p);e.push({id:"new_"}),u(e),h(!1)}},function(){if("object"!=ci(j.caps)||Array.isArray(j.caps)){if(j.caps.indexOf("edit_posts")>-1)return wp.element.createElement("span",null,window.vibeprojects.translations.add_new)}else if(Object.keys(j.caps).indexOf("edit_posts")>-1)return wp.element.createElement("span",null,window.vibeprojects.translations.add_new)}()),s.length>8?wp.element.createElement("div",{className:"searchbox"},wp.element.createElement("input",{type:"text",value:i,onChange:function(e){return o(e.target.value)}}),wp.element.createElement("span",{className:"vicon vicon-search"})):"",O.length?wp.element.createElement(hi,null,O.map((function(e,t){if(-1===_(e,p))return wp.element.createElement("div",{className:"search_term",onClick:function(){o("");var n=si(p);-1===_(e,n)&&(n.push(e),s.splice(t,1),u(n),h(!1))}},wp.element.createElement("span",null,e.text))}))):""):""))};function Ei(e){return(Ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ji(e){return function(e){if(Array.isArray(e))return Pi(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Si(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ki(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oi(Object(n),!0).forEach((function(t){Ni(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ni(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||Si(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Si(e,t){if(e){if("string"==typeof e)return Pi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pi(e,t):void 0}}function Pi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ii=wp.element,Ci=(Ii.createElement,Ii.render,Ii.useState),Ai=Ii.useEffect,Di=Ii.Fragment,Ri=(Ii.useContext,wp.data),Ti=Ri.dispatch,Mi=Ri.select,Ui=function(e){var t=xi(Ci(!1),2),n=t[0],r=t[1],a=xi(Ci([]),2),i=a[0],o=a[1],l=xi(Ci([]),2),s=l[0],c=(l[1],xi(Ci(!1),2)),d=c[0],p=c[1],u=xi(Ci(!1),2),m=u[0],f=u[1],b=xi(Ci(0),2),v=b[0],w=b[1],h=xi(Ci([]),2),y=h[0],_=h[1],E=xi(Ci("media"),2),j=E[0],O=E[1],k=xi(Ci({posts_per_page:20,paged:1,search_terms:"",orderby:""}),2),N=k[0],x=k[1],S=xi(Ci({name:"",url:"",type:"file"}),2),P=S[0],I=S[1];g((function(){fetch("".concat(window.vibebp.api.url,"/user/fetch_media"),{method:"post",body:JSON.stringify(ki(ki({},N),{},{token:Mi("vibebp").getToken()}))}).then((function(e){return e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}})).then((function(e){if(r(!1),e.status)if(m){var t=ji(i);e.data.map((function(e){t.push(e)})),o(t),f(!1),t.length<parseInt(data.total)?p(!0):p(!1)}else o(e.data),e.data.length<parseInt(e.total)?p(!0):p(!1)})).catch((function(e){r(!1),console.error("Uh oh, an error!",e),Ti("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})}))}),500,[N]);var C=function(t){e.share(t)};Ai((function(){Ti("vibebp").setData("mediaTab",j),-1==y.indexOf(j)&&(document.dispatchEvent(new CustomEvent("vibebp_media_tab",{detail:{tab:j}})),document.addEventListener("vibebp_media_tab_submit",(function(t){e.share(t.detail.media),e.close(!1)}),!1),_([].concat(ji(y),[j])))}),[j]);var A,D=function(e){switch(e.type){case"image":return wp.element.createElement("img",{src:e.url,className:"content_to_html_image"});case"video":return wp.element.createElement("video",{class:"video_plyr"},wp.element.createElement("source",{src:e.url,type:"video/mp4"}));case"audio":return wp.element.createElement("audio",{class:"audio_plyr",controls:!0},wp.element.createElement("source",{src:e.url,type:"audio/mp3"}));default:if(void 0!==e.url&&e.type)return e.url.split(".pdf").length>1?wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("embed",{width:"200px",height:"300px",controls:!0,type:"application/pdf",src:e.url}),wp.element.createElement("div",{className:"embed_block"})):wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("a",{href:e.url},wp.element.createElement("span",{className:"vicon vicon-clip"})))}};return wp.element.createElement("div",{className:"vibe_editor_modal"},wp.element.createElement("span",{onClick:e.close}),wp.element.createElement("div",{className:"ve_modal-content"},wp.element.createElement("div",{className:"ve_modal-header"},wp.element.createElement("div",null,window.vibebp.settings.media_tabs?Object.keys(window.vibebp.settings.media_tabs).map((function(t){if("upload"!=t||!window.vibebp.settings.hasOwnProperty("upload_capability")||!window.vibebp.settings.upload_capability)return wp.element.createElement("a",{className:j==t?"active":"",onClick:function(){O(t)}},window.vibebp.settings.media_tabs[t]);var n=Mi("vibebp").getUser();if(void 0!==n&&n.hasOwnProperty("caps")&&void 0!==n.caps){var r=0;if(Array.isArray(n.caps)?n.caps.findIndex((function(e,t){return e==window.vibebp.settings.upload_capability}))>-1&&(r=1):"object"===Ei(n.caps)&&Object.keys(n.caps).map((function(e,t){e===window.vibebp.settings.upload_capability&&n.caps[e]&&(r=1)})),e.hasOwnProperty("allow_upload")&&e.allow_upload&&(r=1),r)return wp.element.createElement("a",{className:j==t?"active":"",onClick:function(){O(t)}},window.vibebp.settings.media_tabs[t])}})):""),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(t){e.close(!1)}})),wp.element.createElement("div",{className:"ve_modal-body"},"media"===j?wp.element.createElement(Di,null,wp.element.createElement("div",{className:"vibebp_form"},wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("input",{type:"text",placeholder:window.vibebp.translations.search_text,onChange:function(e){return x(ki(ki({},N),{},{search_terms:e.target.value}))}})),wp.element.createElement("div",{className:"vibebp_form_field"},wp.element.createElement("select",{onChange:function(e){x(ki(ki({},N),{},{order:e.target.value}))}},Object.keys(window.vibeEditor.media_order).map((function(e){return wp.element.createElement("option",{value:e},window.vibeEditor.media_order[e])}))))),n?wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):i&&i.length?wp.element.createElement("div",{className:"allMedia"},i.map((function(t,n){return wp.element.createElement("div",{className:"single_media"},wp.element.createElement("span",{onClick:function(n){C(t),e.close(!1)}},D(t)),wp.element.createElement("span",{className:"filename",onClick:function(n){C(t),e.close(!1)}},t.name),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){return function(e){var t=ji(i);t.splice(t.findIndex((function(t){return t.id==e.id})),1),o(t),fetch("".concat(window.vibebp.api.url,"/user/delete_media"),{method:"post",body:JSON.stringify({token:Mi("vibebp").getToken(),media:e})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&Ti("vibebp").addNotification({text:e.message})}))}(t)}}))}))):wp.element.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_media),d?wp.element.createElement("a",{className:"link",onClick:function(){x(ki(ki({},N),{},{paged:N.paged+1})),f(!0)}},window.vibebp.translations.more):""):"upload"===j?wp.element.createElement(Di,null,wp.element.createElement("div",{className:"upload_media"},wp.element.createElement("label",{for:"vibe_editor_upload_media"},v?wp.element.createElement("div",{className:"vibebp_progress_wrapper"},wp.element.createElement("span",{className:"progress_wrapper"},wp.element.createElement("span",{className:"progress_bar",style:{width:v+"%"}})),wp.element.createElement("span",null,v,"%")):wp.element.createElement("span",{className:"vicon vicon-plus"})),wp.element.createElement("input",{type:"file",id:"vibe_editor_upload_media",onChange:function(e){return function(e){if(e.target.files[0]){var t=e.target.files[0].size/1024/1024;if(tus.isSupported&&tus.canStoreURLs&&t>4){var n="".concat(window.vibebp.api.url,"/user/upload_media_stream"),r=new tus.Upload(e.target.files[0],{endpoint:n,chunkSize:2097152,retryDelays:[0,3e3],metadata:{token:Mi("vibebp").getToken(),filename:e.target.files[0].name,filetype:e.target.files[0].type},onError:function(e){e.hasOwnProperty("message")&&Ti("vibebp").addNotification({text:e.message})},onProgress:function(e,t){var n=(e/t*100).toFixed(2);w(n),100==n&&setTimeout((function(){x({posts_per_page:20,paged:1,search_terms:"",orderby:""}),w(0),O("media")}),500)},onSuccess:function(){localStorage.removeItem(r._urlStorageKey),fetch("".concat(r.url,"/complete_stream"),{method:"post",body:JSON.stringify({token:Mi("vibebp").getToken()})}).then((function(e){return e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}})).then((function(e){e.status&&(x({posts_per_page:20,paged:1,search_terms:"",orderby:""}),w(0),O("media")),e.hasOwnProperty("message")&&Ti("vibebp").addNotification({text:e.message})})).catch((function(e){console.error("Uh oh, an error!",e),Ti("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})}))}});r.findPreviousUploads().then((function(e){e.length>0&&r.resumeFromPreviousUpload(e[0]),r.start()})),tus.Upload.terminate(n).then((function(){})).catch((function(e){}))}else{var a=new FormData;a.append("file",e.target.files[0]),a.append("body",JSON.stringify({token:Mi("vibebp").getToken()})),fetch("".concat(window.vibebp.api.url,"/user/upload_media"),{method:"post",body:a}).then((function(e){return e.ok?e.json():{status:0,message:window.wplms_course_data.translations.error_loading_data}})).then((function(e){if(e.status){var t=ji(i);t.unshift(e.data),o(t),O("media")}else e.hasOwnPropoerty("message")&&Ti("vibebp").addNotification({text:e.message})})).catch((function(e){console.error("Uh oh, an error!",e),Ti("vibebp").addNotification({text:window.wplms_course_data.translations.error_loading_data})}))}}}(e)}}),s&&s.length?wp.element.createElement("div",{className:"uploaded"},wp.element.createElement("strong",null,window.vibebp.translations.uploaded_media),wp.element.createElement("div",{className:"uploaded_files"},s.map((function(e,t){return wp.element.createElement("div",{className:"single_media",onClick:function(t){C(e)}},D(e))})))):"")):"embed"===j?wp.element.createElement(Di,null,wp.element.createElement("div",{className:"embed_media"},wp.element.createElement("label",{for:"vibe_editor_embed_name"}," ",window.vibebp.translations.enter_emabed_name," "),wp.element.createElement("input",{type:"text",id:"vibe_editor_embed_name",onChange:function(e){return I(ki(ki({},P),{},{name:e.target.value}))}}),wp.element.createElement("label",{for:"vibe_editor_embed_url"}," ",window.vibebp.translations.enter_embed_url," "),wp.element.createElement("input",{type:"text",id:"vibe_editor_embed_url",onChange:function(e){return I(ki(ki({},P),{},{url:e.target.value}))}}),wp.element.createElement("select",{onChange:function(e){return I(ki(ki({},P),{},{type:e.target.value}))},value:P.type},Object.keys(window.vibeEditor.embed_types).map((function(e){return wp.element.createElement("option",{value:e},window.vibeEditor.embed_types[e])}))),Object.values(P).findIndex((function(e){return""==e||null==e}))>-1?"":wp.element.createElement("button",{className:"button is-primary",onClick:function(){C(P),e.close(!1)}},window.vibebp.translations.embed))):wp.element.createElement("div",null,(A=new CustomEvent("vibebp_media_tab",{detail:{tab:j}}),document.dispatchEvent(A),wp.element.createElement("div",{className:j}))))))};function $i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Li(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$i(Object(n),!0).forEach((function(t){Fi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ji(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Hi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Hi(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Yi=wp.element,Vi=(Yi.createElement,Yi.render),qi=Yi.useState,Wi=Yi.useEffect,Gi=(Yi.Fragment,Yi.useContext),zi=(Yi.useRef,wp.data),Xi=(zi.dispatch,zi.select,function(e){Gi(Dn);var t=Ji(qi(!1),2),n=t[0],r=t[1],a=Ji(qi({}),2),i=a[0],o=a[1],l=Ji(qi(!1),2),s=l[0],c=l[1],d=Ji(qi(!1),2),p=d[0],u=d[1],m=Ji(qi(!1),2),f=m[0],b=m[1],v=Ji(qi([]),2),w=(v[0],v[1],Ji(qi(null),2)),h=w[0],y=w[1],g=Ji(qi(null),2),_=g[0],E=g[1];Wi((function(){e.hasOwnProperty("media")&&(e.field.value=e.media),e.field.hasOwnProperty("type")&&o(e.field)}),[e.field]);Wi((function(){if(i.hasOwnProperty("value")&&i.value&&i.value.hasOwnProperty("type")&&h){if("audio"==i.value.type||"video"==i.value.type){var e=new Plyr(h);E(e)}if("youtube"==i.value.type){var t=new Plyr(h);E(t)}if("vimeo"==i.value.type){var n=new Plyr(h);E(n)}if("dash"==i.value.type){dashjs.MediaPlayer().create().initialize(h,i.value.url,!0);var r=new Plyr(h,{captions:{active:!0,update:!0}});E(r)}if("hls"==i.value.type){var a=new Plyr(h,{captions:{active:!0,update:!0}});if(Hls.isSupported()){var o=new Hls;o.loadSource(i.value.url),o.attachMedia(h)}else h.src=i.value.url;E(a)}}}),[h,i]);var j=function(e){e&&y(e)};return wp.element.createElement("div",{className:"media_wrapper"},i&&i.hasOwnProperty("value")&&i.value&&i.value.hasOwnProperty("url")?wp.element.createElement("div",{className:"media_file"},wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){var t=Li({},i);c(!1),u(!1),_&&(_.destroy(),E(null)),t.value=null,o(t),e.update(t,e.fieldIndex,"fieldvaluechanged")}}),wp.element.createElement("div",null," ",function(){if(i.hasOwnProperty("value")&&i.value&&i.value.hasOwnProperty("type")&&i.value.hasOwnProperty("url"))switch(i.value.type){case"image":return wp.element.createElement("img",{src:i.value.url,className:"content_to_html_image"});case"video":return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("video",{className:"content_to_html_video",ref:function(e){e&&y(e)}},wp.element.createElement("source",{src:i.value.url,type:"video/mp4"})));case"audio":return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("audio",{className:"content_to_html_audio",ref:function(e){e&&y(e)}},wp.element.createElement("source",{src:i.value.url,type:"audio/mp3"}))," ");case"youtube":var e=(n=i.value.url,!(!(r=n.match(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&|?]+)/))||!r.length)&&r[1]);return e?wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("div",{ref:function(e){e&&y(e)},"data-plyr-provider":"youtube","data-plyr-embed-id":e})):wp.element.createElement("div",{className:"video_wrapper"}," ",wp.element.createElement("span",{className:"vicon vicon-alert"},window.wplms_course_data.translations.invalid_url));case"vimeo":var t=i.value.url.match(/(http|https)?:\/\/(www\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/);return wp.element.createElement("div",{className:"video_wrapper"}," ",wp.element.createElement("div",{ref:function(e){e&&y(e)},"data-plyr-provider":"vimeo","data-plyr-embed-id":t[4]}));case"hls":if("m3u8"==i.value.url.split(".").pop())return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("video",{ref:j,controls:!0,crossorigin:!0,playsinline:!0}));break;case"dash":if("mpd"==i.value.url.split(".").pop())return wp.element.createElement("div",{className:"video_wrapper"},wp.element.createElement("video",{ref:j,controls:!0,crossorigin:!0,playsinline:!0}));break;default:if(void 0!==i.value.url&&i.value.hasOwnProperty("type"))return i.value.url.split(".pdf").length>1?wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("embed",{width:"200px",height:"300px",controls:!0,type:"application/pdf",src:i.value.url.url}),wp.element.createElement("div",{className:"embed_block"})):wp.element.createElement("div",{className:"embed_block_wrapper"},wp.element.createElement("a",{href:i.value.url.url},wp.element.createElement("span",{className:"vicon vicon-clip"}),wp.element.createElement("span",null,i.value.name)))}var n,r}()," ")):"course_featured"==i.type?wp.element.createElement("div",{onClick:function(){r(!0)}},wp.element.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"100%",height:"100%",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-image"},wp.element.createElement("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),wp.element.createElement("circle",{cx:"8.5",cy:"8.5",r:"1.5"}),wp.element.createElement("polyline",{points:"21 15 16 10 5 21"}))):"featured_video"==i.type?wp.element.createElement("div",{className:"featured_video"},wp.element.createElement("span",{onClick:function(){c(!1)}},i.label),s&&!p?wp.element.createElement("input",{type:"text",placeholder:window.vibeprojects.translations.enter_video_link+" ("+s+")",value:i.value?i.value.url:"",className:p?"is-success":"is-danger",onChange:function(t){if(b(!1),"youtube"==s){if(/(?:https?:\/{2})?(?:w{3}\.)?youtu(?:be)?\.(?:com|be)(?:\/watch\?v=|\/)([^\s&|?]+)/.test(t.target.value)){u(!0);var n=Li({},i);n.value={type:"youtube",url:t.target.value},o(n),e.update(n,e.fieldIndex,"fieldvaluechanged")}else u(!1)}if("vimeo"==s){if(/(http|https)?:\/\/(www\.)?vimeo.com\/(?:channels\/(?:\w+\/)?|groups\/([^\/]*)\/videos\/|)(\d+)(?:|\/\?)/.test(t.target.value)){u(!0);var r=Li({},i);r.value={type:"vimeo",url:t.target.value},o(r),e.update(r,e.fieldIndex,"fieldvaluechanged")}else u(!1)}if("hls"==s)if("m3u8"==t.target.value.split(".").pop()){u(!0);var a=Li({},i);a.value={type:"hls",url:t.target.value},o(a),e.update(a,e.fieldIndex,"fieldvaluechanged")}else u(!1);if("dash"==s)if("mpd"==t.target.value.split(".").pop()){u(!0);var l=Li({},i);l.value={type:"dash",url:t.target.value},o(l),e.update(l,e.fieldIndex,"fieldvaluechanged")}else u(!1)}}):wp.element.createElement("div",{className:"featured_video_options"},wp.element.createElement("span",{className:"vicon vicon-control-play",onClick:function(){b(!1),r(!0)}}),wp.element.createElement("span",{className:"vicon vicon-youtube",onClick:function(){return c("youtube")}}),wp.element.createElement("span",{className:"vicon vicon-vimeo-alt",onClick:function(){return c("vimeo")}}),window.vibeprojects.settings.advanced_video_format_hls?wp.element.createElement("span",{className:"vicon vicon-video-clapper",onClick:function(){return c("hls")}}):"",window.vibeprojects.settings.advanced_video_format_dash?wp.element.createElement("span",{className:"vicon vicon-video-clapper",onClick:function(){return c("dash")}}):"",window.vibeprojects.settings.advanced_video_format_360?wp.element.createElement("span",{className:"vicon vicon-loop",onClick:function(){b("360"),r(!0)}}):"")):"featured_audio"==i.type?wp.element.createElement("div",{className:"featured_video",onClick:function(){r(!0)}},i.label,wp.element.createElement("span",{className:"vicon vicon-control-play"})):wp.element.createElement("div",{className:"vicon vicon-plus",onClick:function(){r(!0)}}),n?wp.element.createElement("div",null,function(){document.querySelector("#vibemediamodal")&&document.querySelector("#vibemediamodal").remove();var t=document.createElement("div");t.setAttribute("id","vibemediamodal"),document.body.appendChild(t),Vi(wp.element.createElement(Ui,{type:e.type,close:function(){r(!1),document.querySelector("#vibemediamodal").remove()},share:function(t){var n,r;n=t,r=Li({},i),f&&(n.videotype=f),r.value=n,o(r),e.update(r,e.fieldIndex,"fieldvaluechanged")}}),document.getElementById("vibemediamodal"))}()):"")});function Bi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bi(Object(n),!0).forEach((function(t){Qi(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qi(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ki(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return eo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eo(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var to=wp.element,no=(to.createElement,to.render,to.useState),ro=to.useEffect,ao=(to.Fragment,to.useContext,wp.data),io=(ao.dispatch,ao.select,function(e){var t=Ki(no({}),2),n=t[0],r=t[1];ro((function(){r(e.field)}),[e.field]);var a=function(t,a,i){if("fieldvaluechanged"==i){var o=Zi({},n);t.value&&t.value.hasOwnProperty("url")?o.value[a]=t.value:o.value.splice(a,1),r(o),e.update(o,e.fieldIndex,"fieldvaluechanged")}};return wp.element.createElement("div",{className:"multimedia"},wp.element.createElement("span",{className:"vicon vicon-plus button",onClick:function(){var e=Zi({},n);e.hasOwnProperty("value")&&Array.isArray(e.value)||(e.value=[]),e.value.push({}),r(e)}}),n.value&&n.value.length?wp.element.createElement("div",{className:"attachments"},n.value.map((function(e,t){return wp.element.createElement("div",{className:"attachment"},wp.element.createElement(Xi,{field:{type:n.id},media:e,fieldIndex:t,update:a}))}))):"")});function oo(e){return(oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function lo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function so(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lo(Object(n),!0).forEach((function(t){co(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function co(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function po(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return uo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uo(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var mo=wp.element,fo=(mo.createElement,mo.render,mo.useState),bo=mo.useEffect,vo=(mo.useContext,mo.Fragment,mo.RawHTML,function(e){var t=po(fo(!1),2),n=t[0],r=t[1],a=po(fo({}),2),i=a[0],o=a[1];bo((function(){var t=so({},e.field);y(t.value)&&(t.value=so({},t.default),e.update(t,e.fieldIndex,"fieldvaluechanged")),o(t)}),[e.field]);var l=function(t){var n=so({},i);n.value=t,o(n),e.update(n,e.fieldIndex,"fieldvaluechanged")};return wp.element.createElement("div",{className:"duration_field_wrapper"},n?wp.element.createElement("div",{className:"duration_field"},wp.element.createElement("input",{type:"text",value:i.value&&i.value.hasOwnProperty("value")?i.value.value:"",onChange:function(e){return l(so(so({},i.value),{},{value:e.target.value}))}}),wp.element.createElement("select",{value:i.value&&i.value.hasOwnProperty("parameter")?i.value.parameter:86400,onChange:function(e){l(so(so({},i.value),{},{parameter:e.target.value}))}},window.vibeprojects.duration.map((function(e){return wp.element.createElement("option",{value:e.value},e.label)}))),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){i.value.hasOwnProperty("parameter")||l(so(so({},i.value),{},{parameter:86400})),r(!n)}})):y(i.value)?"number"==typeof i.default&&9999==i.default&&"object"==oo(i.default)&&9999==i.default.value?wp.element.createElement("div",{className:"duration_field"},wp.element.createElement("span",null,window.vibeprojects.translations.unlimited_duration),wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){r(!0),l({value:9999,parameter:86400})}})):wp.element.createElement("div",{className:"duration_field"},wp.element.createElement("span",null,wp.element.createElement("label",null,i.label),"object"==oo(i.default)?wp.element.createElement("span",null,wp.element.createElement("span",null,i.default.value),wp.element.createElement("span",null,window.vibeprojects.duration[window.vibeprojects.duration.findIndex((function(e){return e.value==i.default.parameter}))].label)):wp.element.createElement("span",null,wp.element.createElement("span",null,i.default),wp.element.createElement("select",{onChange:function(e){l({value:i.default,parameter:e.target.value})}},window.vibeprojects.duration.map((function(e){return wp.element.createElement("option",{value:e.value},e.label)}))))),wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){return r(!0)}})):"object"==oo(i.value)&&9999==i.value.value?wp.element.createElement("div",{className:"duration_field"},wp.element.createElement("span",null,window.vibeprojects.translations.unlimited_duration),wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){r(!0),l({value:9999,parameter:86400})}})):wp.element.createElement("div",{className:"duration_field"},wp.element.createElement("span",null,"object"==oo(i.value)?wp.element.createElement("span",null,wp.element.createElement("span",null,i.value.value),wp.element.createElement("span",null,window.vibeprojects.duration[window.vibeprojects.duration.findIndex((function(e){return e.value==i.value.parameter}))].label)):wp.element.createElement("span",null,wp.element.createElement("span",null,i.value),wp.element.createElement("select",{onChange:function(e){l({value:i.default,parameter:e.target.value})}},window.vibeprojects.duration.map((function(e){return wp.element.createElement("option",{value:e.value},e.label)}))))),wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){return r(!0)}})))});function wo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ho(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ho(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ho(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var yo=wp.element,go=(yo.createElement,yo.render,yo.useState),_o=yo.useEffect,Eo=(yo.useContext,yo.Fragment),jo=(yo.RawHTML,function(e){var t=wo(go({}),2),n=t[0],r=t[1];_o((function(){r(e.field)}),[e.field]);var a=function(t,n,r){"fieldvaluechanged"==r&&(e.hasOwnProperty("ufieldIndex")?e.update({field:t,index:n,ufieldIndex:e.ufieldIndex},"fieldvaluechanged"):e.update({field:t,index:n},"fieldvaluechanged")),"enabledrafting"==r&&e.update({field:t,cindex:n},"enabledrafting")};return wp.element.createElement(Eo,null,void 0!==n?wp.element.createElement("div",{className:"field_wrapper field_"+n.type},"next_button"!=n.type&&"prev_button"!=n.type?wp.element.createElement("span",null,n.label&&"title"!=n.type&&"course_featured"!=n.type&&"next_button"!=n.type&&"prev_button"!=n.type&&"taxonomy"!=n.type&&"featured_video"!=n.type&&"group"!=n.type&&"forum"!=n.type?wp.element.createElement("label",null,n.label,n.hasOwnProperty("desc")?wp.element.createElement("span",{className:"tip",title:n.desc},wp.element.createElement("span",{className:"vicon vicon-info-alt"})):""):"",n.text?wp.element.createElement("strong",null,n.text):""):"",wp.element.createElement("div",{className:"field_value"},function(t,n,r){switch(t.type){case"label":return wp.element.createElement("div",{className:"vibe_form_field "+t.style},wp.element.createElement("strong",{dangerouslySetInnerHTML:{__html:t.default}}));case"title":return wp.element.createElement(Tr,{field:t,fieldIndex:n,tabIndex:r,update:a});case"taxonomy":return wp.element.createElement(_i,{field:t,fieldIndex:n,tabIndex:r,update:a});case"course_featured":case"featured_image":case"featured":return wp.element.createElement(Xi,{field:t,type:"image",fieldIndex:n,tabIndex:r,update:a});case"featured_video":return wp.element.createElement(Xi,{field:t,type:"video",fieldIndex:n,tabIndex:r,update:a});case"featured_audio":return wp.element.createElement(Xi,{field:t,type:"audio",fieldIndex:n,tabIndex:r,update:a});case"textarea":return wp.element.createElement(Zn,{field:t,fieldIndex:n,tabIndex:r,update:a});case"editor":return wp.element.createElement(ha,{field:t,fieldIndex:n,tabIndex:r,update:a});case"unlimited_number":return wp.element.createElement(lr,{field:t,fieldIndex:n,tabIndex:r,update:a});case"number":return wp.element.createElement(vr,{field:t,fieldIndex:n,tabIndex:r,update:a});case"duration":return wp.element.createElement(vo,{field:t,fieldIndex:n,tabIndex:r,update:a});case"select":return wp.element.createElement(Vr,{field:t,fieldIndex:n,tabIndex:r,update:a});case"selectmulticpt":return wp.element.createElement(Xa,{field:t,fieldIndex:n,tabIndex:r,update:a});case"multiselect":return wp.element.createElement(li,{field:t,fieldIndex:n,tabIndex:r,update:a});case"showhide":case"switch":case"yesno":case"conditionalswitch":case"reverseconditionalswitch":return wp.element.createElement(Hn,{field:t,fieldIndex:n,tabIndex:r,update:a});case"selectcpt":return wp.element.createElement(Ra,{field:t,fieldIndex:n,tabIndex:r,update:a});case"text":return wp.element.createElement(kr,{field:t,fieldIndex:n,tabIndex:r,update:a});case"media":return wp.element.createElement(Xi,{field:t,type:"image",fieldIndex:n,tabIndex:r,update:a});case"multiattachments":return wp.element.createElement(io,{field:t,type:"image",fieldIndex:n,tabIndex:r,update:a});case"time":return wp.element.createElement(da,{field:t,fieldIndex:n,tabIndex:r,update:a});case"date":return wp.element.createElement(ea,{field:t,fieldIndex:n,tabIndex:r,update:a});case"repeatable":case"repeatable_count":return wp.element.createElement(RepeatableOptions,{ufieldIndex:e.ufieldIndex,field:t,fieldIndex:n,cindex:e.cindex,tabIndex:r,update:a});default:var i=new CustomEvent("wplms_custom_field",{detail:{field:t,index:n,props:e,update:a}});if(document.dispatchEvent(i),t&&t.hasOwnProperty("id"))return wp.element.createElement("div",{id:"wplms_custom_field_"+t.id})}return""}(n,e.fieldIndex,e.tabIndex))):"")});function Oo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ko(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oo(Object(n),!0).forEach((function(t){No(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function No(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xo(e){return function(e){if(Array.isArray(e))return Io(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Po(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function So(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||Po(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Po(e,t){if(e){if("string"==typeof e)return Io(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Io(e,t):void 0}}function Io(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Co=wp.data,Ao=Co.dispatch,Do=Co.select,Ro=wp.element,To=(Ro.createElement,Ro.render,Ro.useState),Mo=Ro.useEffect,Uo=Ro.Fragment,$o=Ro.useContext,Lo=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",Fo=function(e){var t=$o(l),n=So(To([]),2),r=n[0],a=n[1],i=So(To(e.card),2),o=(i[0],i[1],So(To(!1),2)),s=o[0],c=o[1],d=So(To({post_content:e.card.description,raw:e.card.raw}),2),p=d[0],u=d[1],m=So(To(!1),2),f=m[0],b=m[1],v=So(To([]),2),w=v[0],h=v[1];Mo((function(){if(window.vibeprojects.settings.hasOwnProperty("additional_fields")&&window.vibeprojects.settings.additional_fields.create_card_fields){var t,n=xo(window.vibeprojects.settings.additional_fields.create_card_fields);null!==(t=e.card.meta)&&void 0!==t&&t.length&&h(e.card.meta),a(n)}}),[e.card]);var y=function(e,t){var n=e.field;if(w.findIndex((function(e){return e.meta_key==n.id}))>-1){var r=xo(w);r[w.findIndex((function(e){return e.meta_key==n.id}))].meta_value=n.value,h(r)}};return wp.element.createElement("div",{className:"card_description_fields"},wp.element.createElement("h4",null,window.vibeprojects.translations.description,H("create_card")?wp.element.createElement("span",{className:s?"vicon vicon-close":"vicon vicon-pencil",onClick:function(){return c(!s)}}):""),wp.element.createElement("div",{className:"card_description_wrapper"},s?wp.element.createElement("div",{className:"vibe_cards_description_fields"},wp.element.createElement(jo,{field:{type:"editor",id:"description",value:p.post_content,raw:p.raw},update:function(e,t){"fieldvaluechanged"==t&&u({raw:e.field.raw,post_content:e.field.value})}}),wp.element.createElement(Uo,null,r.length?r.map((function(e){return wp.element.createElement(jo,{field:e,update:y})})):""),wp.element.createElement("div",{className:"card_desc_action_buttons"},wp.element.createElement("a",{className:f?"button is-primary is-loading":"button is-primary",onClick:function(){b(!0),fetch("".concat(Lo,"/card/").concat(e.card.card_id,"/adddescription/"),{method:"post",body:JSON.stringify(ko(ko({},p),{},{meta:w,token:Do("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(n){if(b(!1),n.status){var r,a,i;if(c(!1),t.hasOwnProperty("board")&&null!==(r=t.board)&&void 0!==r&&null!==(a=r.cards)&&void 0!==a&&a.length){var o=xo(t.board.cards);if(o.findIndex((function(t){return t.card_id==e.card.card_id}))>-1){var l=o[o.findIndex((function(t){return t.card_id==e.card.card_id}))];l.description=p.post_content,l.raw=p.raw,w.map((function(e){e.meta_value&&l.meta.findIndex((function(t){return t.meta_key==e.meta_key}))>-1&&(l.meta[l.meta.findIndex((function(t){return t.meta_key==e.meta_key}))].meta_value=e.meta_value)})),o[o.findIndex((function(t){return t.card_id==e.card.card_id}))]=l,t.update("board",ko(ko({},t.board),{},{cards:o}))}}if(t.hasOwnProperty("tasks")&&null!==(i=t.tasks)&&void 0!==i&&i.length){var s=xo(t.tasks);if(s.findIndex((function(t){return t.card_id==e.card.card_id}))>-1){var d=s[s.findIndex((function(t){return t.card_id==e.card.card_id}))];d.description=p.post_content,d.raw=p.raw,w.map((function(e){e.meta_value&&d.meta.findIndex((function(t){return t.meta_key==e.meta_key}))>-1&&(d.meta[d.meta.findIndex((function(t){return t.meta_key==e.meta_key}))].meta_value=e.meta_value)})),s[s.findIndex((function(t){return t.card_id==e.card.card_id}))]=d,t.update("tasks",s)}}n.hasOwnProperty("message")&&Ao("vibebp").addNotification({text:data.message})}}))}},window.vibeprojects.translations.save_description),wp.element.createElement("a",{className:"link",onClick:function(){return c(!s)}},window.vibebp.translations.cancel))):wp.element.createElement("div",{className:"card_description"},wp.element.createElement("div",{className:"card_description_content",dangerouslySetInnerHTML:{__html:p.post_content}}),r.length?wp.element.createElement("div",{className:"additional_card_fields"},r.map((function(e){var t,n=w.findIndex((function(t){return t.meta_key==e.id}));return wp.element.createElement("div",{className:"card_field "+e.id},wp.element.createElement("span",null,e.label),wp.element.createElement("span",null,-1==n?"":Array.isArray(w[n].meta_value)?w[n].meta_value.map((function(e){return wp.element.createElement("span",null,e)})):null!==(t=e.options)&&void 0!==t&&t.length&&e.options.findIndex((function(e){return e.value==w[n].meta_value}))>-1?e.options[e.options.findIndex((function(e){return e.value==w[n].meta_value}))].label:w[n].meta_value))}))):"")))};function Jo(e){return function(e){if(Array.isArray(e))return Go(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Wo(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ho(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ho(Object(n),!0).forEach((function(t){Vo(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ho(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vo(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||Wo(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wo(e,t){if(e){if("string"==typeof e)return Go(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Go(e,t):void 0}}function Go(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var zo=wp.element,Xo=(zo.createElement,zo.render,zo.useState),Bo=zo.useEffect,Zo=(zo.Fragment,zo.useContext),Qo=(zo.useMemo,zo.useRef,wp.data),Ko=Qo.dispatch,el=Qo.select,tl=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",nl=function(e){var t=Zo(l),n=qo(Xo({}),2),r=n[0],a=n[1],i=qo(Xo(-1),2),o=i[0],s=i[1],c=qo(Xo({name:"",member:""}),2),d=c[0],p=c[1],u=qo(Xo(!1),2),m=(u[0],u[1],qo(Xo(e.checklist),2)),f=(m[0],m[1],qo(Xo(null),2)),b=f[0],v=f[1];Bo((function(){a(e.checklist)}),[e.checklist]);var w=function(n){b&&b.abort();var r={},a=new AbortController;b&&(r={signal:a.signal}),v(a),fetch("".concat(tl,"/card/").concat(e.card.card_id,"/addchecklist/?post"),Yo(Yo({},r),{},{method:"post",body:JSON.stringify({list:n,token:el("vibebp").getToken()})})).then((function(e){return e.json()})).then((function(r){if(v(null),r.status){var a,i,o,l=0;if(n.length){var s=0,c=0;n.map((function(e){var t;null!==(t=e.tasks)&&void 0!==t&&t.length&&(c+=e.tasks.length,s+=e.tasks.filter((function(e){return e.complete})).length)})),c||(c=1),l=Math.round(100*s/c,2)}if(null!==(a=t.board)&&void 0!==a&&null!==(i=a.cards)&&void 0!==i&&i.length&&t.board.cards.findIndex((function(t){return t.card_id==e.card.card_id}))>-1){var d=Jo(t.board.cards);d[d.findIndex((function(t){return t.card_id==e.card.card_id}))].progress=l,t.update("board",Yo(Yo({},t.board),{},{cards:d}))}if(null!==(o=t.tasks)&&void 0!==o&&o.length&&t.tasks.findIndex((function(t){return t.card_id==e.card.card_id}))>-1){var p=Jo(t.tasks);p[p.findIndex((function(t){return t.card_id==e.card.card_id}))].progress=l,t.update("tasks",p)}}Ko("vibebp").addNotification({text:r.message})}))},h=function(){var e=Jo(r);e[o].hasOwnProperty("tasks")||(e[o].tasks=[]),e[o].tasks.push(Yo(Yo({},d),{},{complete:0})),a(e),p({}),s(-1),w(e)};return r.length?wp.element.createElement("div",{className:"card_checklist"},r.map((function(t,n){var i=0;if(t.tasks&&t.tasks.length){var l=0;t.tasks.map((function(e,t){e.complete&&l++})),i=l/t.tasks.length*100}return wp.element.createElement("div",{className:"card_checklists_lists"},wp.element.createElement("div",{className:"card_checklist_name_wrapper"},wp.element.createElement("div",null,wp.element.createElement("span",{className:"vicon vicon-check-box"}),wp.element.createElement("h4",{dangerouslySetInnerHTML:{__html:t.name}})),H("add_card_checklists")?wp.element.createElement("a",{className:"delete_button",onClick:function(){var e,t;e=n,(t=Jo(r)).splice(e,1),a(t),w(t)},title:window.vibeprojects.translations.delete},wp.element.createElement("span",{className:"vicon vicon-trash"})):""),wp.element.createElement("div",{className:"card_checklist_progressbar_wrap"},wp.element.createElement("div",{className:"card_checklist_progressbar_wrapper"},wp.element.createElement("span",{className:"checklist_progressbar",style:{width:i+"%"}})),wp.element.createElement("span",null,Math.floor(i)+"%")),t.tasks&&t.tasks.length?wp.element.createElement("div",{className:"card_checklist_tasks_container"},t.tasks.map((function(e,t){return wp.element.createElement("div",{className:"checklist_task_list"},wp.element.createElement("div",{onClick:function(){!function(e,t,n){if(H("finish_card_checklists")){var i=Jo(r);i[e].tasks[t].complete=n,a(i),w(i)}}(n,t,!e.complete)}},e.complete?wp.element.createElement("span",{className:"vicon-check-box"}):wp.element.createElement("span",{className:"vicon vicon-layout-width-full"}),wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:e.name}}),window.vibeprojects.settings.hasOwnProperty("checklist_item_fields")?wp.element.createElement("div",{className:"checklist_item_fields_wrap"},window.vibeprojects.settings.checklist_item_fields.map((function(t){return wp.element.createElement("span",{className:"checklist_item_field"},wp.element.createElement("label",{dangerouslySetInnerHTML:{__html:t.label}}),e[t.key])}))):"",e.hasOwnProperty("member")&&e.member?wp.element.createElement(I,{type:"user",id:{user_id:e.member}}):""),wp.element.createElement("span",{className:"vicon vicon-close",onClick:function(){var e,i,o;e=n,i=t,(o=Jo(r))[e].tasks.splice(i,1),a(o),w(o)}}))}))):"",o>-1&&o==n?wp.element.createElement("div",{className:"new_task_from"},wp.element.createElement("textarea",{value:d.name,onChange:function(e){p(Yo(Yo({},d),{},{name:e.target.value}))},placeholder:window.vibeprojects.translations.description}),window.vibeprojects.settings.hasOwnProperty("checklist_item_fields")?wp.element.createElement("div",{className:"checklist_item_fields_wrap"},window.vibeprojects.settings.checklist_item_fields.map((function(e){return wp.element.createElement("span",{className:"checklist_item_field"},wp.element.createElement("label",{dangerouslySetInnerHTML:{__html:e.label}}),wp.element.createElement("input",{type:e.type,placeholder:e.label,onChange:function(t){var n=Yo({},d);n[e.key]=t.target.value,p(n)}}))}))):"",e.members.length?wp.element.createElement("select",{value:d.member,onChange:function(e){return p(Yo(Yo({},d),{},{member:e.target.value}))}},wp.element.createElement("option",null,window.vibeprojects.translations.add_member),e.members.map((function(e){return wp.element.createElement("option",{value:e.id},e.label)}))):"",wp.element.createElement("a",{className:"add_task button",onClick:h},window.vibeprojects.translations.add_new_task),wp.element.createElement("a",{className:"vicon vicon-close",onClick:function(){s(-1)}})):wp.element.createElement("a",{className:"add_new_task button",onClick:function(){s(n)}},window.vibeprojects.translations.add_task))}))):""};function rl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return al(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return al(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function al(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var il=wp.element,ol=(il.createElement,il.render,il.useState),ll=il.useEffect,sl=(il.Fragment,il.useContext),cl=wp.data,dl=cl.select,pl=(cl.dispatch,window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/"),ul=function(e){sl(l);var t=rl(ol(!1),2),n=t[0],r=t[1],a=rl(ol([]),2),i=a[0],o=a[1];return ll((function(){r(!0),fetch("".concat(pl,"/card/").concat(e.card.card_id,"/watchers?post"),{method:"post",body:JSON.stringify({token:dl("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){r(!1),e.status&&o(e.members)}))}),[]),wp.element.createElement("div",{className:"project_content_tab"},n?wp.element.createElement("div",{class:"lds-ellipsis"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):i.length?wp.element.createElement("div",{className:"card_watchers"},wp.element.createElement(C,{user_ids:i,type:"user"},i.map((function(e){return wp.element.createElement(I,{id:{user_id:e},type:"member"})})))):wp.element.createElement("div",{className:"vbp_message"},wp.element.createElement("p",null,window.vibeprojects.translations.no_watchers)))};const{createElement:ml,useState:fl,useEffect:bl,useRef:vl,Fragment:wl,render:hl}=wp.element,{dispatch:yl,select:gl}=wp.data,_l=Math.round(100*Math.random());var El=e=>{const t=vl(null),n=React.createRef(),[r,a]=fl(!0),[i,o]=fl(!1),[l,s]=fl(!1),[c,d]=fl(""),[p,u]=fl(""),[m,f]=fl(""),[b,v]=fl(""),[w,h]=fl({x:0,y:0,width:0,height:0,type:"image"}),[y,g]=fl(window.vibebp.translations.select_image);bl(()=>{e.hasOwnProperty("crop")&&e.crop&&o(!0)},[]),bl(()=>{e.file&&(d(window.URL.createObjectURL(e.file)),a(!1),v([e.file]))},[e.file]),bl(()=>{if(l&&i){let t=n.current;new Croppr(t,{aspectRatio:1,returnMode:"raw",maxSize:[460,460,"px"],minSize:[150,150,"px"],onCropEnd:function(t){let n={...w};n.x=t.x,n.y=t.y,n.height=t.height,n.width=t.width,h(n);let r={x:t.x,y:t.y,width:t.width,height:t.height};e.update(b,r)}})}},[l]);return React.createElement("div",{className:"uploader"},r?React.createElement("label",{for:"fileupload_"+_l,className:"upload_file"},y,"image"==e.type?React.createElement("input",{id:"fileupload_"+_l,"data-type":e.type,ref:t,type:"file",accept:"image/*",onChange:n=>{t.current.files[0].size<window.vibebp.settings.upload_limit?(d(window.URL.createObjectURL(t.current.files[0])),a(!1),v(t.current.files),e.update(t.current.files,{...w,key:"image"})):(g(window.vibebp.translations.image_size_error),setTimeout(()=>{g(window.vibebp.translations.select_image)},3500))}}):"video"==e.type?React.createElement("input",{id:"fileupload_"+_l,"data-type":e.type,ref:t,type:"file",accept:"video/*",onChange:n=>{t.current.files[0].size<window.vibebp.settings.upload_limit?(u(window.URL.createObjectURL(t.current.files[0])),a(!1),v(t.current.files),e.update(t.current.files,{...w,key:"video"})):(g(window.vibebp.translations.image_size_error),setTimeout(()=>{g(window.vibebp.translations.select_image)},3500))}}):React.createElement("input",{id:"fileupload_"+_l,"data-type":e.type,ref:t,type:"file",onChange:n=>{t.current.files[0].size<window.vibebp.settings.upload_limit?(f(window.URL.createObjectURL(t.current.files[0])),a(!1),v(t.current.files),e.update(t.current.files,{...w,key:"attachment"})):(g(window.vibebp.translations.image_size_error),setTimeout(()=>{g(window.vibebp.translations.select_image)},3500))}})):React.createElement("div",{className:"uploaded_src"},"image"==e.type?React.createElement(wl,null,i?React.createElement(wl,null,React.createElement("div",{className:"uploaded_image"},React.createElement("img",{src:c})),React.createElement("span",null,React.createElement("span",{className:"vicon vicon-pencil",onClick:()=>{s(!l)}}),React.createElement("span",{className:"vicon vicon-close",onClick:()=>{o(!1),a(!0),setImgRef(""),d(""),h({x:0,y:0,width:0,height:0})}})),l?React.createElement("div",{className:"cropimage",id:"cropper"},React.createElement("img",{src:c,ref:n})):""):React.createElement("img",{src:c})):"video"==e.type?React.createElement(wl,null,React.createElement("video",{className:"content_to_html_video",ref:e=>{e&&new Plyr(e)}},React.createElement("source",{src:p,type:"video/mp4"}))):React.createElement(wl,null,React.createElement("i",{className:"vicon vicon-clip"}))))};var jl=({children:e,onClose:t,open:n})=>n?ReactDOM.createPortal(React.createElement("div",{className:"vibe_editor_modal react_portal_modal"},React.createElement("span",{onClick:t}),React.createElement("div",{className:"ve_modal-content"},React.createElement("div",{className:"ve_modal-header"},React.createElement("div",null),React.createElement("span",{className:"vicon vicon-close",onClick:t})),React.createElement("div",{className:"ve_modal-body"},e))),document.body):null;const{createElement:Ol,useRef:kl,useEffect:Nl,Fragment:xl,render:Sl}=wp.element,Pl=(e,t,n=[])=>{const r=kl(Date.now());Nl(()=>{const n=setTimeout((function(){Date.now()-r.current>=t&&(e(),r.current=Date.now())}),t-(Date.now()-r.current));return()=>{clearTimeout(n)}},[t,...n])};const{createElement:Il,useState:Cl,useEffect:Al,Fragment:Dl,render:Rl}=wp.element,{dispatch:Tl,select:Ml}=wp.data;var Ul=e=>{const[t,n]=Cl(!1),[r,a]=Cl(!1),[i,o]=Cl({s:"",page:1}),[l,s]=Cl([]),[c,d]=Cl(0);return Pl(()=>{console.log(i),n(!0);let e=`${window.vibebp.settings.giphy.endpoints.trending}?api_key=${window.vibebp.settings.giphy.api_key}&limit=10&offset=${l.length}`;i.s.length>2&&(e=`${window.vibebp.settings.giphy.endpoints.search}?api_key=${window.vibebp.settings.giphy.api_key}&q=${i.s}&limit=10&offset=${10*(i.page-1)}`),fetch(e,{method:"get"}).then(e=>e.json()).then(e=>{if(e.data&&e.data.length){n(!1);let t=[];r?t=[...l,...e.data]:(s([]),t=e.data),s(t),d(e.pagination.total_count),a(!1)}})},500,[i]),React.createElement("div",{className:"gif_wrap"},React.createElement("div",{className:"input_field_wrapper"},React.createElement("input",{type:"text",placeholder:window.vibebp.translations.search_gif,onChange:e=>{o({...i,s:e.target.value,page:1})}}),React.createElement("span",{className:"vicon vicon-search"})),React.createElement("div",{className:"gif_wrapper"},l.length?l.map((t,n)=>React.createElement("img",{src:t.images.preview_gif.url,alt:t.title,title:t.title,onClick:()=>{e.update("add",t)}})):""),!t&&c>l.length?React.createElement("a",{className:"link",onClick:()=>{a(!0),o({...i,page:i.page+1})}},window.vibebp.translations.load_more):React.createElement("div",{class:"lds-ellipsis"},React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null)))};const{createElement:$l,useState:Ll,useEffect:Fl,Fragment:Jl,render:Hl}=wp.element,{dispatch:Yl,select:Vl}=wp.data;var ql=e=>{const[t,n]=Ll(!1),[r,a]=Ll([]),[i,o]=Ll([]),[l,s]=Ll(""),[c,d]=Ll([]),[p,u]=Ll({content:"",component:"activity",component_id:"",parent_id:"",meta:[]}),[m,f]=Ll(!1);Fl(()=>{if(e.hasOwnProperty("activity_id")&&u({content:"",component:"activity_comment",component_id:e.comment_id,parent_id:e.activity_id,meta:[]}),e.hasOwnProperty("component")&&"personal"!=e.component){let t={...p,component:e.component,component_id:e.id};e.hasOwnProperty("secondary_item_id")&&(t.secondary_item_id=e.secondary_item_id),u(t)}e.hasOwnProperty("component")&&"personal"==e.component&&u({...p,type:null}),e.hasOwnProperty("component")&&"public"==e.component&&u({...p,type:e.component})},[e.component]),Fl(()=>{p.component.length&&"activity"!==p.component&&"activity_comment"!==p.component&&fetch(`${window.vibebp.api.url}/${p.component}/user/${Vl("vibebp").getUser().id}/get_items`,{method:"post",body:JSON.stringify({token:Vl("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.status&&Array.isArray(e[p.component])&&a(e[p.component])})},[p.component]);const b=e=>{let t=[...i];t.push(e),o(t)};return React.createElement("div",{className:"portal activity_post"},React.createElement("div",{className:"portal_body"},React.createElement("textarea",{placeholder:e.hasOwnProperty("is_child")?window.vibebp.translations.add_comment:window.vibebp.translations.whats_new,onChange:e=>{let t={...p};t.content=e.target.value,u(t)},value:p.content})),React.createElement("div",{className:"portal_footer"},e.hasOwnProperty("activity_id")||"personal"!==e.component||e.hasOwnProperty("component")&&"public"==e.component?"":React.createElement("div",{className:"footer_main"},React.createElement("select",{value:p.component,onChange:e=>{let t={...p};t.component=e.target.value,u(t)}},Object.keys(window.vibebp.components.activity.post.components).map(e=>React.createElement("option",{value:e},window.vibebp.components.activity.post.components[e]))),r.length?React.createElement("select",{value:p.component_id,onChange:e=>{let t={...p};t.component_id=e.target.value,u(t)}},React.createElement("option",null,window.vibebp.translations.select_component),r.map(e=>React.createElement("option",{value:e.id},e.label))):""),React.createElement("div",{className:"footer_links"},c.length?React.createElement("div",{className:"media_wrap"},c.map((e,t)=>React.createElement("div",{className:"media_file"},React.createElement("span",{className:"viocn vicon-close",onClick:()=>{let e=[...c];e.splice(t,1),d(e)}}),(e=>{switch(e.type){case"image":return React.createElement("img",{src:e.url});case"video":return React.createElement("video",{src:e.url})}})(e)))):"",i.length?i.map((e,t)=>React.createElement(Jl,null,"image"==e?React.createElement("a",{className:"vicon vicon-image upload_type"}):"video"==e?React.createElement("a",{className:"vicon vicon-video-camera upload_type"}):React.createElement("a",{className:"vicon vicon-clip upload_type"}),React.createElement(El,{file:l[t],type:e,update:(n,r)=>{let a=[...l];a[t]=new File([n[0]],n[0].name),s(a),u({...p,meta:[...p.meta,{key:e,value:t}]})}}),React.createElement("a",{className:"vicon vicon-close",onClick:()=>{let e=[...l];e.splice(t,1),s(e);let n={...p},r=n.meta.findIndex(e=>e.value===t);console.log(r),n.meta.splice(r,1),u(n);let a=[...i];a.splice(t,1),o(a)}}))):"",React.createElement(Jl,null,React.createElement("a",{className:"vicon vicon-clip",onClick:()=>{b("attachment")}}),React.createElement("a",{className:"vicon vicon-video-camera",onClick:()=>{b("video")}}),React.createElement("a",{className:"vicon vicon-image",onClick:()=>{b("image")}}),window.vibebp.settings.giphy.api_key&&window.vibebp.settings.giphy.api_key.length?React.createElement("a",{className:"",onClick:()=>{f(!m)}},React.createElement("svg",{width:"15px",height:"15px",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},React.createElement("path",{d:"M2.5 10.5H2V11H2.5V10.5ZM4.5 10.5V11H5V10.5H4.5ZM13.5 3.5H14V3.29289L13.8536 3.14645L13.5 3.5ZM10.5 0.5L10.8536 0.146447L10.7071 0H10.5V0.5ZM2 6V10.5H3V6H2ZM2.5 11H4.5V10H2.5V11ZM5 10.5V8.5H4V10.5H5ZM3 7H5V6H3V7ZM2 5V1.5H1V5H2ZM13 3.5V5H14V3.5H13ZM2.5 1H10.5V0H2.5V1ZM10.1464 0.853553L13.1464 3.85355L13.8536 3.14645L10.8536 0.146447L10.1464 0.853553ZM2 1.5C2 1.22386 2.22386 1 2.5 1V0C1.67157 0 1 0.671573 1 1.5H2ZM1 12V13.5H2V12H1ZM2.5 15H12.5V14H2.5V15ZM14 13.5V12H13V13.5H14ZM12.5 15C13.3284 15 14 14.3284 14 13.5H13C13 13.7761 12.7761 14 12.5 14V15ZM1 13.5C1 14.3284 1.67157 15 2.5 15V14C2.22386 14 2 13.7761 2 13.5H1ZM6 7H9V6H6V7ZM6 11H9V10H6V11ZM7 6.5V10.5H8V6.5H7ZM10.5 7H13V6H10.5V7ZM10 6V11H11V6H10ZM10.5 9H12V8H10.5V9Z",fill:"var(--text)"}))):""),React.createElement("a",{className:t?"button is-primary is-loading":"button is-primary",onClick:()=>{if(!p.content.length)return;var t=new FormData;let r={...p};e.hasOwnProperty("media")&&void 0!==e.media&&e.media.hasOwnProperty("url")?(r.meta_key=e.media.url,r.component="activity_comment",r.parent_id=e.media.activity.id):Vl("vibebp").getData("wallUserId")&&(r.wallUserId=Vl("vibebp").getData("wallUserId")),p.hasOwnProperty("type")&&"public"===p.type&&!r.wallUserId&&(r.wallUserId=Vl("vibebp").getUser().id),t.append("body",JSON.stringify({args:r,medias:c,token:Vl("vibebp").getToken()})),l.length&&l.map((e,n)=>{t.append("files_"+n,e)}),n(!0),fetch(`${window.vibebp.api.url}/${window.vibebp.api.endpoints.activity}/add?upload`,{method:"post",body:t}).then(e=>e.json()).then(t=>{t.status&&(console.log(p),e.update(t.activity,"add"),u({component:"activity",component_id:"",parent_id:"",meta:[],content:"",meta:[]}),s([]),n(!1),Yl("vibebp").addNotification({text:t.activity.action}))})}},e.hasOwnProperty("is_child")?window.vibebp.translations.post:window.vibebp.translations.post_update),e.hasOwnProperty("activity_id")?React.createElement("a",{className:"link",onClick:()=>{e.update("","cancel")}},window.vibebp.translations.cancel):"")),React.createElement(jl,{open:m,onClose:()=>f(!1)},React.createElement(Ul,{update:(e,t)=>{if("add"==e){let e=t.images.original.url,n=[...c];n.push({type:"image",url:e}),d(n),f(!1)}}})))};const{createElement:Wl,useState:Gl,useEffect:zl,Fragment:Xl,render:Bl}=wp.element;var Zl=e=>{const[t,n]=Gl(""),[r,a]=Gl({s:0,m:0,h:0,d:0,w:0,mn:0,y:0});zl(()=>{i()},[e.time]);const i=()=>{let t={s:0,m:0,h:0,d:0,mn:0,y:0},n=Math.floor(((new Date).getTime()-function(e){const t=Date.parse(e);return isNaN(t)?"string"==typeof e?Date.parse(e.replace(/-/g,"/").replace(/[a-z]+/gi," ")):e:t}(e.time)+6e4*(new Date).getTimezoneOffset())/1e3);n>31536e3&&(t.y=Math.floor(n/31536e3),n-=86400*t.y*365),n>2592e3&&(t.mn=Math.floor(n/2592e3),n-=86400*t.mn*30),n>604800&&(t.w=Math.floor(n/604800),n-=86400*t.w*7),n>86400&&(t.d=Math.floor(n/86400),n-=86400*t.d),n>3600&&(t.h=Math.floor(n/3600),n-=3600*t.h),n>60&&(t.m=Math.floor(n/60),n-=60*t.m),t.s=n,a(t)};return React.createElement("div",{className:"datetime"},r.y||r.mn||r.w||r.d||r.h||r.m?"":window.vibebp.translations.justnow,r.y?React.createElement("span",{className:"years"},r.y," ",r.y>1?window.vibebp.translations.years:window.vibebp.translations.year):"",r.mn?React.createElement("span",{className:"months"},r.mn," ",r.mn>1?window.vibebp.translations.months:window.vibebp.translations.month):"",r.w?React.createElement("span",{className:"weeks"},r.w," ",r.w>1?window.vibebp.translations.weeks:window.vibebp.translations.week):"",r.d?React.createElement("span",{className:"days"},r.d," ",r.d>1?window.vibebp.translations.days:window.vibebp.translations.day):"",r.h?React.createElement("span",{className:"hours"},r.h," ",r.h>1?window.vibebp.translations.hours:window.vibebp.translations.hour):"",r.m?React.createElement("span",{className:"minutes"},r.m," ",r.m>1?window.vibebp.translations.minutes:window.vibebp.translations.minute):"")};const{createElement:Ql,useState:Kl,useEffect:es,Fragment:ts,render:ns}=wp.element,{dispatch:rs,select:as}=wp.data;var is=e=>{const[t,n]=Kl({}),[r,a]=Kl([]),[i,o]=Kl([]);es(()=>{n(e.reactions),o("all")},[e.reactions]),es(()=>{"all"==i?l():a(t[i])},[i]);const l=()=>{let t=[];Object.keys(e.reactions).map(n=>{t=[...t,...e.reactions[n]]}),a(t)};return t&&Object.keys(t).length?React.createElement("div",{className:"rec-overviews"},React.createElement("div",{className:"tabs"},React.createElement("div",{className:"tab "+("all"===i?"active":""),onClick:()=>{o("all")}},window.vibebp.translations.all),Object.keys(t).map(e=>React.createElement("div",{className:"tab "+(i===e?"active":""),onClick:()=>{o(e)}},React.createElement("img",{src:window.vibebp.settings.reactions[e].icon}),React.createElement("span",null,t[e].length)))),r&&r.length?React.createElement("div",{className:"users"},React.createElement(C,{user_ids:r},r.map(e=>React.createElement(I,{type:"member",id:{user_id:e}})))):""):""};const{createElement:os,useState:ls,useEffect:ss,Fragment:cs,render:ds}=wp.element,{dispatch:ps,select:us}=wp.data;var ms=e=>{const[t,n]=ls([]),[r,a]=ls({search:"",page:1}),[i,o]=ls(!1),[l,s]=ls(!0),[c,d]=ls(null),[p,u]=ls(!1);ss(()=>{e.hasOwnProperty("media")&&a({...r,meta_key:e.media.url})},[e.type]);const m=()=>{a({...r,page:1})};ss(()=>(document.addEventListener("vibebp_component_reload",m),()=>{document.removeEventListener("vibebp_component_reload",m)})),Pl(()=>{if(Object.keys(r).length){let e={...r};e.token=us("vibebp").getToken(),c&&c.abort();let a={},i=new AbortController;c&&(a={signal:i.signal}),d(i),s(!0),fetch(`${window.vibebp.api.url}/${window.vibebp.api.endpoints.activity}?args=${r.search.length?"nocache":encodeURIComponent(JSON.stringify({...r,search:""}))}&force`,{method:"post",...a,headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify(e)}).then(e=>e.json()).then(e=>{if(s(!1),e.status){let r=[];p?(r=[...t],e.data.activities.map(e=>{r.push(e)}),u(!1)):r=e.data.activities,n(r),o(e.data.has_more_items)}else e.hasOwnProperty("message")&&ps("vibebp").addNotification({text:e.message})})}},500,[r]);const f=(e,a)=>{let i=[...t],o=`${window.vibebp.api.url}/${window.vibebp.api.endpoints.activity}?args=${encodeURIComponent(JSON.stringify({...r,search:""}))}`;if("remove"===a||"remove-favorite"==a&&"activity-favs"==r.filter){let a=[...t],i=a.findIndex(t=>t.id===e.id);if(-1!==i&&(console.log(i),a.splice(i,1),n(a),!r.search.length)){window.vibebp.api.url,window.vibebp.api.endpoints.activity,encodeURIComponent(JSON.stringify({...r,search:""}));localforage.getItem(o).then(e=>{let t=JSON.parse(e);t.data.activities=a,localforage.setItem(o,JSON.stringify(t))})}}"update"==a&&(i[i.findIndex(t=>t.id==e.id)]=e,r.search.length||localforage.getItem(o).then(e=>{let t=JSON.parse(e);t.data.activities=i,localforage.setItem(o,JSON.stringify(t))}))};let b=[...t];return r.hasOwnProperty("search")&&r.search.length&&(b=t.filter(e=>e.action.indexOf(r.search)>-1||e.content.indexOf(r.search)>-1)),r.hasOwnProperty("sorter")&&r.sorter.length&&(b=t.filter(e=>e.type==r.sorter>-1)),React.createElement("div",{className:"media_popup"},React.createElement("div",{className:"left_side"},(()=>{let t=e.media.type,n=e.media.url;return"image"==t?React.createElement("img",{src:n,className:"activity_meta image"}):"video"==t?React.createElement("div",{className:"video_wrapper"},React.createElement("video",{className:"activity_meta video",ref:e=>{e&&new Plyr(e)}},React.createElement("source",{src:n,type:"video/mp4"}))):"audio"==t?React.createElement("audio",{className:"activity_meta audio",ref:e=>{e&&new Plyr(e)}},React.createElement("source",{src:n,type:"audio/mp3"})):"attachment"==t?React.createElement("a",{href:n,target:"_blank",className:"vicon vicon-clip activity_meta"}):void 0})()),React.createElement("div",{className:"right_side"},React.createElement("div",{className:"vibebp_main"},e.canpost?React.createElement(ql,{component:e.type,id:e.id,update:(e,a)=>{let i=[...t],o=`${window.vibebp.api.url}/${window.vibebp.api.endpoints.activity}?args=${encodeURIComponent(JSON.stringify({...r,search:""}))}`;"add"===a&&(i.unshift(e),n(i),r.search.length||localforage.getItem(o).then(e=>{let t=JSON.parse(e);t.data.activities=i,localforage.setItem(o,JSON.stringify(t))})),"update"==a&&(i[i.findIndex(t=>t.id==e.id)]=e,r.search.length||localforage.getItem(o).then(e=>{let t=JSON.parse(e);t.data.activities=i,localforage.setItem(o,JSON.stringify(t))}))},is_child:!0,media:e.media}):"",React.createElement("div",{className:"portal"},React.createElement("div",{className:"portal_body"},l&&!b.length?React.createElement("div",{class:"loading-roller"},React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null)):"",b.length?React.createElement("div",{className:"activity_list"},b.map(t=>React.createElement(Is,{activity:t,rootActivityId:t.id,update:f,media:e.media}))):l?"":React.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_activity_found),l&&b.length?React.createElement("div",{class:"loading-roller"},React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null)):"",i?React.createElement("a",{className:"link",onClick:()=>{let e={...r};e.page=r.page+1,u(!0),a(e)}},window.vibebp.translations.more):"")))))};const{createElement:fs,useState:bs,useEffect:vs,Fragment:ws,render:hs}=wp.element,{dispatch:ys,select:gs}=wp.data;var _s=e=>{const[t,n]=bs(!1);vs(()=>{},[e.activity]);const r=t=>{fetch(`${window.vibebp.api.url}/${window.vibebp.api.endpoints.activity}/report?post`,{method:"post",body:JSON.stringify({activity:e.activity,token:gs("vibebp").getToken(),type:t})}).then(e=>e.json()).then(t=>{t.status&&(e.update(e.activity),ys("vibebp").addNotification({text:t.message}))})};return t?React.createElement(ws,null,React.createElement("span",{className:"vicon vicon-arrow-left",onClick:()=>{n(!1)}}),React.createElement("div",{className:"reporting_wrap"},React.createElement("h3",null,window.vibebp.translations.report_post),React.createElement("div",{className:"spam",onClick:()=>{r("spam")}},React.createElement("span",{className:"vicon vicon-alert"}),window.vibebp.translations.its_spam),React.createElement("div",{className:"inapproporiate",onClick:()=>{r("inappropriate")}},React.createElement("span",{className:"vicon vicon-alert"}),window.vibebp.translations.its_inappropriate))):React.createElement("div",{className:"reporting_wrap"},React.createElement("h3",null,window.vibebp.translations.post_actions),React.createElement("div",{className:"hide_post",onClick:()=>{r("hide")}},React.createElement("span",{className:"vicon vicon-close"}),window.vibebp.translations.hide_post),React.createElement("div",{className:"report_post",onClick:()=>{n(!0)}},React.createElement("span",{className:"vicon vicon-alert"}),window.vibebp.translations.report_post))};const{createElement:Es,useState:js,useEffect:Os,Fragment:ks,render:Ns}=wp.element,{dispatch:xs,select:Ss}=wp.data,Ps=e=>{const[t,n]=js({}),[r,a]=js(!1),[i,o]=js(!1),[l,s]=js([]),[c,d]=js(!1),[p,u]=js(!1),[m,f]=js(!1);Os(()=>{n(e.activity),localforage.getItem("favorite_activities_"+Ss("vibebp").getUser().id).then(e=>{e&&(e=JSON.parse(e),o(e))}),localforage.getItem("liked_activities_"+Ss("vibebp").getUser().id).then(e=>{e&&(e=JSON.parse(e),s(e))})},[e.activity]);const b=(r,i)=>{let o={...t};if("add"===i&&(o.children?o.children[Object.keys(o.children).length]=r:("object"==typeof o.children&&null!==o.children||(o.children={}),o.children[0]=r),a(!1),n(o)),"remove"===i){let e=Object.keys(o.children).findIndex(e=>o.children[e].id===r.id);-1!==e&&(delete o.children[e],n(o))}if("update"===i){let t=Object.keys(o.children).findIndex(e=>o.children[e].id===r.id);-1!==t&&(o.children[t]=r,n(o),e.update(o,"update"))}"cancel"===i&&a(!1)};let v="activity_item "+t.type+" "+t.component;return t.hasOwnProperty("content")&&t.content.length&&(v+=" with_activity_content"),React.createElement("div",{className:v,"data-activity-id":t.id},React.createElement("div",{className:"activity_avatar"},React.createElement("img",{src:t.avatar})),React.createElement("div",{className:"activity_body"},React.createElement("div",{className:"activity_header"},React.createElement("span",{dangerouslySetInnerHTML:{__html:t.action}}),React.createElement("span",{className:"vicon vicon-more",onClick:()=>{f(!0)}})),t.hasOwnProperty("content")&&t.content.length?React.createElement("div",{className:"activity_content"},React.createElement("span",{dangerouslySetInnerHTML:{__html:t.content}}),React.createElement("div",{className:"activity_attachments"},t.hasOwnProperty("meta")&&Object.keys(t.meta).length?Object.keys(t.meta).map(e=>React.createElement(ks,null,t.meta[e].map(n=>{if(n&&n.length>3)return React.createElement("div",{className:"media_file",onClick:()=>{d({type:e,url:n,activity:t})}},((e,t)=>"image"==e?React.createElement("img",{src:t,className:"activity_meta image"}):"video"==e?React.createElement("div",{className:"video_wrapper"},React.createElement("video",{className:"activity_meta video",ref:e=>{e&&new Plyr(e)}},React.createElement("source",{src:t,type:"video/mp4"}))):"audio"==e?React.createElement("audio",{className:"activity_meta audio",ref:e=>{e&&new Plyr(e)}},React.createElement("source",{src:t,type:"audio/mp3"})):"attachment"==e?React.createElement("a",{href:t,target:"_blank",className:"vicon vicon-clip activity_meta"}):void 0)(e,n))}))):"")):"",React.createElement(Zl,{time:t.date_recorded}),e.hasOwnProperty("noedit")?"":React.createElement(ks,null,window.vibebp.settings.enable_reactions&&t.hasOwnProperty("reactions")&&t.reactions&&Object.keys(t.reactions).length?React.createElement("div",{className:"reactions-overview",onClick:()=>{u(t.reactions)}},(e=>{let t=0,n=[];return Object.keys(e.reactions).map(r=>{t+=e.reactions[r].length,n.push(React.createElement("img",{src:window.vibebp.settings.reactions[r].icon}))}),n.push(React.createElement("span",{className:"count"},t)),n})(t)):"",Ss("vibebp").getData("activityPostPermissions")?React.createElement("div",{className:"activity_actions"},window.vibebp.settings.enable_reactions?React.createElement("div",{className:"reactions-container"},React.createElement("div",{className:"my-reaction"},t.my_reaction&&t.my_reaction.length?React.createElement("img",{src:window.vibebp.settings.reactions[t.my_reaction].icon}):React.createElement("strong",{className:"vicon vicon-thumb-up"})),React.createElement("div",{className:"reactions"},window.vibebp.settings.reactions&&Object.keys(window.vibebp.settings.reactions).length?Object.keys(window.vibebp.settings.reactions).map((e,r)=>React.createElement("div",{className:"reaction",onClick:()=>{((e,r)=>{let a={...t};if(!Ss("vibebp").getToken()||!Ss("vibebp").getToken().length)return document.dispatchEvent(new Event("vibebp_show_login_popup")),!1;let i=0;a.hasOwnProperty("reactions")||(a.reactions={}),a.reactions.hasOwnProperty(e)||(a.reactions[e]=[]),a.hasOwnProperty("my_reaction")&&a.my_reaction?(i=a.my_reaction,a.my_reaction===e?(delete a.my_reaction,a.reactions[e].splice(a.reactions[e].findIndex(e=>e===Ss("vibebp").getUser().id),1)):(a.my_reaction=e,a.reactions[e].push(Ss("vibebp").getUser().id)),a.reactions[i].splice(a.reactions[i].findIndex(e=>e===Ss("vibebp").getUser().id),1),a.reactions[i].length<1&&delete a.reactions[i]):(a.my_reaction=e,a.reactions[e].push(Ss("vibebp").getUser().id)),n(a),fetch(`${window.vibebp.api.url}/${window.vibebp.api.endpoints.activity}/reaction?post`,{method:"post",body:JSON.stringify({activity:a,old:i,token:Ss("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.hasOwnProperty("message")&&xs("vibebp").addNotification({text:e.message})})})(e)}},React.createElement("img",{src:window.vibebp.settings.reactions[e].icon}),React.createElement("span",{className:"label"},window.vibebp.settings.reactions[e].label))):"")):window.vibebp.settings.likes?React.createElement("a",{className:-1===l.indexOf(t.id)?"vicon vicon-thumb-up":"vicon vicon-thumb-up filled",onClick:()=>{let n=[],r=-1;l&&(n=[...l],r=l.indexOf(t.id));let a="add-like";-1===r?n.push(t.id):(a="remove-like",e.update(t,"remove-like"),n.splice(r,1)),fetch(`${window.vibebp.api.url}/${window.vibebp.api.endpoints.activity}/${a}?post`,{method:"post",headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify({activity_id:t.id,token:Ss("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.hasOwnProperty("message")&&xs("vibebp").addNotification({text:e.message}),localforage.setItem("liked_activities_"+Ss("vibebp").getUser().id,JSON.stringify(n))}),s(n)}}):"",React.createElement("a",{className:t.hasOwnProperty("children")&&t.children?"vicon vicon-comment-alt":"vicon vicon-comment",onClick:()=>{a(!r)}}),React.createElement("a",{className:i&&-1!==i.indexOf(t.id)?"vicon vicon-star filled":"vicon vicon-star",onClick:()=>{if(!Ss("vibebp").getToken()||!Ss("vibebp").getToken().length)return document.dispatchEvent(new Event("vibebp_show_login_popup")),!1;let n=[],r=-1;i&&(n=[...i],r=i.indexOf(t.id));let a="add-favorite";-1===r?n.push(t.id):(a="remove-favorite",e.update(t,"remove-favorite"),n.splice(r,1)),fetch(`${window.vibebp.api.url}/${window.vibebp.api.endpoints.activity}/${a}`,{method:"post",body:JSON.stringify({activity_id:t.id,token:Ss("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.hasOwnProperty("message")&&xs("vibebp").addNotification({text:e.message}),localforage.setItem("favorite_activities_"+Ss("vibebp").getUser().id,JSON.stringify(n)),o(n)})}}),t.hasOwnProperty("user_id")&&parseInt(t.user_id)===parseInt(Ss("vibebp").getUser().id)?React.createElement("a",{className:"vicon vicon-trash",onClick:()=>{fetch(`${window.vibebp.api.url}/${window.vibebp.api.endpoints.activity}/remove?post`,{method:"post",body:JSON.stringify({activity_id:t.id,parent_id:e.rootActivityId,token:Ss("vibebp").getToken()})}).then(e=>e.json()).then(n=>{n.hasOwnProperty("message")&&xs("vibebp").addNotification({text:n.message}),e.update(t,"remove")})}}):""):"",r?React.createElement(ql,{activity_id:e.rootActivityId,update:b,comment_id:t.id,media:e.media,is_child:!0}):""),t.hasOwnProperty("children")&&t.children?React.createElement("div",{class:"activity_list"},Object.keys(t.children).map(n=>React.createElement(Ps,{activity:t.children[n],rootActivityId:e.rootActivityId,update:b,media:e.media}))):""),React.createElement(jl,{open:c,onClose:()=>d(!1)},React.createElement(ms,{media:c,type:t.type,canpost:Ss("vibebp").getData("activityPostPermissions")})),React.createElement(jl,{open:p,onClose:()=>u(!1)},React.createElement(is,{reactions:p})),React.createElement(jl,{open:m,onClose:()=>f(!1)},React.createElement(_s,{activity:t,update:t=>{console.log(t),e.update(t,"remove"),f(!1)}})))};var Is=Ps;const{createElement:Cs,useState:As,useEffect:Ds,Fragment:Rs,render:Ts}=wp.element,{dispatch:Ms,select:Us}=wp.data;var $s=e=>{const[t,n]=As([]),[r,a]=As({}),[i,o]=As(!1),[l,s]=As(!0),[c,d]=As(null),[p,u]=As(!1),[m,f]=As([]),[b,v]=As(!1);Ds(()=>{let t={search:"",sorter:"",page:1};"personal"===e.type&&(t.filter="just-me"),"public"===e.type&&(t.filter="public"),e.hasOwnProperty("user_id")&&(t.user_id=e.user_id),e.hasOwnProperty("id")&&(t.id=e.id),"groups"===e.type&&(t.filter="groups"),"course"===e.type&&(t.filter="course"),e.hasOwnProperty("filter")&&(t.filter=e.filter),e.hasOwnProperty("secondary_item_id")&&(t.secondary_item_id=e.secondary_item_id),a(t);let n=[];"public"===e.type?n.push({class:["menu-child"],css_id:"activity-likes",name:window.vibebp.translations.liked,parent:"activity"}):(n=Us("vibebp").getMenu().filter(e=>"activity"===e.parent_slug),window.vibebp.settings.followers&&n.push({class:["menu-child"],css_id:"activity-following",name:window.vibebp.translations.following,parent:"activity"}),window.vibebp.settings.likes&&n.push({class:["menu-child"],css_id:"activity-likes",name:window.vibebp.translations.liked,parent:"activity"}),window.vibebp.settings.enable_reactions&&(n.push({class:["menu-child"],css_id:"public",name:window.vibebp.translations.wall,parent:"activity"}),n.push({class:["menu-child"],css_id:"reported",name:window.vibebp.translations.reported,parent:"activity"})),n.map((e,t)=>{if(-1===n.findIndex(e=>e.class.indexOf("current-menu-item")>-1)){n[t].class.push("current-menu-item");var r=new CustomEvent("action_loaded",{detail:{component:window.vibebp.api.endpoints.activity,action:n[t].class}});document.dispatchEvent(r)}}));const r=Us("vibebp").getUser();r&&r.hasOwnProperty("caps")&&r.caps.hasOwnProperty("manage_options")&&n.push({class:["menu-child"],css_id:"all_activity",name:window.vibebp.translations.site_activity,parent:"activity"}),n.map((e,t)=>{e.hasOwnProperty("caps")&&(r.caps.hasOwnProperty(e.caps)||n.splice(t,1))}),f(n),-1==document.querySelector("body").classList.value.indexOf("withsidebar")&&document.querySelector("body").classList.add("withsidebar"),y()},[e.type]);const w=()=>{a({...r,page:1})};Ds(()=>(document.addEventListener("vibebp_component_reload",w),()=>{document.removeEventListener("vibebp_component_reload",w)})),Pl(()=>{if(Object.keys(r).length){let a={...r};a.token=Us("vibebp").getToken(),e.hasOwnProperty("token")&&e.token.length&&(a.token=e.token),c&&c.abort();let i={},l=new AbortController;c&&(i={signal:l.signal}),d(l),s(!0);let m=`${window.vibebp.api.url}/${window.vibebp.api.endpoints.activity}?args=${r.hasOwnProperty("search")&&r.search.length?"nocache":encodeURIComponent(JSON.stringify({...r,search:""}))}&force`;"public"===e.type&&e.hasOwnProperty("user_id")&&(m=`${window.vibebp.api.url}/${window.vibebp.api.endpoints.public_activity}?args=${r.hasOwnProperty("search")&&r.search.length?"nocache":encodeURIComponent(JSON.stringify({...r,search:""}))}&force&client_id=${window.vibebp.settings.client_id}`),fetch(m,{method:"post",...i,headers:window.vibebp.xnonce?{"X-WP-Nonce":window.vibebp.xnonce}:{},body:JSON.stringify(a)}).then(e=>e.json()).then(e=>{if(s(!1),e.status){let a=[];if(p)a=[...t],e.data.activities.map(e=>{a.push(e)}),u(!1);else{if("activity-favs"===r.filter){let t=[];localforage.getItem("favorite_activities_"+Us("vibebp").getUser().id).then(n=>{n&&((n=JSON.parse(n))&&n.length&&(t=[...n]),e.data.activities.map(e=>{-1===t.indexOf(e.id)&&t.push(e.id)}),localforage.setItem("favorite_activities_"+Us("vibebp").getUser().id,JSON.stringify(t)))})}if("activity-likes"===r.filter){let t=[];localforage.getItem("liked_activities_"+Us("vibebp").getUser().id).then(n=>{n&&((n=JSON.parse(n))&&n.length&&(t=[...n]),e.data.activities.map(e=>{-1===t.indexOf(e.id)&&t.push(e.id)}),localforage.setItem("liked_activities_"+Us("vibebp").getUser().id,JSON.stringify(t)))})}a=e.data.activities}n(a),o(e.data.has_more_items)}else e.hasOwnProperty("message")&&Ms("vibebp").addNotification({text:e.message})})}},500,[r]);const h=(a,i)=>{let o=[...t],l=`${window.vibebp.api.url}/${window.vibebp.api.endpoints.activity}?args=${r.hasOwnProperty("search")&&r.search.length?"nocache":encodeURIComponent(JSON.stringify({...r,search:""}))}&force`;if("public"===e.type&&e.hasOwnProperty("user_id")&&(l=`${window.vibebp.api.url}/${window.vibebp.api.endpoints.public_activity}?args=${r.hasOwnProperty("search")&&r.search.length?"nocache":encodeURIComponent(JSON.stringify({...r,search:""}))}&force&client_id=${window.vibebp.settings.client_id}`),"remove"===i||"remove-favorite"==i&&"activity-favs"==r.filter){let e=[...t],i=e.findIndex(e=>e.id===a.id);if(-1!==i&&(console.log(i),e.splice(i,1),n(e),!r.search.length)){window.vibebp.api.url,window.vibebp.api.endpoints.activity,encodeURIComponent(JSON.stringify({...r,search:""}));localforage.getItem(l).then(t=>{let n=JSON.parse(t);n.data.activities=e,localforage.setItem(l,JSON.stringify(n))})}}"update"==i&&(o[o.findIndex(e=>e.id==a.id)]=a,r.search.length||localforage.getItem(l).then(e=>{let t=JSON.parse(e);t.data.activities=o,localforage.setItem(l,JSON.stringify(t))}))},y=()=>{let t=!1;Ms("vibebp").setData("wallUserId",0),Ms("vibebp").setData("activityPostPermissions",!1),Us("vibebp").getToken()&&Us("vibebp").getToken().length?e.hasOwnProperty("user_id")&&e.user_id?(v(!1),fetch(window.vibebp.api.url+"/wall/whocanpost/check?force",{method:"post",body:JSON.stringify({token:Us("vibebp").getToken(),user_id:e.user_id})}).then(e=>e.json()).then(e=>{e.hasOwnProperty("value")&&Ms("vibebp").setData("activityPostPermissions",e.value),v(!0)}),Ms("vibebp").setData("wallUserId",e.user_id)):(t=!0,Ms("vibebp").setData("activityPostPermissions",t),v(!0)):(t=!1,Ms("vibebp").setData("activityPostPermissions",t),v(!0))};let g=[...t];return r.hasOwnProperty("search")&&r.search.length&&(g=t.filter(e=>e.action.indexOf(r.search)>-1||e.content.indexOf(r.search)>-1)),r.hasOwnProperty("sorter")&&r.sorter.length&&(g=t.filter(e=>e.type==r.sorter>-1)),React.createElement("div",{className:"vibebp_sidebars"},"personal"===e.type?React.createElement("div",{className:"vibebp_left_sidebar_wrapper"},React.createElement("div",{className:"vibebp_left_sidebar"},React.createElement("h3",null,"public"===e.type?window.vibebp.components.wall:window.vibebp.components.activity.label),m.map((e,t)=>React.createElement("a",{className:e.class.join(" "),onClick:n=>{let i={...r};i.filter=e.css_id,i.page=1,a(i);let o=[...m],l=o.findIndex(e=>e.class.indexOf("current-menu-item")>-1);o[l].class.splice(o[l].class.indexOf("current-menu-item"),1),o[t].class.push("current-menu-item"),f(o)}},e.name)))):"","public"!==e.type||e.hasOwnProperty("user_id")?"":React.createElement("div",{className:"vibebp_left_sidebar_wrapper"},React.createElement("div",{className:"vibebp_left_sidebar"},React.createElement("h3",null,"public"===e.type?window.vibebp.components.wall.label:window.vibebp.components.activity.label),m.map((e,t)=>React.createElement("a",{className:e.class.join(" "),onClick:n=>{let i={...r};i.filter=e.css_id,i.page=1,a(i);let o=[...m],l=o.findIndex(e=>e.class.indexOf("current-menu-item")>-1);l>-1&&o[l].class.splice(o[l].class.indexOf("current-menu-item"),1),o[t].class.push("current-menu-item"),f(o)}},e.name)))),b?React.createElement("div",{className:"vibebp_main"},Us("vibebp").getData("activityPostPermissions")?React.createElement(ql,{component:e.type,id:e.id,secondary_item_id:e.secondary_item_id,update:(a,i)=>{let o=[...t],l=`${window.vibebp.api.url}/${window.vibebp.api.endpoints.activity}?args=${r.hasOwnProperty("search")&&r.search.length?"nocache":encodeURIComponent(JSON.stringify({...r,search:""}))}&force`;"public"===e.type&&e.hasOwnProperty("user_id")&&(l=`${window.vibebp.api.url}/${window.vibebp.api.endpoints.public_activity}?args=${r.hasOwnProperty("search")&&r.search.length?"nocache":encodeURIComponent(JSON.stringify({...r,search:""}))}&force&client_id=${window.vibebp.settings.client_id}`),"add"===i&&(o.unshift(a),n(o),r.search.length||localforage.getItem(l).then(e=>{let t=JSON.parse(e);t&&(t.data.activities=o,localforage.setItem(l,JSON.stringify(t)))})),"update"==i&&(o[o.findIndex(e=>e.id==a.id)]=a,r.search.length||localforage.getItem(l).then(e=>{let t=JSON.parse(e);t.data.activities=o,localforage.setItem(l,JSON.stringify(t))}))}}):"",React.createElement("div",{className:"portal"},React.createElement("div",{className:"portal_header"},React.createElement("div",{className:"header_links"},React.createElement("div",{className:"searchbox active"},React.createElement("span",{className:"vicon vicon-search"}),React.createElement("input",{type:"text",placeholder:window.vibebp.translations.search_text,value:r.search,onChange:e=>{let t={...r};t.search=e.target.value,t.page=1,a(t)}}))),React.createElement("div",{className:"header_extras"},React.createElement("select",{onChange:e=>{return t=e.target.value,void a({...r,sorter:t});var t}},Object.keys(window.vibebp.components.activity.sorters).map(e=>React.createElement("option",{value:e},window.vibebp.components.activity.sorters[e]))))),React.createElement("div",{className:"portal_body"},l&&!g.length?React.createElement("div",{class:"loading-roller"},React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null)):"",g.length?React.createElement("div",{className:"activity_list"},g.map(e=>React.createElement(Is,{activity:e,rootActivityId:e.id,update:h}))):l?"":React.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_activity_found),l&&g.length?React.createElement("div",{class:"loading-roller"},React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null)):"",i?React.createElement("a",{className:"link",onClick:()=>{let e={...r};e.page=r.page+1,u(!0),a(e)}},window.vibebp.translations.more):""))):"")},Ls=wp.element,Fs=(Ls.createElement,Ls.render,Ls.useState,Ls.useEffect,Ls.Fragment,Ls.useContext),Js=wp.data,Hs=(Js.select,Js.dispatch,window.vibeprojects&&window.vibeprojects.apiUrl,function(e){var t=Fs(l);return wp.element.createElement("div",{className:"project_content_tab"},wp.element.createElement($s,{filter:"vibe_projects",id:t.path.project,secondary_item_id:e.card.card_id,type:"vibe_projects"}))});function Ys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vs(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ys(Object(n),!0).forEach((function(t){qs(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qs(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ws(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Gs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gs(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var zs=wp.data,Xs=(zs.dispatch,zs.select),Bs=wp.element,Zs=(Bs.createElement,Bs.render,Bs.useState),Qs=Bs.useEffect,Ks=(Bs.Fragment,Bs.useContext),ec=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",tc=function(e){Ks(l);var t=Ws(Zs({name:""}),2),n=t[0],r=t[1],a=Ws(Zs(!1),2),i=a[0],o=a[1];Qs((function(){}),[]);return wp.element.createElement("div",{className:"card_popup"},wp.element.createElement("div",{className:"card_popup_title"},wp.element.createElement("span",null,window.vibeprojects.translations.add_checklist),wp.element.createElement("span",{className:"vicon vicon-close",onClick:e.close})),wp.element.createElement("div",{className:"add_checklist_container"},wp.element.createElement("span",null,window.vibeprojects.translations.checklist_title),wp.element.createElement("input",{type:"text",value:n.name,onChange:function(e){r(Vs(Vs({},n),{},{name:e.target.value}))}}),wp.element.createElement("a",{className:i?"create_checklist button is-loading":"create_checklist button",onClick:function(){n.name.length&&(o(!0),fetch("".concat(ec,"/card/").concat(e.addchecklist.card_id,"/addchecklist/?post"),{method:"post",body:JSON.stringify(Vs(Vs({},n),{},{token:Xs("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(t){t.status&&(r(t.addedChecklist),e.update(t.addedChecklist)),o(!1)})))}},window.vibeprojects.translations.add)))};const{createElement:nc,render:rc,useState:ac,useEffect:ic,Fragment:oc,useContext:lc,useRef:sc}=wp.element;const{createElement:cc,render:dc,useState:pc,useEffect:uc,Fragment:mc,useContext:fc,useRef:bc}=wp.element,{dispatch:vc,select:wc}=wp.data;var hc=e=>{const t=bc(null),[n,r]=pc(!1),[a,i]=pc([]),[o,l]=pc([]),[s,c]=pc(!1),[d,p]=pc(!1),[u,m]=pc(0),[f,b]=pc("media"),[v,w]=pc(()=>{let t={posts_per_page:20,paged:1,search_terms:"",orderby:""};return e.hasOwnProperty("post_mime_type")&&void 0!==e.post_mime_type&&(t.post_mime_type=e.post_mime_type),t}),[h,y]=pc([]),[g,_]=pc({name:"",url:"",type:"file"});uc(()=>(document.querySelector(".vibebp_myprofile")&&(document.querySelector(".vibebp_myprofile").classList.contains("popup_active")||document.querySelector(".vibebp_myprofile").classList.add("popup_active")),()=>{document.querySelector(".vibebp_myprofile")&&document.querySelector(".vibebp_myprofile").classList.contains("popup_active")&&document.querySelector(".vibebp_myprofile").classList.remove("popup_active")}),[]),((e,t,n=[])=>{const r=sc(Date.now());ic(()=>{const n=setTimeout((function(){Date.now()-r.current>=t&&(e(),r.current=Date.now())}),t-(Date.now()-r.current));return()=>{clearTimeout(n)}},[t,...n])})(()=>{r(!0),fetch(window.vibebp.api.url+"/user/fetch_media?force",{method:"post",body:JSON.stringify({...v,token:wc("vibebp").getToken()})}).then(e=>e.json()).then(e=>{if(r(!1),e.status)if(d){let t=[...a];e.data.map(e=>{t.push(e)}),i(t),p(!1),t.length<parseInt(data.total)?c(!0):c(!1)}else i(e.data),e.data.length<parseInt(e.total)?c(!0):c(!1)}).catch(e=>{r(!1)})},500,[v]),uc(()=>{vc("vibebp").setData("mediaTab",f),document.dispatchEvent(new CustomEvent("vibebp_media_tab",{detail:{tab:f,props:e,args:v}})),-1==h.indexOf(f)&&(document.addEventListener("vibebp_media_tab_submit",t=>{console.log(t),e.share(t.detail.media),e.close(!1)},!1),y([...h,f]))},[f]);const E=t=>{e.share(t)};uc(()=>(t&&new Plyr(t),()=>{}),[t]);const j=e=>{switch(e.type){case"image":return React.createElement("img",{src:e.url,className:"content_to_html_image"});case"video":return React.createElement("video",{className:"video_plyr",controls:!0,ref:e=>{new Plyr(e)}},React.createElement("source",{src:e.url,type:"video/mp4"}));case"audio":return React.createElement("audio",{className:"audio_plyr",controls:!0,ref:e=>{new Plyr(e)}},React.createElement("source",{src:e.url,type:"audio/mp3"}));case"document":case"spreadsheet":case"interactive":return React.createElement("span",{class:"modal_document"},e.name)}};return React.createElement("div",{className:"vibe_editor_modal"},React.createElement("span",{onClick:t=>{e.close(!1)}}),React.createElement("div",{className:"ve_modal-content"},React.createElement("div",{className:"ve_modal-header"},React.createElement("div",null,window.vibebp.settings.media_tabs?Object.keys(window.vibebp.settings.media_tabs).map(t=>{if("upload"!=t||!window.vibebp.settings.hasOwnProperty("upload_capability")||!window.vibebp.settings.upload_capability)return React.createElement("a",{className:f==t?"active":"",onClick:()=>{b(t)}},window.vibebp.settings.media_tabs[t]);{let n=wc("vibebp").getUser();if(void 0!==n&&n.hasOwnProperty("caps")&&void 0!==n.caps){let r=0;if(Array.isArray(n.caps)?n.caps.findIndex((e,t)=>e==window.vibebp.settings.upload_capability)>-1&&(r=1):"object"==typeof n.caps&&Object.keys(n.caps).map((e,t)=>{e===window.vibebp.settings.upload_capability&&n.caps[e]&&(r=1)}),e.hasOwnProperty("allow_upload")&&e.allow_upload&&(r=1),r)return React.createElement("a",{className:f==t?"active":"",onClick:()=>{b(t)}},window.vibebp.settings.media_tabs[t])}}}):""),React.createElement("span",{className:"vicon vicon-close",onClick:t=>{e.close(!1)}})),React.createElement("div",{className:"ve_modal-body"},"media"==f?React.createElement(mc,null,React.createElement("div",{className:"vibebp_form"},React.createElement("div",{className:"vibebp_form_field"},React.createElement("input",{type:"text",placeholder:window.vibebp.translations.search_text,onBlur:e=>w({...v,search_terms:e.target.value})})),React.createElement("div",{className:"vibebp_form_field"},React.createElement("select",{onChange:e=>{w({...v,order:e.target.value})}},Object.keys(window.vibeEditor.media_order).map(e=>React.createElement("option",{value:e},window.vibeEditor.media_order[e]))))),a&&a.length?React.createElement("div",{className:"allMedia"},a.map((t,n)=>React.createElement("div",{className:"single_media"},React.createElement("span",{onClick:n=>{E(t),e.hasOwnProperty("autoclose")||e.close(!1)}},j(t),t.hasOwnProperty("drive")&&t.drive?React.createElement("span",{className:"drive_label",style:{}},React.createElement("span",{className:"vicon vicon-harddrive"})):""),React.createElement("span",{className:"vicon vicon-close",onClick:()=>(e=>{let t=[...a];t.splice(t.findIndex(t=>t.id==e.id),1),i(t),fetch(window.vibebp.api.url+"/user/delete_media",{method:"post",body:JSON.stringify({token:wc("vibebp").getToken(),media:e})}).then(e=>e.json()).then(e=>{e.hasOwnProperty("message")&&vc("vibebp").addNotification({text:e.message})})})(t)})))):React.createElement("div",{className:"vbp_message"},window.vibebp.translations.no_media),n?React.createElement("div",{className:"loading-roller"},React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null),React.createElement("div",null)):s?React.createElement("a",{className:"link",onClick:()=>{w({...v,paged:v.paged+1}),p(!0)}},window.vibebp.translations.more):""):"upload"===f?React.createElement(mc,null,React.createElement("div",{className:"upload_media"},React.createElement("label",{for:"vibe_editor_upload_media"},window.vibebp.translations.upload_media,u?React.createElement("div",{className:"vibebp_progress_wrapper"},React.createElement("span",{className:"progress_wrapper"},React.createElement("span",{className:"progress_bar",style:{width:u+"%"}})),React.createElement("span",null,u,"%")):React.createElement("span",{className:"vicon vicon-plus"})),React.createElement("input",{type:"file",id:"vibe_editor_upload_media",onChange:e=>(e=>{if(e.target.files[0]){let t=e.target.files[0].size/1024/1024;if(tus.isSupported&&tus.canStoreURLs&&t>4){const t=window.vibebp.api.url+"/user/upload_media_stream?force";let n=new tus.Upload(e.target.files[0],{endpoint:t,chunkSize:2097152,retryDelays:[0,3e3],metadata:{token:wc("vibebp").getToken(),filename:e.target.files[0].name,filetype:e.target.files[0].type},onError:function(e){e.hasOwnProperty("message")&&vc("vibebp").addNotification({text:e.message})},onProgress:function(e,t){var n=(e/t*100).toFixed(2);m(n),100==n&&setTimeout(()=>{w({posts_per_page:20,paged:1,search_terms:"",orderby:""}),m(0),b("media")},500)},onSuccess:function(){localStorage.removeItem(n._urlStorageKey),n.url=n.url.replace("?upload",""),fetch(n.url+"/complete_stream?nocache",{method:"post",body:JSON.stringify({token:wc("vibebp").getToken()})}).then(e=>e.json()).then(e=>{e.status&&(w({posts_per_page:20,paged:1,search_terms:"",orderby:""}),m(0),b("media")),e.hasOwnProperty("message")&&vc("vibebp").addNotification({text:e.message})})}});n.findPreviousUploads().then(e=>{e.length>0&&n.resumeFromPreviousUpload(e[0]),n.start()}),tus.Upload.terminate(t).then((function(){})).catch((function(e){}))}else{let t=new FormData;t.append("file",e.target.files[0]),t.append("body",JSON.stringify({token:wc("vibebp").getToken()})),fetch(window.vibebp.api.url+"/user/upload_media?force",{method:"post",body:t}).then(e=>e.json()).then(e=>{if(e.status){let t=[...a];t.unshift(e.data),i(t),b("media")}else e.hasOwnPropoerty("message")&&vc("vibebp").addNotification({text:e.message})})}}})(e)}),o&&o.length?React.createElement("div",{className:"uploaded"},React.createElement("strong",null,window.vibebp.translations.uploaded_media),React.createElement("div",{className:"uploaded_files"},o.map((e,t)=>React.createElement("div",{className:"single_media",onClick:t=>{E(e)}},j(e))))):"")):"embed"===f?React.createElement(mc,null,React.createElement("div",{className:"embed_media"},React.createElement("label",{for:"vibe_editor_embed_name"}," ",window.vibebp.translations.enter_emabed_name," "),React.createElement("input",{type:"text",id:"vibe_editor_embed_name",onChange:e=>_({...g,name:e.target.value})}),React.createElement("label",{for:"vibe_editor_embed_url"}," ",window.vibebp.translations.enter_embed_url," "),React.createElement("input",{type:"text",id:"vibe_editor_embed_url",onChange:e=>_({...g,url:e.target.value})}),React.createElement("select",{onChange:e=>_({...g,type:e.target.value}),value:g.type},Object.keys(window.vibeEditor.embed_types).map(t=>{if(!(e.hasOwnProperty("post_mime_type")&&void 0!==e.post_mime_type&&e.post_mime_type.split(",").indexOf(t)<0))return React.createElement("option",{value:t},window.vibeEditor.embed_types[t])})),Object.values(g).findIndex(e=>""==e||null==e)>-1?"":React.createElement("button",{className:"button is-primary",onClick:()=>{E(g),e.close(!1)}},window.vibebp.translations.embed))):"giphy"==f?React.createElement(Ul,{update:(t,n)=>{E({type:"image",url:n.images.downsized.url,name:n.title}),e.close(!1)}}):React.createElement("div",{className:f}))))};function yc(e){return function(e){if(Array.isArray(e))return kc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Oc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gc(Object(n),!0).forEach((function(t){Ec(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ec(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||Oc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oc(e,t){if(e){if("string"==typeof e)return kc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?kc(e,t):void 0}}function kc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Nc=wp.element,xc=(Nc.createElement,Nc.render,Nc.useState),Sc=Nc.useEffect,Pc=Nc.Fragment,Ic=Nc.useContext,Cc=Nc.useRef,Ac=wp.data,Dc=Ac.dispatch,Rc=Ac.select,Tc=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",Mc=function(t){Cc(null);var n,r,a,i,o,s,c,d,p,u,m,f=Ic(l),b=jc(xc(t.card),2),v=b[0],w=b[1],h=jc(xc(!1),2),y=(h[0],h[1],jc(xc(!1),2)),g=y[0],_=y[1],j=jc(xc([]),2),O=(j[0],j[1],jc(xc([]),2)),k=(O[0],O[1],jc(xc({}),2)),N=(k[0],k[1],jc(xc({comment:""}),2)),x=(N[0],N[1],jc(xc({duedate:"",timestamp:(new Date).getTime()}),2)),S=x[0],P=x[1],I=jc(xc([]),2),C=I[0],A=I[1],D=jc(xc(!1),2),R=D[0],T=D[1],M=jc(xc(!1),2),U=M[0],$=M[1],L=jc(xc(!1),2),F=L[0],J=L[1],Y=jc(xc(!1),2),V=Y[0],q=Y[1],W=jc(xc(!1),2),G=W[0],z=W[1],X=jc(xc([]),2),B=X[0],Z=X[1],Q=jc(xc([]),2),K=(Q[0],Q[1],jc(xc({type:"",comment_id:"",text:""}),2)),ee=(K[0],K[1],jc(xc(!1),2)),te=ee[0],ne=ee[1],re=jc(xc(""),2),ae=re[0],ie=re[1],oe=jc(xc([]),2),le=oe[0],se=oe[1],ce=jc(xc([]),2),de=ce[0],pe=ce[1],ue=jc(xc(""),2),me=(ue[0],ue[1],jc(xc(!1),2)),fe=me[0],be=me[1],ve=jc(xc(!1),2),we=(ve[0],ve[1],jc(xc(!1),2)),he=(we[0],we[1],jc(xc(window.vibeprojects.settings.card_tabs),2)),ye=he[0],ge=(he[1],jc(xc(window.vibeprojects.settings.card_tabs[0].key),2)),_e=ge[0],Ee=ge[1],je=jc(xc(!1),2),Oe=je[0],ke=je[1],Ne=jc(xc(!1),2),xe=Ne[0],Se=Ne[1],Ie=jc(xc([]),2),Ce=Ie[0],Ae=Ie[1],De=jc(xc({}),2),Re=De[0],Te=De[1];Sc((function(){return document.querySelector(".vibebp_myprofile")&&(document.querySelector(".vibebp_myprofile").classList.contains("popup_active")||document.querySelector(".vibebp_myprofile").classList.add("popup_active")),function(){document.querySelector(".vibebp_myprofile")&&document.querySelector(".vibebp_myprofile").classList.contains("popup_active")&&document.querySelector(".vibebp_myprofile").classList.remove("popup_active")}}),[]),Sc((function(){var e,t,n;null!==(e=f.path)&&void 0!==e&&e.card&&null!==(t=f.board)&&void 0!==t&&null!==(n=t.cards)&&void 0!==n&&n.length&&w(_c({},f.board.cards[f.board.cards.findIndex((function(e){return e.card_id==f.path.card}))]))}),[f.path,f.board]),Sc((function(){var e;null!==(e=t.card)&&void 0!==e&&e.hasOwnProperty("card_id")&&w(t.card)}),[t.card]),Sc((function(){var e,n={};t.hasOwnProperty("card")?n.card_id=t.card.card_id:null!==(e=f.path)&&void 0!==e&&e.hasOwnProperty("card")&&(n.card_id=f.path.card);t.hasOwnProperty("board")&&(n.board_id=t.board.id),fetch("".concat(Tc,"/card/").concat(n.card_id,"?force"),{method:"post",body:JSON.stringify(_c(_c({},n),{},{token:Rc("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){var t;e.status&&(e.hasOwnProperty("checklists")&&A(e.checklists),e.hasOwnProperty("cardAttachments")&&Z(e.cardAttachments),e.hasOwnProperty("dueDateCard")&&P(e.dueDateCard),e.hasOwnProperty("cardmembers")&&se(e.cardmembers),e.hasOwnProperty("raw")&&Te(e.raw),null!==(t=e.meta)&&void 0!==t&&t.length&&Ae(e.meta))}))}),[]),Sc((function(){document.dispatchEvent(new CustomEvent("vibe_projects_card_tab_"+_e,{detail:{card:v}}))}),[_e]),Sc((function(){ae.length>3&&fetch("".concat(Tc,"/search/member?no_cache"),{method:"post",body:JSON.stringify(_c(_c({},de),{},{project_id:t.project_id,s:ae,token:Rc("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){e.status&&pe(e.members)}))}),[ae]);var Me=function(e){var t,n,r=0;null!==(t=f.path)&&void 0!==t&&null!==(n=t.project)&&void 0!==n&&n.length&&(r=f.path.project),fetch("".concat(Tc,"/card/addmembertocard?post"),{method:"post",body:JSON.stringify({card_id:v.card_id,project_id:r,members:[e.id],token:Rc("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){if(t.status){Dc("vibebp").addNotification({text:t.message});var n=f.board.cards;-1==n[n.findIndex((function(e){return e.card_id==v.card_id}))].members.indexOf(e.id)&&n[n.findIndex((function(e){return e.card_id==v.card_id}))].members.push(e.id);var r=yc(le);r.push({id:e.id,avatar:e.avatar,label:e.label}),se(r),f.update("multiple",{automate:{id:v.card_id,type:"assign_member",value:e.id},board:_c(_c({},f.board),{},{cards:n})})}}))},Ue=function(e){fetch("".concat(Tc,"/card/complete/").concat(v.card_id,"/action?post"),{method:"post",body:JSON.stringify({complete:e,project_id:t.project_id,token:Rc("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(n){if(n.hasOwnProperty("message")&&Dc("vibebp").addNotification({text:n.message}),n.status){var r={id:v.card_id,type:"complete_card"};if(f.hasOwnProperty("board")){var a,i,o=yc(f.board.cards);if(null!==(a=o[o.findIndex((function(e){return e.card_id==v.card_id}))])&&void 0!==a&&null!==(i=a.icons)&&void 0!==i&&i.length&&(o[o.findIndex((function(e){return e.card_id==v.card_id}))].icons=[]),e)o[o.findIndex((function(e){return e.card_id==v.card_id}))].icons.push({icon:"vicon vicon-check",key:"complete",label:window.vibeprojects.translations.complete_card});else{var l=o[o.findIndex((function(e){return e.card_id==v.card_id}))].icons.findIndex((function(e){return"complete"==e.key}));l>-1&&o[o.findIndex((function(e){return e.card_id==v.card_id}))].icons.splice(l,1)}f.update("multiple",{board:_c(_c({},f.board),{},{cards:o}),automate:r})}if(t.hasOwnProperty("card")){var s=_c({},t.card);s.icons.push({icon:"vicon vicon-check",key:"complete",label:window.vibeprojects.translations.complete_card}),t.update(s)}if(f.hasOwnProperty("milestones")&&f.milestones&&f.milestones.length&&v.hasOwnProperty("milestone")&&v.milestone){var c=f.milestones.findIndex((function(e){return e.card_id==e.card_id}));if(c>-1)yc(f.milestones)[c].completed=e}}}))},$e=function(e){fetch("".concat(Tc,"/card/milestone/").concat(v.card_id,"/action?post"),{method:"post",body:JSON.stringify({milestone:e,project_id:t.project_id,token:Rc("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){if(f.hasOwnProperty("board")){var n,r=yc(f.board.cards);if(null!==(n=r[r.findIndex((function(e){return e.card_id==v.card_id}))].icons)&&void 0!==n&&n.length&&(r[r.findIndex((function(e){return e.card_id==v.card_id}))].icons=[]),e)r[r.findIndex((function(e){return e.card_id==v.card_id}))].icons.push({icon:"vicon vicon-control-record",key:"milestone",label:window.vibeprojects.translations.milestone});else if(r.length){var a=r.findIndex((function(e){return e.card_id==v.card_id}));if(a>-1){var i=r[a].icons.findIndex((function(e){return"milestone"==e.key}));i>-1&&r[a].icons.splice(i,1)}}var o={id:v.card_id,type:"mark_milestone"};f.update("multiple",{board:_c(_c({},f.board),{},{cards:r}),automate:o})}if(t.hasOwnProperty("message")&&Dc("vibebp").addNotification({text:t.message}),f.hasOwnProperty("milestones")&&f.milestones&&f.milestones.length){var l=f.milestones.findIndex((function(e){return e.card_id==e.card_id}));if(l>-1){if(!e){var s=yc(f.milestones);s.splice(l,1),f.update("milestones",s)}}else if(e){var c=yc(f.milestones);c.push({card_id:v.card_id,completed:v.completed}),f.update("milestones",c)}}}))},Le=function(e){window.confirm(window.vibeprojects.translations.confirm_card_delete)&&fetch("".concat(Tc,"/card/archive/").concat(v.card_id,"/action?post"),{method:"post",body:JSON.stringify({archive:e,project_id:t.project_id,token:Rc("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){var n,r,a;if(f.hasOwnProperty("board")&&null!==(n=f.board)&&void 0!==n&&null!==(r=n.cards)&&void 0!==r&&r.length){var i=_c({},f.board);i.cards.length&&i.cards.findIndeX((function(e){return e.card_id==v.card_id}))>-1&&(i.cards.splice(i.cards.findIndeX((function(e){return e.card_id==v.card_id})),1),i.lists.findIndex((function(e){return e.cards.indexOf(v.card_id)>-1}))>-1&&i.lists[i.lists.findIndex((function(e){return e.cards.indexOf(v.card_id)>-1}))].cards.splice(i.lists[i.lists.findIndex((function(e){return e.cards.indexOf(v.card_id)>-1}))].cards.indexOf(v.card_id),1));var o=_c({},f.path);delete o.card,f.update("multiple",{path:o,board:i})}else if(f.hasOwnProperty("tasks")&&null!==(a=f.tasks)&&void 0!==a&&a.length){var l=yc(f.tasks);l.splice(l.findIndex((function(e){return e.card_id==v.card_id})),1);var s=_c({},f.path);delete s.card,f.update("multiple",{path:s,tasks:l})}else if(f.hasOwnProperty("path")){var c=_c({},f.path);delete c.card,f.update("path",c)}e.hasOwnProperty("message")&&Dc("vibebp").addNotification({text:e.message}),t.close()}))},Fe=function(e){fetch("".concat(Tc,"/card/watch/").concat(v.card_id,"/action?post"),{method:"post",body:JSON.stringify({watch:e,project_id:t.project_id,token:Rc("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){if(t.status){var n=yc(f.board.cards);n[n.findIndex((function(e){return e.card_id==v.card_id}))].watch=e;var r={id:v.card_id,type:"mark_watch"};f.update("multiple",{board:_c(_c({},f.board),{},{cards:n}),automate:r})}t.hasOwnProperty("message")&&Dc("vibebp").addNotification({text:t.message})}))},Je=function(e){navigator.clipboard?navigator.clipboard.writeText(e).then((function(){console.log("Async: Copying to clipboard was successful!")}),(function(e){console.error("Async: Could not copy text: ",e)})):function(e){var t=document.createElement("textarea");t.value=e,t.style.top="0",t.style.left="0",t.style.position="fixed",document.body.appendChild(t),t.focus(),t.select();try{var n=document.execCommand("copy")?"successful":"unsuccessful";console.log("Fallback: Copying text command was "+n)}catch(e){console.error("Fallback: Oops, unable to copy",e)}document.body.removeChild(t)}(e)},He=0;return v&&Object.keys(v).length&&(He=window.vibeprojects.settings.statuses.card.findIndex((function(e){return e.value==v.status}))),v&&Object.keys(v).length?wp.element.createElement("div",{className:"full_card_background_wrapper"},wp.element.createElement("span",{onClick:function(){t.close();var e=_c({},f.path);delete e.card,f.update("path",e)}}),wp.element.createElement("div",{className:"full_card_wrapper",style:{backgroundColor:U?"#999":"#fff"}},wp.element.createElement("div",{className:"full_card_container"},wp.element.createElement("div",{className:"card_title"},wp.element.createElement("span",null,wp.element.createElement("span",{className:"card_status",style:{background:null===(n=window.vibeprojects.settings.statuses.card[He])||void 0===n?void 0:n.color}},null===(r=window.vibeprojects.settings.statuses.card[He])||void 0===r?void 0:r.label),wp.element.createElement("span",{className:g?"vicon vicon-close":"vicon vicon-settings",onClick:function(){return _(!g)}})),wp.element.createElement("h2",{dangerouslySetInnerHTML:{__html:v.title}}),null!==(a=f.board)&&void 0!==a&&null!==(i=a.cards)&&void 0!==i&&i.length?"":null!==(o=v.project)&&void 0!==o&&o.title?wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:v.project.title}}):""),wp.element.createElement("div",{className:"card_details_item_header"},wp.element.createElement("div",null,f.hasOwnProperty("board")&&null!==(s=f.board)&&void 0!==s&&null!==(c=s.lists)&&void 0!==c&&c.length?wp.element.createElement("div",{className:"card_labels_wrapper"},wp.element.createElement("h6",null,window.vibeprojects.translations.labels," ",wp.element.createElement("span",{className:"vicon vicon-plus",onClick:function(){$(!0)}})),null!==(d=f.board)&&void 0!==d&&null!==(p=d.labels)&&void 0!==p&&p.length&&null!==(u=v.labels)&&void 0!==u&&u.length?wp.element.createElement("div",{className:"existing_labels",onClick:function(){$(!0)}},v.labels.map((function(e){var t=f.board.labels.findIndex((function(t){return t.id===e}));if(t>-1)return wp.element.createElement("span",{style:{background:f.board.labels[t].color}},f.board.labels[t].label)}))):""):"",wp.element.createElement("div",{className:"card_add_members_wrapper"},wp.element.createElement("div",{className:"existing_members"},le.length?wp.element.createElement("ul",{className:H("add_card_members")?"card_members can_remove":"card_members"},le.map((function(e){return wp.element.createElement("li",{onClick:function(){if(H("add_card_members")){var t,n,r=yc(le);if(r.splice(r.findIndex((function(t){return t.id===e.id})),1),se(r),i=e,fetch("".concat(Tc,"/card/removemembercard?post"),{method:"post",body:JSON.stringify({card_id:v.card_id,project_id:f.path.project,member:i.id,token:Rc("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&(Dc("vibebp").addNotification({text:e.message}),f.update("automate",{id:v.card_id,type:"remove_member",value:searchMember.id}))})),null!==(t=f.board)&&void 0!==t&&null!==(n=t.cards)&&void 0!==n&&n.length){var a=yc(f.board.cards);a[a.findIndex((function(e){return e.card_id==f.path.card}))].members=r,f.update("board",_c(_c({},f.board),{},{cards:a}))}}var i}},wp.element.createElement("img",{src:e.avatar}),e.label)}))):""),wp.element.createElement("div",{className:"card_add_members_action"},f.path.hasOwnProperty("board")&&H("add_card_members")?wp.element.createElement("a",{className:te?"add_new_member vicon vicon-close":"add_new_member vicon vicon-plus",onClick:function(){ne(!te)},title:window.vibeprojects.translations.add_members}):"",te?wp.element.createElement("div",{className:"card_add_new_members"},wp.element.createElement("input",{type:"text",value:ae,onChange:function(e){return ie(e.target.value)},placeholder:window.vibeprojects.translations.type_to_search}),wp.element.createElement(Pc,null,null!==(m=v.members)&&void 0!==m&&m.length&&-1!=v.members.indexOf(Rc("vibebp").getUser().id)?"":wp.element.createElement("span",{class:"tip",title:window.vibeprojects.translations.join_card,onClick:function(){return Me({id:Rc("vibebp").getUser().id})}},wp.element.createElement("span",{className:"vicon vicon-plus"}))),de.length?wp.element.createElement("div",{className:"card_show_search_results"},wp.element.createElement("ul",null,de.map((function(e,t){return wp.element.createElement("li",{onClick:function(){var n=yc(le);n.push(e),se(n);var r=yc(de);r.splice(t,1),pe(r),Me(e)}},wp.element.createElement("img",{src:e.avatar}),e.label)})))):""):"")),S.duedate?wp.element.createElement("div",{className:Math.round((new Date).getTime()/1e3)>S.timestamp?"card_due_date_wrapper overdue":"card_due_date_wrapper"},wp.element.createElement("strong",null,wp.element.createElement("span",{className:"vicon vicon-time"}),Math.round((new Date).getTime()/1e3)>S.timestamp?window.vibeprojects.translations.due_by:window.vibeprojects.translations.due_in),wp.element.createElement("span",{title:Math.round((new Date).getTime()/1e3)>S.timestamp?window.vibeprojects.translations.overdue:window.vibeprojects.translations.due_date},wp.element.createElement(E,{timestamp:S.timestamp}))):"")),wp.element.createElement("div",{className:R?"card_description_wrapper active":"card_description_wrapper",onClick:function(){T(!R)}},wp.element.createElement(Fo,{card:_c(_c({},v),{},{raw:Re,meta:Ce})})),C?wp.element.createElement(nl,{card:v,members:le,close:function(){setshowChecklistsPopup(!1)},checklist:C}):"",wp.element.createElement("div",{className:"card_tabs_wrapper"},ye.length?wp.element.createElement("div",{className:"card_tabs"},ye.map((function(e){return wp.element.createElement("div",{onClick:function(){return Ee(e.key)},className:_e==e.key?"card_tab active card_tab_"+e.key:"card_tab card_tab_"+e.key},e.label)}))):"",wp.element.createElement("div",{className:"card_tab_content"},"attachments"==_e?wp.element.createElement("div",{className:"card_attachments_wrapper"},wp.element.createElement("h4",null,window.vibeprojects.translations.attachments),B.length?wp.element.createElement("div",{className:"card_attachments_list"},B.map((function(e,t){return wp.element.createElement("div",{className:"card_attachment"},wp.element.createElement("div",null,wp.element.createElement("div",{className:"card_attachment_thumbnail"},function(e){var t="";if(e.hasOwnProperty("type"))t=e.type;else{var n=e.value.split(/[#?]/)[0].split(".").pop().trim();t=["jpeg","jpg","png","gif"].findIndex((function(e){return n==e}))>-1?"image":["mp4","avi","mov","wmv","webm"].findIndex((function(e){return n==e}))>-1?"video":"file"}switch(t){case"image":return wp.element.createElement("img",{src:e.url});case"video":return wp.element.createElement("video",{src:e.url,controls:!0});default:return e.hasOwnProperty("name")?wp.element.createElement("a",{href:e.url,target:"_blank"},e.name):wp.element.createElement("a",{href:e.url,target:"_blank"},wp.element.createElement("span",{className:"vicon vicon-file"}))}}(e)),wp.element.createElement("span",{className:"attachment_thumbnail_name"},wp.element.createElement("span",null,e.name),wp.element.createElement("a",{className:"vicon vicon-arrow-top-right",target:"_blank",href:e.url}))),wp.element.createElement("div",{className:"card_attachments_actions"},fe?wp.element.createElement("a",{className:"delete_button"},"....."):wp.element.createElement("a",{className:"delete_button",onClick:function(){!function(e){be(!0),fetch("".concat(Tc,"/card/deleteCardAttachment/").concat(v.card_id,"/action?post"),{method:"post",body:JSON.stringify({attachment:e,card_id:v.card_id,token:Rc("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){if(t.status){var n=yc(B);n.splice(n.findIndex((function(t){return t.name===e.name&&t.value===e.value})),1),Z(n)}be(!1)}))}(e)},title:window.vibeprojects.translations.delete},wp.element.createElement("span",{className:"vicon vicon-trash"}))))}))):wp.element.createElement("div",{className:"vbp_message"},window.vibeprojects.translations.no_attachments),H("add_card_attachments")?wp.element.createElement("span",{className:"add_attachment"},wp.element.createElement("span",{className:"vicon vicon-plus",onClick:function(){return ke(!0)}})):"",Oe?wp.element.createElement(hc,{close:function(){return ke(!1)},share:function(e){var t,n;t=e,(n=yc(B)).push(t),Z(n),fetch("".concat(Tc,"/card/addCardAttachment/").concat(v.card_id,"/action?post"),{method:"post",body:JSON.stringify({attachment:t,card_id:v.card_id,token:Rc("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&Dc("vibebp").addNotification({text:e.message})}))}}):""):"watchers"==_e?wp.element.createElement(ul,{card:v}):"activity"==_e?wp.element.createElement(Hs,{card:v}):wp.element.createElement("div",{className:"card_tab "+_e})))),wp.element.createElement("div",{className:g?"card_actions_wrapper active":"card_actions_wrapper"},wp.element.createElement("strong",null,window.vibeprojects.translations.card_actions),wp.element.createElement("div",{className:"card_actions"},f.path.hasOwnProperty("board")&&H("add_card_label")?wp.element.createElement("span",{className:"add_labels",onClick:function(){$(!0)}},wp.element.createElement("span",{className:"vicon vicon-tag"}),wp.element.createElement("span",{className:"action_label"},window.vibeprojects.translations.labels)):"",H("add_card_checklists")?wp.element.createElement("span",{className:"add_checklist",onClick:function(){q(!0)}},wp.element.createElement("span",{className:"vicon vicon-check-box"}),wp.element.createElement("span",{className:"action_label"},window.vibeprojects.translations.checklist)):"",H("set_card_date")?wp.element.createElement("span",{className:"add_due_date",onClick:function(){J(!0)}},wp.element.createElement("span",{className:"vicon vicon-time"}),wp.element.createElement("span",{className:"action_label"},window.vibeprojects.translations.due_date)):"",f.path.hasOwnProperty("board")&&H("complete_card")?wp.element.createElement("span",{className:"move_card",onClick:function(){z(!0)}},wp.element.createElement("span",{className:"vicon vicon-move"}),wp.element.createElement("span",{className:"action_label"},window.vibeprojects.translations.move_card)):"",H("complete_card")?wp.element.createElement(Pc,null,v.hasOwnProperty("icons")&&v.icons.findIndex((function(e){return"complete"==e.key}))>-1?wp.element.createElement("span",{className:"move_card",onClick:function(){Ue(!1)}},wp.element.createElement("span",{className:"vicon vicon-check"}),wp.element.createElement("span",{className:"action_label"},window.vibeprojects.translations.completed)):wp.element.createElement("span",{className:"move_card",onClick:function(){Ue(!0)}},wp.element.createElement("span",{className:"vicon vicon-check"}),wp.element.createElement("span",{className:"action_label"},window.vibeprojects.translations.complete))):"",f.path.hasOwnProperty("board")&&H("create_project_milestones")?wp.element.createElement(Pc,null,v.hasOwnProperty("icons")&&v.icons.findIndex((function(e){return"milestone"==e.key}))>-1?wp.element.createElement("span",{className:"move_card ",onClick:function(){$e(!1)}},wp.element.createElement("span",{className:"vicon vicon-stats-up"}),wp.element.createElement("span",{className:"action_label"},window.vibeprojects.translations.remove_milestone)):wp.element.createElement("span",{className:"move_card",onClick:function(){$e(!0)}},wp.element.createElement("span",{className:"vicon vicon-stats-up"}),wp.element.createElement("span",{className:"action_label"},window.vibeprojects.translations.milestone))):"",H("change_status")?wp.element.createElement("span",{className:"move_card",onClick:function(){Se(!0)}},wp.element.createElement("span",{className:"vicon vicon-widget-alt"}),wp.element.createElement("span",{className:"action_label"},window.vibeprojects.translations.change_status)):"",H("delete_card")?wp.element.createElement(Pc,null,v.archived?wp.element.createElement("span",{className:"move_card",onClick:function(){Le(!1)}},wp.element.createElement("span",{className:"vicon vicon-trash"}),wp.element.createElement("span",{className:"action_label"},window.vibeprojects.translations.send_to_board)):wp.element.createElement("span",{className:"move_card ",onClick:function(){Le(!0)}},wp.element.createElement("span",{className:"vicon vicon-trash"}),wp.element.createElement("span",{className:"action_label"},window.vibeprojects.translations.archive))):"",H("watch_card")?wp.element.createElement(Pc,null,v.watch?wp.element.createElement("span",{className:"move_card",onClick:function(){Fe(!1)}},wp.element.createElement("span",{className:"vicon vicon-eye"}),wp.element.createElement("span",{className:"action_label"},window.vibeprojects.translations.watching)):wp.element.createElement("span",{className:"move_card",onClick:function(){Fe(!0)}},wp.element.createElement("span",{className:"vicon vicon-eye"}),wp.element.createElement("span",{className:"action_label"},window.vibeprojects.translations.watch))):"",wp.element.createElement("span",{className:"move_card ",onClick:function(){var e;e="".concat(window.vibeprojects.app_url,"&project=").concat(f.path.project,"&board=").concat(f.board.id,"&card=").concat(v.card_id),Je(e)}},wp.element.createElement("span",{className:"vicon vicon-share"}),wp.element.createElement("span",{className:"action_label"},window.vibeprojects.translations.copy_link)))),U?wp.element.createElement(Pe,{close:function(){$(!1)},card:v}):"",V?wp.element.createElement(tc,{addchecklist:v,update:function(e){A(e),q(!1)},close:function(){q(!1)}}):"",F?wp.element.createElement(it,{duedate:v,close:function(){J(!1)},update:function(n){var r,a,i;if(null!==(r=f.board)&&void 0!==r&&null!==(a=r.lists)&&void 0!==a&&a.length){var o=yc(f.board.lists);o.cards[o.cards.indexOf(v.card_id)].duedate=e.timestamp;var l={id:v.card_id,type:"due_date",value:e.timestamp};f.update("multiple",{board:_c(_c({},f.board),{},{lists:o}),automate:l})}if(null!==(i=f.tasks)&&void 0!==i&&i.length){var s=yc(f.tasks);s.findIndex((function(e){return e.card_id==t.card.card_id}))&&(s[s.findIndex((function(e){return e.card_id==t.card.card_id}))]=n,f.update("tasks",s))}}}):"",G?wp.element.createElement(_t,{card:v,close:function(){z(!1)}}):"",xe?wp.element.createElement(qe,{card:v,close:function(){Se(!1)}}):"")):""};function Uc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Uc(Object(n),!0).forEach((function(t){Lc(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Lc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Jc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jc(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Hc=wp.element,Yc=(Hc.createElement,Hc.render,Hc.useState),Vc=Hc.useEffect,qc=(Hc.Fragment,Hc.useContext),Wc=Hc.useRef,Gc=wp.data,zc=Gc.select,Xc=Gc.dispatch,Bc=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",Zc=function(e){var t,n,r,a,i=Wc(null),o=Fc(Yc({}),2),s=o[0],c=o[1],d=qc(l),p=Fc(Yc(!1),2),u=p[0],m=p[1],f=Fc(Yc(!1),2),b=f[0],v=f[1],w=Fc(Yc({}),2),h=w[0],y=w[1],g=Fc(Yc({board_id:null===(t=e.board)||void 0===t?void 0:t.id}),2),_=(g[0],g[1],Fc(Yc([]),2)),E=(_[0],_[1],Fc(Yc(!1),2)),j=E[0],O=E[1],k=Fc(Yc([]),2),N=(k[0],k[1],Fc(Yc([]),2)),x=N[0],S=N[1],P=Fc(Yc([]),2),I=(P[0],P[1],Fc(Yc([]),2)),C=(I[0],I[1],Fc(Yc([]),2)),A=C[0],D=(C[1],Fc(Yc(!1),2)),R=D[0],T=D[1],M=Fc(Yc({}),2),U=(M[0],M[1],Fc(Yc(e.board),2)),$=U[0],L=U[1];Vc((function(){var e=function(){var e=i.current.getBoundingClientRect();c({width:e.width+"px"})};return window.addEventListener("resize",e),i&&!Object.keys(s).length&&e(),function(){window.removeEventListener("resize",e)}}),[i]),Vc((function(){L(e.board)}),[e.board]),Vc((function(){var e,t;R&&d.hasOwnProperty("board")&&null!==(e=d.board)&&void 0!==e&&null!==(t=e.lists)&&void 0!==t&&t.length&&fetch("".concat(Bc,"/project/boards/save_lists?post"),{method:"post",body:JSON.stringify({board_id:d.board.id,lists:d.board.lists,token:zc("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){Xc("vibebp").addNotification({icon:"vicon-check",text:e.message}),T(!1)}))}),[R]);var F=function(e,t){if("remove"==e){var n=d.board.lists;n.splice(lists.findIndex((function(e){return e.term_id==t.term_id})),1),d.update("board",$c($c({},d.board),{},{lists:n}))}};return wp.element.createElement("div",{ref:i},wp.element.createElement("div",{className:"list_boards",style:s},d.hasOwnProperty("boardFilters")&&d.boardFilters.showUnlisted?wp.element.createElement("div",null,wp.element.createElement("div",{className:"list_wrapper"},wp.element.createElement("div",{className:"list"},wp.element.createElement("div",{className:"list_header"},wp.element.createElement("strong",null,window.vibeprojects.translations.unlisted)),wp.element.createElement("div",{className:"cards_container"},d.board.cards.filter((function(e){return!e.list&&-1==d.board.lists.findIndex((function(t){return t.cards.indexOf(e.card_id)>-1}))})).length?d.board.cards.filter((function(e){return!e.list&&-1==d.board.lists.findIndex((function(t){return t.cards.indexOf(e.card_id)>-1}))})).map((function(e){return wp.element.createElement(en,{card:e.card_id})})):"")))):"",null!==(n=d.board)&&void 0!==n&&n.hasOwnProperty("lists")&&null!==(r=d.board)&&void 0!==r&&null!==(a=r.lists)&&void 0!==a&&a.length?d.board.lists.map((function(e,t){return wp.element.createElement("div",{draggable:!0,onDragOver:function(e){e.preventDefault()},onDragEnd:function(e){O(!1)},style:A[t],ref:function(e){!function(e,t){if(e){var n=x;n[t]||(n[t]=e),S(n)}}(e,t)},onDragStart:function(t){O(e)},onDrop:function(n){var r=$c({},d.board),a=!1;if(function(e,t){if(!(d.board.hasOwnProperty("cardDragging")&&d.board.cardDragging&&Object.keys(d.board.cardDragging).length)&&j){var n=d.board.lists[t];if(j.term_id!==n.term_id){var r=$c({},d.board.lists);(r=d.board.lists.filter((function(e){return e!=j}))).findIndex((function(e){return e.term_id==j.term_id})),r.splice(t,0,j),r=r.map((function(e){return e.list_order_changed=!0,e})),d.update("board",$c($c({},d.board),{},{lists:r})),T(!0)}}}(0,t),(!e.hasOwnProperty("cards")||!e.cards.length)&&d.board.hasOwnProperty("cardDragging")&&d.board.cardDragging){r.lists[t].hasOwnProperty("cards")||(r.lists[t].cards=[]);var i=r.lists.findIndex((function(e){return e.term_id==d.board.cardDragging.list.term_id}));i>-1&&(r.lists[i].cards.splice(r.lists[i].cards.findIndex((function(e){return e==d.board.cardDragging.card_id})),1),r.lists[i].is_changed=!0,r.lists[t].cards.push(d.board.cardDragging.card_id),r.cards[r.cards.findIndex((function(e){return e.card_id==d.board.cardDragging.card_id}))].list={name:r.lists[t].name,term_id:r.lists[t].term_id},r.cards[r.cards.findIndex((function(e){return e.card_id==d.board.cardDragging.card_id}))].list={term_id:e.term_id,name:e.name},r.lists[t].is_changed=!0),a=!0}if(d.board.hasOwnProperty("cardDragging")&&d.board.cardDragging,a){r.cardDragging=!1,r.lists.map((function(e,t){var n;null===(n=e.cards)||void 0===n||n.map((function(t){r.cards=r.cards.map((function(t){return $c($c({},t),{},{list:{name:e.name,term_id:e.term_id}})}))}))}));var o={id:$.cardDragging.card_id,type:"move_card",value:e.term_id};d.update("multiple",{board:r,automate:o}),T(!0)}else{r.cardDragging=!1;var l={id:$.cardDragging.card_id,type:"move_card",value:e.term_id};d.update("multiple",{board:r,automate:l})}}},wp.element.createElement(An,{list:e,key:t,update:F,board:$,view:"kanban"}))})):"",d.hasOwnProperty("path")&&d.path.hasOwnProperty("card")?wp.element.createElement(Mc,{close:function(){var e=$c({},d.path);delete e.card,d.update("path",e)}}):"",wp.element.createElement("div",{className:"list_wrapper"},u?wp.element.createElement("div",{className:"list_details"},wp.element.createElement("div",{className:"vibe_projects_new_list_form"},wp.element.createElement("div",{className:"vibe_projects_field"},wp.element.createElement("input",{type:"text",value:h.name,onChange:function(e){y($c($c({},h),{},{name:e.target.value}))},placeholder:window.vibeprojects.translations.list_name})),wp.element.createElement("div",{className:"vibe_projects_form_actions"},wp.element.createElement("a",{className:b?"button is-primary is-loading":"button is-primary",onClick:function(){m(!1),v(!0),fetch("".concat(Bc,"/newlist/").concat(d.path.board,"/?force"),{method:"post",body:JSON.stringify($c($c({},h),{},{token:zc("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){if(v(!1),e.status){var t,n,r=[];null!==(t=d.board)&&void 0!==t&&null!==(n=t.lists)&&void 0!==n&&n.length&&(r=d.board.lists),r.push(e.listdetails),d.update("board",$c($c({},d.board),{},{lists:r})),y({})}}))}},window.vibeprojects.translations.add_new_list),wp.element.createElement("a",{className:"vicon vicon-close",onClick:function(){m(!1)}})))):wp.element.createElement("a",{className:"invisible_button is-loading",onClick:function(){m(!0)}},window.vibeprojects.translations.add_new_list))))};function Qc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qc(Object(n),!0).forEach((function(t){ed(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ed(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function td(e){return(td="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return rd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rd(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ad=wp.element,od=(ad.createElement,ad.render,ad.useState),ld=ad.useEffect,sd=(ad.Fragment,ad.useContext),cd=ad.useRef,dd=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",pd=wp.data,ud=pd.select,md=(pd.dispatch,function(e){var t=sd(l),n=cd(null),r=nd(od(null),2),a=r[0],i=r[1],o=nd(od(!1),2),s=o[0],c=o[1],d=nd(od([(new Date).getFullYear()+"-"+(new Date).getMonth()+"-"+(new Date).getDate(),new Date((new Date).getFullYear(),(new Date).getMonth()+1,1).getFullYear()+"-"+new Date((new Date).getFullYear(),(new Date).getMonth()+1,1).getMonth()+"-"+(new Date).getDate()]),2),p=d[0],u=d[1],m=nd(od({title:"",progress:0,dates:[],dependencies:[],menu_order:1}),2),f=m[0],b=m[1];ld((function(){if(e.hasOwnProperty("task")&&"object"==td(e.task)){var t=e.task,n=t.id,r=t.name,a=t.start,i=t.end,o=t.dependencies,l=t.progress;b({id:n,title:r,progress:l,dates:[a,i],dependencies:o}),u([a,i])}}),[e.task]),ld((function(){if(n&&n.hasOwnProperty("current")&&n.current&&"undefined"!=typeof flatpickr){a&&p&&a.destroy();var e={altInput:!0,mode:"range",dateFormat:"Y-m-d",defaultDate:p,minDate:new Date((new Date).setDate((new Date).getDate()-30)),onChange:function(e){u(e)}},t=flatpickr(n.current,e);i(t)}return function(){n&&n.hasOwnProperty("current")&&n.current&&"undefined"!=typeof flatpickr&&n.current.flatpickr().destroy()}}),[n,p]);return wp.element.createElement("div",{className:"new_card_form"},wp.element.createElement("div",{className:"new_card_field"},wp.element.createElement("label",null,"card"==e.type?window.vibeprojects.translations.card_title:window.vibeprojects.translations.milestone_title),wp.element.createElement("input",{type:"text",value:f.title,onChange:function(e){return b(Kc(Kc({},f),{},{title:e.target.value}))}})),wp.element.createElement("div",{className:"new_card_field"},wp.element.createElement("label",null,"card"==e.type?window.vibeprojects.translations.card_dates:window.vibeprojects.translations.milestone_dates),wp.element.createElement("input",{type:"date",ref:n})),wp.element.createElement("div",{className:"new_card_field"},wp.element.createElement("label",null,window.vibeprojects.translations.milestone_progress),wp.element.createElement("div",{className:"range__slider_wrap"},wp.element.createElement("div",{className:"range__slider"},wp.element.createElement("input",{type:"range",value:f.progress,onChange:function(e){return b(Kc(Kc({},f),{},{progress:e.target.value}))}}),wp.element.createElement("span",{style:{width:"calc("+f.progress+"% - 10px)"}})),wp.element.createElement("span",null,f.progress," %"))),e.tasks?wp.element.createElement("div",{className:"new_card_field"},wp.element.createElement("label",null,window.vibeprojects.translations.select_dependencies),wp.element.createElement("div",{class:"taxonomy_field"},wp.element.createElement("div",{class:"selected_term_list_wrapper"},f.dependencies.length?wp.element.createElement("div",{class:"selected_term_list"},f.dependencies.map((function(t,n){if(e.tasks.findIndex((function(e){return e.id==t}))>-1&&(!f.hasOwnProperty("id")||t!=f.id))return wp.element.createElement("div",{class:"term_select",onClick:function(){var e=Kc({},f);e.dependencies.splice(n,1),b(e)}},wp.element.createElement("span",null,e.tasks[e.tasks.findIndex((function(e){return e.id==t}))].name))}))):""),wp.element.createElement("div",{class:"term_select"},wp.element.createElement("div",{class:"term_select_label"},window.vibeprojects.translations.set_dependencies,wp.element.createElement("i",{className:s?"vicon vicon-angle-down":"vicon vicon-angle-up","aria-hidden":"true",onClick:function(){return c(!s)}})),s?wp.element.createElement("div",{class:"search_term_list"},e.tasks.map((function(e){if(!f.dependencies.length||-1==f.dependencies.indexOf(e.id))return wp.element.createElement("div",{className:"search_term",onClick:function(){var t=Kc({},f);t.dependencies.push(e.id),b(t),c(!1)}},wp.element.createElement("span",null,e.name))}))):""))):"",wp.element.createElement("div",{className:"new_card_form_buttons"},wp.element.createElement("a",{className:"button is-primary",onClick:function(){return function(){var n=[];n="object"==td(p[0])?[Math.round(p[0].getTime()/1e3),Math.round(p[1].getTime()/1e3)]:[Math.round(new Date(p[0]).getTime()/1e3),Math.round(new Date(p[1]).getTime()/1e3)];var r,a=Kc(Kc({},f),{},{dates:n,project_id:e.project.id,token:ud("vibebp").getToken()});"card"==e.type&&(null!==(r=t.board.lists)&&void 0!==r&&r.length&&(a.list_id=t.board.lists[0].term_id),a.id&&(a.card_id=parseInt(a.id.split("_")[1])));fetch("".concat(dd,"/card/").concat("card"==e.type?"newcard":"newmilestone","/?post"),{method:"post",body:JSON.stringify(a)}).then((function(e){return e.json()})).then((function(t){t.status&&(e.update(t.card),e.close())}))}()}},f.hasOwnProperty("id")?window.vibeprojects.translations.save:"card"==e.type?window.vibeprojects.translations.add_new_card:window.vibeprojects.translations.add_milestones),wp.element.createElement("a",{className:"link",onClick:function(){return e.close()}},window.vibeprojects.translations.cancel)))});const fd={en:["January","February","March","April","May","June","July","August","September","October","November","December"],es:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],it:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],ru:["","","","","","","","","","","",""],ptBr:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],fr:["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],tr:["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],zh:["","","","","","","","","","","",""],de:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],hu:["Janur","Februr","Mrcius","prilis","Mjus","Jnius","Jlius","Augusztus","Szeptember","Oktber","November","December"]};var bd={parse(e,t="-",n=/[.:]/){if(e instanceof Date)return e;if("string"==typeof e){let r,a;const i=e.split(" ");r=i[0].split(t).map(e=>parseInt(e,10)),a=i[1]&&i[1].split(n),r[1]=r[1]-1;let o=r;return a&&a.length&&(4==a.length&&(a[3]="0."+a[3],a[3]=1e3*parseFloat(a[3])),o=o.concat(a)),new Date(...o)}},to_string(e,t=!1){if(!(e instanceof Date))throw new TypeError("Invalid argument type");const n=this.get_date_values(e).map((e,t)=>(1===t&&(e+=1),vd(e+"",6===t?3:2,"0"))),r=`${n[0]}-${n[1]}-${n[2]}`,a=`${n[3]}:${n[4]}:${n[5]}.${n[6]}`;return r+(t?" "+a:"")},format(e,t="YYYY-MM-DD HH:mm:ss.SSS",n="en"){const r=this.get_date_values(e).map(e=>vd(e,2,0)),a={YYYY:r[0],MM:vd(+r[1]+1,2,0),DD:r[2],HH:r[3],mm:r[4],ss:r[5],SSS:r[6],D:r[2],MMMM:fd[n][+r[1]],MMM:fd[n][+r[1]]};let i=t;const o=[];return Object.keys(a).sort((e,t)=>t.length-e.length).forEach(e=>{i.includes(e)&&(i=i.replace(e,"$"+o.length),o.push(a[e]))}),o.forEach((e,t)=>{i=i.replace("$"+t,e)}),i},diff(e,t,n="day"){let r,a,i,o,l,s,c;return r=e-t,a=r/1e3,o=a/60,i=o/60,l=i/24,s=l/30,c=s/12,n.endsWith("s")||(n+="s"),Math.floor({milliseconds:r,seconds:a,minutes:o,hours:i,days:l,months:s,years:c}[n])},today(){const e=this.get_date_values(new Date).slice(0,3);return new Date(...e)},now:()=>new Date,add(e,t,n){t=parseInt(t,10);const r=[e.getFullYear()+("year"===n?t:0),e.getMonth()+("month"===n?t:0),e.getDate()+("day"===n?t:0),e.getHours()+("hour"===n?t:0),e.getMinutes()+("minute"===n?t:0),e.getSeconds()+("second"===n?t:0),e.getMilliseconds()+("millisecond"===n?t:0)];return new Date(...r)},start_of(e,t){const n={year:6,month:5,day:4,hour:3,minute:2,second:1,millisecond:0};function r(e){return n[e]<=n[t]}const a=[e.getFullYear(),r("year")?0:e.getMonth(),r("month")?1:e.getDate(),r("day")?0:e.getHours(),r("hour")?0:e.getMinutes(),r("minute")?0:e.getSeconds(),r("second")?0:e.getMilliseconds()];return new Date(...a)},clone(e){return new Date(...this.get_date_values(e))},get_date_values:e=>(void 0===e&&(e=new Date),[e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()]),get_days_in_month(e){const t=[31,28,31,30,31,30,31,31,30,31,30,31],n=e.getMonth();if(1!==n)return t[n];const r=e.getFullYear();return r%4==0&&r%100!=0||r%400==0?29:28}};function vd(e,t,n){return e+="",t>>=0,n=String(void 0!==n?n:" "),e.length>t?String(e):((t-=e.length)>n.length&&(n+=n.repeat(t/n.length)),n.slice(0,t)+String(e))}function wd(e,t){return"string"==typeof e?(t||document).querySelector(e):e||null}function hd(e,t){const n=document.createElementNS("http://www.w3.org/2000/svg",e);for(let e in t)if("append_to"===e){t.append_to.appendChild(n)}else"innerHTML"===e?n.innerHTML=t.innerHTML:n.setAttribute(e,t[e]);return n}function yd(e,t,n,r){const a=function(e,t,n,r,a="0.4s",i="0.1s"){const o=e.querySelector("animate");if(o)return wd.attr(o,{attributeName:t,from:n,to:r,dur:a,begin:"click + "+i}),e;const l=hd("animate",{attributeName:t,from:n,to:r,dur:a,begin:i,calcMode:"spline",values:n+";"+r,keyTimes:"0; 1",keySplines:(s="ease-out",{ease:".25 .1 .25 1",linear:"0 0 1 1","ease-in":".42 0 1 1","ease-out":"0 0 .58 1","ease-in-out":".42 0 .58 1"}[s])});var s;return e.appendChild(l),e}(e,t,n,r);if(a===e){const e=document.createEvent("HTMLEvents");e.initEvent("click",!0,!0),e.eventName="click",a.dispatchEvent(e)}}wd.on=(e,t,n,r)=>{r?wd.delegate(e,t,n,r):(r=n,wd.bind(e,t,r))},wd.off=(e,t,n)=>{e.removeEventListener(t,n)},wd.bind=(e,t,n)=>{t.split(/\s+/).forEach((function(t){e.addEventListener(t,n)}))},wd.delegate=(e,t,n,r)=>{e.addEventListener(t,(function(e){const t=e.target.closest(n);t&&(e.delegatedTarget=t,r.call(this,e,t))}))},wd.closest=(e,t)=>t?t.matches(e)?t:wd.closest(e,t.parentNode):null,wd.attr=(e,t,n)=>{if(!n&&"string"==typeof t)return e.getAttribute(t);if("object"!=typeof t)e.setAttribute(t,n);else for(let n in t)wd.attr(e,n,t[n])};class gd{constructor(e,t){this.set_defaults(e,t),this.prepare(),this.draw(),this.bind()}set_defaults(e,t){this.action_completed=!1,this.gantt=e,this.task=t}prepare(){this.prepare_values(),this.prepare_helpers()}prepare_values(){this.invalid=this.task.invalid,this.height=this.gantt.options.bar_height,this.x=this.compute_x(),this.y=this.compute_y(),this.corner_radius=this.gantt.options.bar_corner_radius,this.duration=bd.diff(this.task._end,this.task._start,"hour")/this.gantt.options.step,this.width=this.gantt.options.column_width*this.duration,this.progress_width=this.gantt.options.column_width*this.duration*(this.task.progress/100)||0,this.group=hd("g",{class:"bar-wrapper "+(this.task.custom_class||""),"data-id":this.task.id}),this.bar_group=hd("g",{class:"bar-group",append_to:this.group}),this.handle_group=hd("g",{class:"handle-group",append_to:this.group})}prepare_helpers(){SVGElement.prototype.getX=function(){return+this.getAttribute("x")},SVGElement.prototype.getY=function(){return+this.getAttribute("y")},SVGElement.prototype.getWidth=function(){return+this.getAttribute("width")},SVGElement.prototype.getHeight=function(){return+this.getAttribute("height")},SVGElement.prototype.getEndX=function(){return this.getX()+this.getWidth()}}draw(){this.draw_bar(),this.draw_progress_bar(),this.draw_label(),this.draw_resize_handles()}draw_bar(){this.$bar=hd("rect",{x:this.x,y:this.y,width:this.width,height:this.height,rx:this.corner_radius,ry:this.corner_radius,class:"bar",append_to:this.bar_group}),yd(this.$bar,"width",0,this.width),this.invalid&&this.$bar.classList.add("bar-invalid")}draw_progress_bar(){if(this.invalid)return;let e="grad1";Math.round(100*this.progress_width/this.width,0)>10&&(e="grad2"),Math.round(100*this.progress_width/this.width,0)>25&&(e="grad3"),Math.round(100*this.progress_width/this.width,0)>50&&(e="grad4"),Math.round(100*this.progress_width/this.width,0)>75&&(e="grad5"),100==Math.round(100*this.progress_width/this.width,0)&&(e="grad6"),this.$bar_progress=hd("rect",{x:this.x,y:this.y,width:this.progress_width,height:this.height,rx:this.corner_radius,ry:this.corner_radius,fill:"url(#"+e+")",class:"bar-progress",append_to:this.bar_group}),yd(this.$bar_progress,"width",0,this.progress_width)}draw_label(){hd("text",{x:this.x+10,y:this.y+this.height/2,innerHTML:this.task.name,class:"bar-label",append_to:this.bar_group}),requestAnimationFrame(()=>this.update_label_position())}draw_resize_handles(){if(this.invalid)return;const e=this.$bar;hd("rect",{x:e.getX()+e.getWidth()-9,y:e.getY()+1,width:8,height:this.height-2,rx:this.corner_radius,ry:this.corner_radius,class:"handle right",append_to:this.handle_group}),hd("rect",{x:e.getX()+1,y:e.getY()+1,width:8,height:this.height-2,rx:this.corner_radius,ry:this.corner_radius,class:"handle left",append_to:this.handle_group}),this.task.progress&&this.task.progress<100&&(this.$handle_progress=hd("polygon",{points:this.get_progress_polygon_points().join(","),class:"handle progress",append_to:this.handle_group}))}get_progress_polygon_points(){const e=this.$bar_progress;return[e.getEndX()-5,e.getY()+e.getHeight(),e.getEndX()+5,e.getY()+e.getHeight(),e.getEndX(),e.getY()+e.getHeight()-8.66]}bind(){this.invalid||this.setup_click_event()}setup_click_event(){wd.on(this.group,"focus "+this.gantt.options.popup_trigger,e=>{this.action_completed||(this.show_popup(),this.gantt.unselect_all(),this.group.classList.add("active"))}),wd.on(this.group,"dblclick",e=>{this.action_completed||this.gantt.trigger_event("click",[this.task])})}show_popup(){if(this.gantt.bar_being_dragged)return;const e=bd.format(this.task._start,"MMM D",this.gantt.options.language)+" - "+bd.format(bd.add(this.task._end,-1,"second"),"MMM D",this.gantt.options.language);this.gantt.show_popup({target_element:this.$bar,title:this.task.name,subtitle:e,task:this.task})}update_bar_position({x:e=null,width:t=null}){const n=this.$bar;if(e){if(!this.task.dependencies.map(e=>this.gantt.get_bar(e).$bar.getX()).reduce((t,n)=>e>=n,e))return void(t=null);this.update_attr(n,"x",e)}t&&t>=this.gantt.options.column_width&&this.update_attr(n,"width",t),this.update_label_position(),this.update_handle_position(),this.update_progressbar_position(),this.update_arrow_position()}date_changed(){let e=!1;const{new_start_date:t,new_end_date:n}=this.compute_start_end_date();Number(this.task._start)!==Number(t)&&(e=!0,this.task._start=t),Number(this.task._end)!==Number(n)&&(e=!0,this.task._end=n),e&&this.gantt.trigger_event("date_change",[this.task,t,bd.add(n,-1,"second")])}progress_changed(){const e=this.compute_progress();this.task.progress=e,this.gantt.trigger_event("progress_change",[this.task,e])}set_action_completed(){this.action_completed=!0,setTimeout(()=>this.action_completed=!1,1e3)}compute_start_end_date(){const e=this.$bar,t=e.getX()/this.gantt.options.column_width,n=bd.add(this.gantt.gantt_start,t*this.gantt.options.step,"hour"),r=e.getWidth()/this.gantt.options.column_width;return{new_start_date:n,new_end_date:bd.add(n,r*this.gantt.options.step,"hour")}}compute_progress(){const e=this.$bar_progress.getWidth()/this.$bar.getWidth()*100;return parseInt(e,10)}compute_x(){const{step:e,column_width:t}=this.gantt.options,n=this.task._start,r=this.gantt.gantt_start;let a=bd.diff(n,r,"hour")/e*t;if(this.gantt.view_is("Month")){a=bd.diff(n,r,"day")*t/30}return a}compute_y(){return this.gantt.options.header_height+this.gantt.options.padding+this.task._index*(this.height+this.gantt.options.padding)}get_snap_position(e){let t,n,r=e;return this.gantt.view_is("Week")?(t=e%(this.gantt.options.column_width/7),n=r-t+(t<this.gantt.options.column_width/14?0:this.gantt.options.column_width/7)):this.gantt.view_is("Month")?(t=e%(this.gantt.options.column_width/30),n=r-t+(t<this.gantt.options.column_width/60?0:this.gantt.options.column_width/30)):(t=e%this.gantt.options.column_width,n=r-t+(t<this.gantt.options.column_width/2?0:this.gantt.options.column_width)),n}update_attr(e,t,n){return n=+n,isNaN(n)||e.setAttribute(t,n),e}update_progressbar_position(){this.invalid||(this.$bar_progress.setAttribute("x",this.$bar.getX()),this.$bar_progress.setAttribute("width",this.$bar.getWidth()*(this.task.progress/100)))}update_label_position(){const e=this.$bar,t=this.group.querySelector(".bar-label"),n=this.group.querySelectorAll(".bar-img");t.getBBox().width>e.getWidth()?(t.classList.add("big"),t.setAttribute("x",e.getX()+e.getWidth()+5)):(t.classList.remove("big"),t.setAttribute("x",e.getX()+e.getWidth()/2)),n.forEach((t,n)=>{t.getBBox().width>e.getWidth()?(t.classList.add("big"),t.setAttribute("x",e.getX()+e.getWidth()+5)):(t.classList.remove("big"),t.setAttribute("x",e.getX()+16))})}update_handle_position(){if(this.invalid)return;const e=this.$bar;this.handle_group.querySelector(".handle.left").setAttribute("x",e.getX()+1),this.handle_group.querySelector(".handle.right").setAttribute("x",e.getEndX()-9);const t=this.group.querySelector(".handle.progress");t&&t.setAttribute("points",this.get_progress_polygon_points())}update_arrow_position(){this.arrows=this.arrows||[];for(let e of this.arrows)e.update()}}class _d{constructor(e,t,n){this.gantt=e,this.from_task=t,this.to_task=n,this.calculate_path(),this.draw()}calculate_path(){let e=this.from_task.$bar.getX()+this.from_task.$bar.getWidth()/2;const t=()=>this.to_task.$bar.getX()<e+this.gantt.options.padding&&e>this.from_task.$bar.getX()+this.gantt.options.padding;for(;t();)e-=10;const n=this.gantt.options.header_height+this.gantt.options.bar_height+(this.gantt.options.padding+this.gantt.options.bar_height)*this.from_task.task._index+this.gantt.options.padding,r=this.to_task.$bar.getX()-this.gantt.options.padding/2,a=this.gantt.options.header_height+this.gantt.options.bar_height/2+(this.gantt.options.padding+this.gantt.options.bar_height)*this.to_task.task._index+this.gantt.options.padding,i=this.from_task.task._index>this.to_task.task._index,o=this.gantt.options.arrow_curve,l=i?1:0,s=i?-o:o,c=i?a+this.gantt.options.arrow_curve:a-this.gantt.options.arrow_curve;if(this.path=`\n            M ${e} ${n}\n            V ${c}\n            a ${o} ${o} 0 0 ${l} ${o} ${s}\n            L ${r} ${a}\n            m -5 -5\n            l 5 5\n            l -5 5`,this.to_task.$bar.getX()<this.from_task.$bar.getX()+this.gantt.options.padding){const t=this.gantt.options.padding/2-o,i=this.to_task.$bar.getY()+this.to_task.$bar.getHeight()/2-s,c=this.to_task.$bar.getX()-this.gantt.options.padding;this.path=`\n                M ${e} ${n}\n                v ${t}\n                a ${o} ${o} 0 0 1 -${o} ${o}\n                H ${c}\n                a ${o} ${o} 0 0 ${l} -${o} ${s}\n                V ${i}\n                a ${o} ${o} 0 0 ${l} ${o} ${s}\n                L ${r} ${a}\n                m -5 -5\n                l 5 5\n                l -5 5`}}draw(){this.progress_width,this.widt;let e="grad1";Math.round(100*this.from_task.progress_width/this.from_task.width,0)>10&&(e="grad2"),Math.round(100*this.from_task.progress_width/this.from_task.width,0)>25&&(e="grad3"),Math.round(100*this.from_task.progress_width/this.from_task.width,0)>50&&(e="grad4"),Math.round(100*this.from_task.progress_width/this.from_task.width,0)>75&&(e="grad5"),100==Math.round(100*this.from_task.progress_width/this.from_task.width,0)&&(e="grad6"),this.element=hd("path",{d:this.path,"data-from":this.from_task.task.id,"data-to":this.to_task.task.id,stroke:"url(#"+e+")"})}update(){this.calculate_path(),this.element.setAttribute("d",this.path)}}class Ed{constructor(e,t){this.parent=e,this.custom_html=t,this.make()}make(){this.parent.innerHTML='\n            <div class="title"></div>\n            <div class="subtitle"></div>\n            <div class="pointer"></div>\n        ',this.hide(),this.title=this.parent.querySelector(".title"),this.subtitle=this.parent.querySelector(".subtitle"),this.pointer=this.parent.querySelector(".pointer")}show(e){if(!e.target_element)throw new Error("target_element is required to show popup");e.position||(e.position="left");const t=e.target_element;if(this.custom_html){let t=this.custom_html(e.task);t+='<div class="pointer"></div>',this.parent.innerHTML=t,this.pointer=this.parent.querySelector(".pointer")}else this.title.innerHTML=e.title,this.subtitle.innerHTML=e.subtitle,this.parent.style.width=this.parent.clientWidth+"px";let n;t instanceof HTMLElement?n=t.getBoundingClientRect():t instanceof SVGElement&&(n=e.target_element.getBBox()),"left"===e.position&&(this.parent.style.left=n.x+(n.width+10)+"px",this.parent.style.top=n.y+"px",this.pointer.style.transform="rotateZ(90deg)",this.pointer.style.left="-7px",this.pointer.style.top="2px"),this.parent.style.opacity=1}hide(){this.parent.style.opacity=0,this.parent.style.left=0}}const jd={QUARTER_DAY:"Quarter Day",HALF_DAY:"Half Day",DAY:"Day",WEEK:"Week",MONTH:"Month",YEAR:"Year"};class Od{constructor(e,t,n){this.setup_wrapper(e),this.setup_options(n),this.setup_tasks(t),this.change_view_mode(),this.bind_events()}setup_wrapper(e){let t,n;if("string"==typeof e&&(e=document.querySelector(e)),e instanceof HTMLElement)n=e,t=e.querySelector("svg");else{if(!(e instanceof SVGElement))throw new TypeError("Frapp Gantt only supports usage of a string CSS selector, HTML DOM element or SVG DOM element for the 'element' parameter");t=e}t?(this.$svg=t,this.$svg.classList.add("gantt")):this.$svg=hd("svg",{append_to:n,class:"gantt"}),this.$container=document.createElement("div"),this.$container.classList.add("gantt-container");this.$svg.parentElement.appendChild(this.$container),this.$container.appendChild(this.$svg),this.popup_wrapper=document.createElement("div"),this.popup_wrapper.classList.add("popup-wrapper"),this.$container.appendChild(this.popup_wrapper)}setup_options(e){const t={header_height:50,column_width:30,step:24,view_modes:[...Object.values(jd)],bar_height:20,bar_corner_radius:3,arrow_curve:5,padding:18,view_mode:"Day",date_format:"YYYY-MM-DD",popup_trigger:"click",custom_popup_html:null,language:"en"};this.options=Object.assign({},t,e)}setup_tasks(e){this.tasks=e.map((e,t)=>{if(e._start=bd.parse(e.start),e._end=bd.parse(e.end),bd.diff(e._end,e._start,"year")>10&&(e.end=null),e._index=t,!e.start&&!e.end){const t=bd.today();e._start=t,e._end=bd.add(t,2,"day")}!e.start&&e.end&&(e._start=bd.add(e._end,-2,"day")),e.start&&!e.end&&(e._end=bd.add(e._start,2,"day"));if(bd.get_date_values(e._end).slice(3).every(e=>0===e)&&(e._end=bd.add(e._end,24,"hour")),e.start&&e.end||(e.invalid=!0),"string"==typeof e.dependencies||!e.dependencies){let t=[];e.dependencies&&(t=e.dependencies.split(",").map(e=>e.trim()).filter(e=>e)),e.dependencies=t}return e.id||(e.id=function(e){return e.name+"_"+Math.random().toString(36).slice(2,12)}(e)),e}),this.setup_dependencies()}setup_dependencies(){this.dependency_map={};for(let e of this.tasks)for(let t of e.dependencies)this.dependency_map[t]=this.dependency_map[t]||[],this.dependency_map[t].push(e.id)}refresh(e){this.setup_tasks(e),this.change_view_mode()}change_view_mode(e=this.options.view_mode){this.update_view_scale(e),this.setup_dates(),this.render(),this.trigger_event("view_change",[e])}update_view_scale(e){this.options.view_mode=e,e===jd.DAY?(this.options.step=24,this.options.column_width=38):e===jd.HALF_DAY?(this.options.step=12,this.options.column_width=38):e===jd.QUARTER_DAY?(this.options.step=6,this.options.column_width=38):e===jd.WEEK?(this.options.step=168,this.options.column_width=140):e===jd.MONTH?(this.options.step=720,this.options.column_width=120):e===jd.YEAR&&(this.options.step=8760,this.options.column_width=120)}setup_dates(){this.setup_gantt_dates(),this.setup_date_values()}setup_gantt_dates(){this.gantt_start=this.gantt_end=null;for(let e of this.tasks)(!this.gantt_start||e._start<this.gantt_start)&&(this.gantt_start=e._start),(!this.gantt_end||e._end>this.gantt_end)&&(this.gantt_end=e._end);this.gantt_start=bd.start_of(this.gantt_start,"day"),this.gantt_end=bd.start_of(this.gantt_end,"day"),this.view_is([jd.QUARTER_DAY,jd.HALF_DAY])?(this.gantt_start=bd.add(this.gantt_start,-7,"day"),this.gantt_end=bd.add(this.gantt_end,7,"day")):this.view_is(jd.MONTH)?(this.gantt_start=bd.start_of(this.gantt_start,"year"),this.gantt_end=bd.add(this.gantt_end,1,"year")):this.view_is(jd.YEAR)?(this.gantt_start=bd.add(this.gantt_start,-2,"year"),this.gantt_end=bd.add(this.gantt_end,2,"year")):(this.gantt_start=bd.add(this.gantt_start,-1,"month"),this.gantt_end=bd.add(this.gantt_end,1,"month"))}setup_date_values(){this.dates=[];let e=null;for(;null===e||e<this.gantt_end;)e=e?this.view_is(jd.YEAR)?bd.add(e,1,"year"):this.view_is(jd.MONTH)?bd.add(e,1,"month"):bd.add(e,this.options.step,"hour"):bd.clone(this.gantt_start),this.dates.push(e)}bind_events(){this.bind_grid_click(),this.bind_bar_events()}render(){this.clear(),this.setup_layers(),this.make_grid(),this.make_dates(),this.make_bars(),this.make_arrows(),this.map_arrows_on_bars(),this.set_width(),this.set_scroll_position()}setup_layers(){this.layers={};const e=["grid","date","arrow","progress","bar","details"];for(let t of e)this.layers[t]=hd("g",{class:t,append_to:this.$svg})}make_grid(){this.define_gradients(),this.make_grid_background(),this.make_grid_rows(),this.make_grid_header(),this.make_grid_ticks(),this.make_grid_highlights()}define_gradients(){const e=hd("defs",{append_to:this.layers.grid}),t=hd("linearGradient",{id:"grad2",x1:"0%",y1:"0%",x2:"100%",y2:"100%",append_to:e}),n=(hd("stop",{offset:"0%",style:"stop-color:rgb(241, 39, 17);stop-opacity:1",append_to:t}),hd("stop",{offset:"100%",style:"stop-color:rgb(245, 175, 25);stop-opacity:1",append_to:t}),hd("linearGradient",{id:"grad1",x1:"0%",y1:"0%",x2:"100%",y2:"100%",append_to:e})),r=(hd("stop",{offset:"0%",style:"stop-color:rgb(238, 156, 167);stop-opacity:1",append_to:n}),hd("stop",{offset:"100%",style:"stop-color:rgb(255, 221, 225);stop-opacity:1",append_to:n}),hd("linearGradient",{id:"grad3",x1:"0%",y1:"0%",x2:"100%",y2:"100%",append_to:e})),a=(hd("stop",{offset:"0%",style:"stop-color:rgb(17, 153, 142);stop-opacity:1",append_to:r}),hd("stop",{offset:"100%",style:"stop-color:rgb(56, 239, 125);stop-opacity:1",append_to:r}),hd("linearGradient",{id:"grad4",x1:"0%",y1:"0%",x2:"100%",y2:"100%",append_to:e})),i=(hd("stop",{offset:"0%",style:"stop-color:rgb(252, 234, 187);stop-opacity:1",append_to:a}),hd("stop",{offset:"100%",style:"stop-color:rgb(248, 181, 0);stop-opacity:1",append_to:a}),hd("linearGradient",{id:"grad5",x1:"0%",y1:"0%",x2:"100%",y2:"100%",append_to:e})),o=(hd("stop",{offset:"0%",style:"stop-color:rgb(127, 127, 213);stop-opacity:1",append_to:i}),hd("stop",{offset:"100%",style:"stop-color:rgb(134, 168, 231);stop-opacity:1",append_to:i}),hd("linearGradient",{id:"grad6",x1:"0%",y1:"0%",x2:"100%",y2:"100%",append_to:e}));hd("start",{offset:"0%",style:"stop-color:rgb(86, 171, 47);stop-opacity:1",append_to:o}),hd("stop",{offset:"100%",style:"stop-color:rgb(168, 224, 99);stop-opacity:1",append_to:o})}make_grid_background(){const e=this.dates.length*this.options.column_width,t=this.options.header_height+this.options.padding+(this.options.bar_height+this.options.padding)*this.tasks.length;hd("rect",{x:0,y:0,width:e,height:t,class:"grid-background",append_to:this.layers.grid}),wd.attr(this.$svg,{height:t+this.options.padding+100,width:"100%"})}make_grid_rows(){const e=hd("g",{append_to:this.layers.grid}),t=hd("g",{append_to:this.layers.grid}),n=this.dates.length*this.options.column_width,r=this.options.bar_height+this.options.padding;let a=this.options.header_height+this.options.padding/2;for(let i of this.tasks)hd("rect",{x:0,y:a,width:n,height:r,class:"grid-row",append_to:e}),hd("line",{x1:0,y1:a+r,x2:n,y2:a+r,class:"row-line",append_to:t}),a+=this.options.bar_height+this.options.padding}make_grid_header(){hd("rect",{x:0,y:0,width:this.dates.length*this.options.column_width,height:this.options.header_height+10,class:"grid-header",append_to:this.layers.grid})}make_grid_ticks(){let e=0,t=this.options.header_height+this.options.padding/2,n=(this.options.bar_height+this.options.padding)*this.tasks.length;for(let r of this.dates){let a="tick";this.view_is(jd.DAY)&&1===r.getDate()&&(a+=" thick"),this.view_is(jd.WEEK)&&r.getDate()>=1&&r.getDate()<8&&(a+=" thick"),this.view_is(jd.MONTH)&&r.getMonth()%3==0&&(a+=" thick"),hd("path",{d:`M ${e} ${t} v ${n}`,class:a,append_to:this.layers.grid}),this.view_is(jd.MONTH)?e+=bd.get_days_in_month(r)*this.options.column_width/30:e+=this.options.column_width}}make_grid_highlights(){if(this.view_is(jd.DAY)){hd("rect",{x:bd.diff(bd.today(),this.gantt_start,"hour")/this.options.step*this.options.column_width,y:0,width:this.options.column_width,height:(this.options.bar_height+this.options.padding)*this.tasks.length+this.options.header_height+this.options.padding/2,class:"today-highlight",append_to:this.layers.grid})}}make_dates(){for(let e of this.get_dates_to_draw())if(hd("text",{x:e.lower_x,y:e.lower_y,innerHTML:e.lower_text,class:"lower-text",append_to:this.layers.date}),e.upper_text){const t=hd("text",{x:e.upper_x,y:e.upper_y,innerHTML:e.upper_text,class:"upper-text",append_to:this.layers.date});t.getBBox().x2>this.layers.grid.getBBox().width&&t.remove()}}get_dates_to_draw(){let e=null;return this.dates.map((t,n)=>{const r=this.get_date_info(t,e,n);return e=t,r})}get_date_info(e,t,n){t||(t=bd.add(e,1,"year"));const r={"Quarter Day_lower":bd.format(e,"HH",this.options.language),"Half Day_lower":bd.format(e,"HH",this.options.language),Day_lower:e.getDate()!==t.getDate()?bd.format(e,"D",this.options.language):"",Week_lower:e.getMonth()!==t.getMonth()?bd.format(e,"D MMM",this.options.language):bd.format(e,"D",this.options.language),Month_lower:bd.format(e,"MMMM",this.options.language),Year_lower:bd.format(e,"YYYY",this.options.language),"Quarter Day_upper":e.getDate()!==t.getDate()?bd.format(e,"D MMM",this.options.language):"","Half Day_upper":e.getDate()!==t.getDate()?e.getMonth()!==t.getMonth()?bd.format(e,"D MMM",this.options.language):bd.format(e,"D",this.options.language):"",Day_upper:e.getMonth()!==t.getMonth()?bd.format(e,"MMMM",this.options.language):"",Week_upper:e.getMonth()!==t.getMonth()?bd.format(e,"MMMM",this.options.language):"",Month_upper:e.getFullYear()!==t.getFullYear()?bd.format(e,"YYYY",this.options.language):"",Year_upper:e.getFullYear()!==t.getFullYear()?bd.format(e,"YYYY",this.options.language):""},a={x:n*this.options.column_width,lower_y:this.options.header_height,upper_y:this.options.header_height-25},i={"Quarter Day_lower":4*this.options.column_width/2,"Quarter Day_upper":0,"Half Day_lower":2*this.options.column_width/2,"Half Day_upper":0,Day_lower:this.options.column_width/2,Day_upper:30*this.options.column_width/2,Week_lower:0,Week_upper:4*this.options.column_width/2,Month_lower:this.options.column_width/2,Month_upper:12*this.options.column_width/2,Year_lower:this.options.column_width/2,Year_upper:30*this.options.column_width/2};return{upper_text:r[this.options.view_mode+"_upper"],lower_text:r[this.options.view_mode+"_lower"],upper_x:a.x+i[this.options.view_mode+"_upper"],upper_y:a.upper_y,lower_x:a.x+i[this.options.view_mode+"_lower"],lower_y:a.lower_y}}make_bars(){this.bars=this.tasks.map(e=>{const t=new gd(this,e);return this.layers.bar.appendChild(t.group),t})}make_arrows(){this.arrows=[];for(let e of this.tasks){let t=[];t=e.dependencies.map(t=>{const n=this.get_task(t);if(!n)return;const r=new _d(this,this.bars[n._index],this.bars[e._index]);return this.layers.arrow.appendChild(r.element),r}).filter(Boolean),this.arrows=this.arrows.concat(t)}}map_arrows_on_bars(){for(let e of this.bars)e.arrows=this.arrows.filter(t=>t.from_task.task.id===e.task.id||t.to_task.task.id===e.task.id)}set_width(){const e=this.$svg.getBoundingClientRect().width,t=this.$svg.querySelector(".grid .grid-row").getAttribute("width");e<t&&this.$svg.setAttribute("width",t)}set_scroll_position(){const e=this.$svg.parentElement;if(!e)return;const t=bd.diff(this.get_oldest_starting_date(),this.gantt_start,"hour")/this.options.step*this.options.column_width-this.options.column_width;e.scrollLeft=t}bind_grid_click(){wd.on(this.$svg,this.options.popup_trigger,".grid-row, .grid-header",()=>{this.unselect_all(),this.hide_popup()})}bind_bar_events(){let e=!1,t=0,n=0,r=!1,a=!1,i=null,o=[];this.bar_being_dragged=null,wd.on(this.$svg,"mousedown",".bar-wrapper, .handle",(l,s)=>{const c=wd.closest(".bar-wrapper",s);s.classList.contains("left")?r=!0:s.classList.contains("right")?a=!0:s.classList.contains("bar-wrapper")&&(e=!0),c.classList.add("active"),t=l.offsetX,n=l.offsetY,i=c.getAttribute("data-id");const d=[i,...this.get_all_dependent_tasks(i)];o=d.map(e=>this.get_bar(e)),this.bar_being_dragged=i,o.forEach(e=>{const t=e.$bar;t.ox=t.getX(),t.oy=t.getY(),t.owidth=t.getWidth(),t.finaldx=0})}),wd.on(this.$svg,"mousemove",n=>{if(!(e||r||a))return;const l=n.offsetX-t;n.offsetY;o.forEach(t=>{if(t){const n=t.$bar;n.finaldx=this.get_snap_position(l),this.hide_popup(),r?i===t.task.id?t.update_bar_position({x:n.ox+n.finaldx,width:n.owidth-n.finaldx}):t.update_bar_position({x:n.ox+n.finaldx}):a?i===t.task.id&&t.update_bar_position({width:n.owidth+n.finaldx}):e&&t.update_bar_position({x:n.ox+n.finaldx})}})}),document.addEventListener("mouseup",t=>{(e||r||a)&&o.forEach(e=>e.group.classList.remove("active")),e=!1,r=!1,a=!1}),wd.on(this.$svg,"mouseup",e=>{this.bar_being_dragged=null,o.forEach(e=>{e.$bar.finaldx&&(e.date_changed(),e.set_action_completed())})}),this.bind_bar_progress()}bind_bar_progress(){let e=0,t=0,n=null,r=null,a=null,i=null;wd.on(this.$svg,"mousedown",".handle.progress",(o,l)=>{n=!0,e=o.offsetX,t=o.offsetY;const s=wd.closest(".bar-wrapper",l).getAttribute("data-id");r=this.get_bar(s),a=r.$bar_progress,i=r.$bar,a.finaldx=0,a.owidth=a.getWidth(),a.min_dx=-a.getWidth(),a.max_dx=i.getWidth()-a.getWidth()}),wd.on(this.$svg,"mousemove",t=>{if(!n)return;let i=t.offsetX-e;t.offsetY;i>a.max_dx&&(i=a.max_dx),i<a.min_dx&&(i=a.min_dx);const o=r.$handle_progress;wd.attr(a,"width",a.owidth+i),wd.attr(o,"points",r.get_progress_polygon_points()),a.finaldx=i}),wd.on(this.$svg,"mouseup",()=>{n=!1,a&&a.finaldx&&(r.progress_changed(),r.set_action_completed())})}get_all_dependent_tasks(e){let t=[],n=[e];for(;n.length;){const e=n.reduce((e,t)=>e=e.concat(this.dependency_map[t]),[]);t=t.concat(e),n=e.filter(e=>!n.includes(e))}return t.filter(Boolean)}get_snap_position(e){let t,n,r=e;return this.view_is(jd.WEEK)?(t=e%(this.options.column_width/7),n=r-t+(t<this.options.column_width/14?0:this.options.column_width/7)):this.view_is(jd.MONTH)?(t=e%(this.options.column_width/30),n=r-t+(t<this.options.column_width/60?0:this.options.column_width/30)):(t=e%this.options.column_width,n=r-t+(t<this.options.column_width/2?0:this.options.column_width)),n}unselect_all(){[...this.$svg.querySelectorAll(".bar-wrapper")].forEach(e=>{e.classList.remove("active")})}view_is(e){return"string"==typeof e?this.options.view_mode===e:!!Array.isArray(e)&&e.some(e=>this.options.view_mode===e)}get_task(e){return this.tasks.find(t=>t.id===e)}get_bar(e){return this.bars.find(t=>t.task.id===e)}show_popup(e){this.popup||(this.popup=new Ed(this.popup_wrapper,this.options.custom_popup_html)),this.popup.show(e)}hide_popup(){this.popup&&this.popup.hide()}trigger_event(e,t){this.options["on_"+e]&&this.options["on_"+e].apply(null,t)}get_oldest_starting_date(){return this.tasks.map(e=>e._start).reduce((e,t)=>t<=e?t:e)}clear(){this.$svg.innerHTML=""}}function kd(e){return function(e){if(Array.isArray(e))return Cd(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Id(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nd(Object(n),!0).forEach((function(t){Sd(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Sd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||Id(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Id(e,t){if(e){if("string"==typeof e)return Cd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cd(e,t):void 0}}function Cd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Od.VIEW_MODE=jd;var Ad=wp.element,Dd=(Ad.createElement,Ad.render,Ad.useState),Rd=Ad.useEffect,Td=Ad.Fragment,Md=Ad.useContext,Ud=Ad.useRef,$d=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",Ld=wp.data,Fd=Ld.select,Jd=Ld.dispatch,Hd=function(e){var t=Ud(null),n=Md(l),r=Pd(Dd(!1),2),a=r[0],i=r[1],o=Pd(Dd([]),2),s=o[0],c=o[1],d=Pd(Dd(!1),2),p=(d[0],d[1],Pd(Dd(null),2)),u=p[0],m=p[1],f=Pd(Dd("milestones"),2),b=(f[0],f[1],Pd(Dd({header_height:40,column_width:30,step:24,view_modes:["Quarter Day","Half Day","Day","Week","Month"],bar_height:70,bar_corner_radius:5,arrow_curve:15,padding:40,view_mode:"Day",date_format:"YYYY-MM-DD",custom_popup_html:function(){return""},draggable:H("create_project_milestones"),hasArrows:!0,on_date_change:function(e){e.dates=[Math.round(e._start.getTime()/1e3),Math.round(e._end.getTime()/1e3)],P(e,"dates")},on_progress_change:function(e){P(e,"progress")}}),2)),v=b[0],w=b[1],h=Pd(Dd(!1),2),y=h[0],g=h[1],_=Pd(Dd(!1),2),E=_[0],j=_[1],O=Pd(Dd(!0),2),k=O[0],N=O[1];Rd((function(){var e,t;null!==(e=n.board)&&void 0!==e&&null!==(t=e.cards)&&void 0!==t&&t.length||fetch("".concat(window.vibeprojects.apiUrl,"/board/getFullBoard/"),{method:"post",body:JSON.stringify({project_id:n.path.project,board_id:n.path.board,token:Fd("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&e.status&&(n.update("board",e.board),"undefined"!=typeof firebase&&void 0!==firebase.auth&&firebase.auth().currentUser&&(firebase.database().ref("/projects/".concat(n.path.project,"/boards/").concat(n.path.board)).set(xd(xd({},e.board),{},{time:(new Date).getTime()})),firebase.database().ref("users/".concat(Fd("vibebp").getUser().id,"/status")).set(1)))}))}),[]);var x=function(e){var t,n,r;if(e.name=e.title,null!==(t=e.badges)&&void 0!==t&&t.length&&e.badges.findIndex((function(e){return"duedate"==e.key}))>-1?e.end=e.badges[e.badges.findIndex((function(e){return"duedate"==e.key}))].date:e.end=(new Date).getFullYear()+"-"+(new Date).getMonth()+"-"+((new Date).getDate()+1),null!==(n=e.badges)&&void 0!==n&&n.length&&e.badges.findIndex((function(e){return"startdate"==e.key}))>-1)if(e.badges[e.badges.findIndex((function(e){return"startdate"==e.key}))].hasOwnProperty("date"))e.start=e.badges[e.badges.findIndex((function(e){return"startdate"==e.key}))].date;else{var a=new Date(1e3*parseInt(e.badges[e.badges.findIndex((function(e){return"startdate"==e.key}))].value));e.start=a.getFullYear()+"-"+a.getMonth()+"-"+a.getDate()}else e.start=(new Date).getFullYear()+"-"+(new Date).getMonth()+"-"+(new Date).getDate();return null!==(r=e.dependencies)&&void 0!==r&&r.length&&e.dependencies.map((function(t,n){-1==t.indexOf("card")&&(e.dependencies[n]="card_"+t)})),e};Rd((function(){var e,t;if(null!==(e=n.board)&&void 0!==e&&null!==(t=e.cards)&&void 0!==t&&t.length){var r=kd(n.board.cards);r.map((function(e,t){r[t]=x(e)})),c(r)}}),[n.board.cards]);var S=function(){E&&fetch("".concat($d,"/card/archive/").concat(E.card_id,"/action?post"),{method:"post",body:JSON.stringify({card:E,project_id:n.path.project,token:Fd("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){if(e.status){var t=kd(s);t.splice(t.findIndex((function(e){return e.card_id==E.card_id})),1),c(t);var r=xd({},n.board);r.cards.splice(r.cards.findIndex((function(e){return e.card_id==E.card_id})),1),r.lists.map((function(e,t){e.cards.indexOf(E.card_id)>-1&&(e.cards.splice(e.cards.indexOf(E.card_id),1),r.lists[t]=e)})),n.update("board",r),e.hasOwnProperty("message")&&Jd("vibebp").addNotification({icon:"vicon vicon-check",text:e.message})}}))},P=function(e,t){H("")&&fetch("".concat($d,"/card/updateTask/?post"),{method:"post",body:JSON.stringify({task:e,type:t,project_id:n.path.project,token:Fd("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){if(e.hasOwnProperty("message")&&Jd("vibebp").addNotification({text:e.message}),e.status){var t=kd(s),r=t.findIndex((function(t){return t.card_id==e.task.card_id}));if(r>-1){t.splice(r,1,x(e.task)),c(t);var a=xd({},n.board);a.cards=t,n.update("board",a)}}}))};Rd((function(){u&&s.length&&u.refresh(s)}),[s]),Rd((function(){if(t&&s.length)if(u)u.change_view_mode(v.view_mode);else{var e=new Od(t.current,s,v);m(e)}}),[t,v,s]);Rd((function(){var t;if(e.card&&null!==(t=n.path)&&void 0!==t&&t.board&&n.hasOwnProperty("boardFilters")&&n.hasOwnProperty("board")){var r=n.boardFilters,a=kd(s);s.map((function(e,t){var n,i,o;(Object.keys(ncard).length&&r.searchText.length&&e.hasOwnProperty("title")&&-1==e.title.indexOf(r.searchText)&&a.splice(t,1),Object.keys(ncard).length&&r.dates.length&&null!==(n=e.badges)&&void 0!==n&&n.length)&&(e.hasOwnProperty("badges")&&(null===(i=e.badges)||void 0===i?void 0:i.findIndex((function(e){return"duedate"==e.key})))>-1&&1e3*parseInt(e.badges[e.badges.findIndex((function(e){return"duedate"==e.key}))].value)>r.dates[0].getTime()&&1e3*parseInt(e.badges[e.badges.findIndex((function(e){return"duedate"==e.key}))].value)<r.dates[1].getTime()||a.splice(t,1));(Object.keys(ncard).length&&r.selectedMembers.length&&(flag=1,e.members.length&&r.selectedMembers.map((function(t){e.members.indexOf(t)>-1&&(flag=0)})),flag&&a.splice(t,1)),Object.keys(ncard).length&&r.selectedLabels.length)&&(flag=1,null!==(o=e.labels)&&void 0!==o&&o.length&&r.selectedLabels.map((function(t){e.labels.indexOf(t.id)>-1&&(flag=0)})),flag&&a.splice(t,1));Object.keys(ncard).length&&r.selectedStatus.length&&-1==r.selectedStatus.findIndex((function(t){return t.value==e.status}))&&a.splice(t,1),Object.keys(ncard).length&&r.hasOwnProperty("showCompleted")&&(r.showCompleted||e.hasOwnProperty("icons")&&e.icons.findIndex((function(e){return"complete"==e.key}))>-1&&a.splice(t,1)),Object.keys(ncard).length||a.splice(t,1)})),a.length!=s.length&&c(a)}}),[null==n?void 0:n.boardFilters]);return wp.element.createElement("div",{className:"project_gantt_wrapper"},y?wp.element.createElement(Mc,{card:xd(xd({},y),{},{title:y.name}),project_id:n.path.project,close:function(){return g(!1)}}):"",wp.element.createElement("div",{className:"gantt_wrapper"},k?wp.element.createElement("div",{className:"vibe_projects_gantt_chart_milestones"},wp.element.createElement("div",{className:"gant_button_wrapper"},wp.element.createElement("div",{className:"gant_chart_type_switcher"},H("create_project_milestones")?wp.element.createElement("a",{className:"active",onClick:function(){return i(!0)}},window.vibeprojects.translations.add_new_card):"",wp.element.createElement("a",{className:"tip",title:window.vibeprojects.translations.expand_tasks}," ",wp.element.createElement("span",{className:"vicon vicon-plus"})))),wp.element.createElement("div",{className:"gantt_chart_elements"},s.length?s.map((function(e,t){var n;return wp.element.createElement("div",{className:e.hasOwnProperty("parent")?"gantt_chart_element sub":"gantt_chart_element"},wp.element.createElement("div",{className:"gantt_chart_element_content"},E&&E.id==e.id?wp.element.createElement(Td,null,wp.element.createElement("span",{className:"delete_notice"},window.vibeprojects.translations.delete_milestone_message),wp.element.createElement("div",{className:"card_actions"},wp.element.createElement("a",{className:"button is-primary",onClick:S},window.vibeprojects.translations.delete),wp.element.createElement("a",{className:"link",onClick:function(){return j(!1)}},window.vibeprojects.translations.cancel))):wp.element.createElement(Td,null,wp.element.createElement("strong",{dangerouslySetInnerHTML:{__html:e.name}}),wp.element.createElement("span",{className:"progress_per "+(100==e.progress?"full":e.progress>75?"fourth_quarter":e.progress>50?"third_quarter":e.progress>25?"second_quarter":e.progress>0?"first_quarter":"zero")},e.progress+"%"),wp.element.createElement("div",{className:"date_range"},wp.element.createElement("span",{className:"vicon vicon-calendar"}),wp.element.createElement("span",null,function(e){var t=new Date(e.start),n=new Date(e.end);return t.getYear()!==n.getYear()?t.toDateString()+" - "+n.toDateString():t.getMonth()!==n.getMonth()?t.toLocaleString("default",{month:"short"})+", "+t.getDate()+" - "+n.toLocaleString("default",{month:"short"})+", "+n.getDate():t.getDate()+" - "+n.getDate()+", "+t.toLocaleString("default",{month:"short"})}(e))),null!==(n=e.children)&&void 0!==n&&n.length?wp.element.createElement("span",{className:"sub_tasks",onClick:function(){return showSubTasks(e)}},wp.element.createElement("span",null,e.children.length," ",window.vibeprojects.translations.tasks),wp.element.createElement("span",{className:"vicon vicon-plus"})):"",wp.element.createElement("div",{className:"card_actions"},wp.element.createElement("span",{className:"vicon vicon-eye",onClick:function(){var t=xd({},e);g(t)}}),H("create_card")?wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){i(e)}}):"",wp.element.createElement("span",{className:"vicon vicon-arrow-up",onClick:function(){var n,r=kd(s);r.splice(t,1),r.splice(t-1,0,e),n={start_card_id:e.card_id,start_card_order:t,end_card_id:s[t-1].card_id,end_card_order:t+1},fetch("".concat($d,"/card/updateMilestoneOrder/?post"),{method:"post",body:JSON.stringify({args:n,token:Fd("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&Jd("vibebp").addNotification({text:e.message})})),c(r)}}),H("delete_card")?wp.element.createElement("span",{className:"vicon vicon-trash",onClick:function(){return j(e)}}):""))))})):""),a?wp.element.createElement(md,{tasks:s,project:{id:n.path.project},type:"card",task:a,update:function(e){if(e){var t=kd(s),n=t.findIndex((function(t){return t.card_id==e.card_id}));n>-1?t.splice(n,1,x(e)):t.push(x(e)),c(t)}},close:function(){return i(!1)}}):""):"",wp.element.createElement("div",{className:"gantt_chart_wrapper"},wp.element.createElement("div",{className:"gantt_chart_header"},wp.element.createElement("strong",null,wp.element.createElement("span",{className:"hide_show_tasks vicon vicon-menu",onClick:function(){return N(!k)}}),window.vibeprojects.translations.tasks),wp.element.createElement("div",{className:"gannt_chart_switch_modes"},v.view_modes.map((function(e){return wp.element.createElement("a",{className:v.view_mode==e?"active":"",onClick:function(){return w(xd(xd({},v),{},{view_mode:e}))},title:e},e.substr(0,1))})))),wp.element.createElement("div",{className:"vibe_projects_gantt_Chart",ref:t}))))};function Yd(e){return function(e){if(Array.isArray(e))return Xd(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||zd(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vd(Object(n),!0).forEach((function(t){Wd(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Wd(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Gd(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||zd(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zd(e,t){if(e){if("string"==typeof e)return Xd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Xd(e,t):void 0}}function Xd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Bd=wp.element,Zd=(Bd.createElement,Bd.render,Bd.useState),Qd=Bd.useEffect,Kd=(Bd.Fragment,Bd.useContext),ep=(Bd.useRef,wp.data),tp=(ep.dispatch,ep.select),np=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",rp=function(e){var t,n=Kd(l),r=Gd(Zd({}),2),a=r[0],i=r[1],o=Gd(Zd(!1),2),s=o[0],c=o[1],d=Gd(Zd(!1),2),p=d[0],u=d[1],m=Gd(Zd({title:"",token:tp("vibebp").getToken()}),2),f=m[0],b=m[1],v=Gd(Zd([]),2),w=(v[0],v[1],Gd(Zd(!1),2)),h=(w[0],w[1],Gd(Zd(!1),2)),y=(h[0],h[1],Gd(Zd(!1),2)),g=(y[0],y[1],Gd(Zd(!1),2)),_=(g[0],g[1],Gd(Zd(null),2)),E=_[0],j=_[1];Qd((function(){i(e.list)}),[e.list]),Qd((function(){e.list&&e.list.hasOwnProperty("term_id")&&b(qd(qd({},f),{},{list_id:e.list.term_id}))}),[e.list]);return wp.element.createElement("div",{className:"list_wrapper"},wp.element.createElement("div",{className:"list"},wp.element.createElement("div",{className:"list_header",style:a.hasOwnProperty("color")?{background:a.color}:{}},wp.element.createElement("strong",null,"members"==e.activeParam?wp.element.createElement(I,{type:"member",id:{user_id:a.id}}):a.label)),wp.element.createElement("div",{className:"cards_container"},null!=a&&null!==(t=a.cards)&&void 0!==t&&t.length?a.cards.map((function(t,n){return wp.element.createElement("div",{className:"card_container"},wp.element.createElement(bn,{card:t,task:E,fields:e.fields}))})):""),s?wp.element.createElement("div",{className:"newcard_form"},wp.element.createElement("label",null,window.vibeprojects.translations.card_title),wp.element.createElement("input",{type:"text",value:f.title,placeholder:window.vibeprojects.translations.enter_card_title,onChange:function(e){b(qd(qd({},f),{},{title:e.target.value}))}}),wp.element.createElement("a",{className:p?"button is-primary is-loading":"button is-primary",onClick:function(){u(!0),fetch("".concat(np,"/card/newcard/?post"),{method:"post",body:JSON.stringify(qd(qd({},f),{},{type:e.activeParam,item_id:a.id},n.path))}).then((function(e){return e.json()})).then((function(e){if(u(!1),e.status){var t,r=qd({},n.board),o=-1;if(a.hasOwnProperty("term_id")&&null!=r&&null!==(t=r.lists)&&void 0!==t&&t.length&&(o=r.lists.findIndex((function(e){return e.term_id==a.term_id}))),o>-1)e.card.list={term_id:r.lists[o].term_id,name:r.lists[o].name},r.lists[o].hasOwnProperty("cards")||(r.lists[o].cards=[]),r.hasOwnProperty("cards")||(r.cards=[]),r.lists[o].cards.push(e.card.card_id),r.cards.push(e.card),j(e.card),n.update("board",r);else{var l=qd({},a);l.cards.push(e.card.card_id),i(l);var s=Yd(n.tasks);j(e.card),s.push(e.card),n.update("tasks",s)}b(qd(qd({},f),{},{title:""}))}c(!1)}))}},window.vibeprojects.translations.add_new_card),wp.element.createElement("a",{className:"vicon vicon-close",onClick:function(){c(!1)}})):wp.element.createElement("a",{className:"invisible_button is-loading",onClick:function(){c(!0)}},window.vibeprojects.translations.add_new_card)))};function ap(e){return function(e){if(Array.isArray(e))return dp(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||cp(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ip(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function op(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ip(Object(n),!0).forEach((function(t){lp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ip(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function lp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||cp(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cp(e,t){if(e){if("string"==typeof e)return dp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dp(e,t):void 0}}function dp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var pp=wp.element,up=(pp.createElement,pp.render,pp.useState),mp=pp.useEffect,fp=(pp.Fragment,pp.useContext),bp=pp.useRef,vp=wp.data,hp=vp.select,yp=(vp.dispatch,window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/"),gp=function(e){bp(null);var t,n=sp(up(null),2),r=n[0],a=n[1],i=fp(l),o=sp(up("list"),2),s=o[0],c=o[1],d=sp(up(window.vibeprojects.settings.board.listView.filter((function(e){return-1==["project"].indexOf(e.key)}))),2),p=d[0],u=d[1],m=sp(up(!1),2),f=m[0],b=m[1],v=sp(up(!1),2),w=v[0],h=v[1],y=sp(up({}),2),g=y[0],_=y[1],E=sp(up(!1),2),j=E[0],O=E[1];mp((function(){a(e.board)}),[e.board]);var k=[];if(r&&null!==(t=r.cards)&&void 0!==t&&t.length){var N,x;if("list"==s&&r.lists.map((function(e){k.push({id:e.term_id,label:e.name,cards:e.cards})})),"labels"==s&&null!==(N=r.labels)&&void 0!==N&&N.length)null===(x=r.labels)||void 0===x||x.map((function(e){k.push({id:e.id,label:e.label,color:e.color,cards:r.cards.filter((function(t){var n;return(null===(n=t.labels)||void 0===n?void 0:n.indexOf(e.id))>-1})).map((function(e){return e.card_id}))})}));if("status"==s&&window.vibeprojects.settings.statuses.card.map((function(e){k.push({id:e.value,label:e.label,color:e.color,cards:r.cards.filter((function(t){return t.status==e.value})).map((function(e){return e.card_id}))})})),"members"==s&&r.members.map((function(e){k.push({id:e,cards:r.cards.filter((function(t){return t.members.indexOf(e)>-1})).map((function(e){return e.card_id}))})})),"date"==s){var S=Math.round(new Date((new Date).getUTCFullYear()+"-"+((new Date).getUTCMonth()+1)+"-"+(new Date).getUTCDate()).getTime()/1e3),P=Math.round(new Date((new Date).getUTCFullYear()+"-"+((new Date).getUTCMonth()+1)+"-"+((new Date).getUTCDate()+2)).getTime()/1e3),I=Math.round(new Date((new Date).getUTCFullYear()+"-"+((new Date).getUTCMonth()+2)+"-1").getTime()/1e3);k.push({id:"today",label:window.vibeprojects.translations.due_today,cards:r.cards.filter((function(e){var t,n,r;return(null===(t=e.badges)||void 0===t?void 0:t.findIndex((function(e){return"duedate"==e.key})))>-1&&(null===(n=e.badges)||void 0===n?void 0:n.length)&&e.badges[null===(r=e.badges)||void 0===r?void 0:r.findIndex((function(e){return"duedate"==e.key}))].value<=S})).map((function(e){return e.card_id}))}),k.push({id:"tomorrow",label:window.vibeprojects.translations.due_tomorrow,cards:r.cards.filter((function(e){var t,n,r,a,i;return(null===(t=e.badges)||void 0===t?void 0:t.findIndex((function(e){return"duedate"==e.key})))>-1&&(null===(n=e.badges)||void 0===n?void 0:n.length)&&e.badges[null===(r=e.badges)||void 0===r?void 0:r.findIndex((function(e){return"duedate"==e.key}))].value>S&&(null===(a=e.badges[null===(i=e.badges)||void 0===i?void 0:i.findIndex((function(e){return"duedate"==e.key}))])||void 0===a?void 0:a.value)<=P})).map((function(e){return e.card_id}))}),k.push({id:"month",label:window.vibeprojects.translations.due_this_month,cards:r.cards.filter((function(e){var t,n,r,a,i;return(null===(t=e.badges)||void 0===t?void 0:t.findIndex((function(e){return"duedate"==e.key})))>-1&&(null===(n=e.badges)||void 0===n?void 0:n.length)&&e.badges[null===(r=e.badges)||void 0===r?void 0:r.findIndex((function(e){return"duedate"==e.key}))].value>P&&(null===(a=e.badges[null===(i=e.badges)||void 0===i?void 0:i.findIndex((function(e){return"duedate"==e.key}))])||void 0===a?void 0:a.value)<=I})).map((function(e){return e.card_id}))}),k.push({id:"later",label:window.vibeprojects.translations.due_later,cards:r.cards.filter((function(e){var t,n,r,a;return-1==(null===(t=e.badges)||void 0===t?void 0:t.findIndex((function(e){return"duedate"==e.key})))||(null===(n=e.badges)||void 0===n?void 0:n.length)&&(null===(r=e.badges[null===(a=e.badges)||void 0===a?void 0:a.findIndex((function(e){return"duedate"==e.key}))])||void 0===r?void 0:r.value)>I})).map((function(e){return e.card_id}))})}if("milestone"==s&&(k.push({id:1,label:window.vibeprojects.translations.milestone,cards:r.cards.filter((function(e){var t;return(null===(t=e.icons)||void 0===t?void 0:t.findIndex((function(e){return"milestone"==e.key})))>-1})).map((function(e){return e.card_id}))}),k.push({id:0,label:window.vibeprojects.translations.cards,cards:r.cards.filter((function(e){var t,n;return!(null!==(t=e.icons)&&void 0!==t&&t.length)||-1==(null===(n=e.icons)||void 0===n?void 0:n.findIndex((function(e){return"milestone"==e.key})))})).map((function(e){return e.card_id}))})),s&&p[p.findIndex((function(e){return e.key==s}))].hasOwnProperty("from")&&"meta"==p[p.findIndex((function(e){return e.key==s}))].from){var C=window.vibeprojects.settings.additional_fields.create_card_fields.findIndex((function(e){return e.key==s}));C>-1&&window.vibeprojects.settings.additional_fields.create_card_fields[C].options.map((function(e){k.push({id:e.value,label:e.label,cards:r.cards.filter((function(t){var n;return(null===(n=t.meta)||void 0===n?void 0:n.length)&&t.meta.findIndex((function(t){return t.meta_value==e.value}))>-1})).map((function(e){return e.card_id}))})}))}}return wp.element.createElement("div",{className:"list_view"},wp.element.createElement("div",{className:"list_view_header"},wp.element.createElement("div",{className:"card_fields"},p.filter((function(e){return e.selected&&e.key!=s})).map((function(e){return wp.element.createElement("div",{className:"card_field field_"+e.key,onClick:function(){e.required||(window.vibeprojects.settings.additional_fields.create_card_fields.findIndex((function(t){return t.key==e.key}))>-1?"select"==window.vibeprojects.settings.additional_fields.create_card_fields[window.vibeprojects.settings.additional_fields.create_card_fields.findIndex((function(t){return t.key==e.key}))].type&&c(e.key):c(e.key))}},wp.element.createElement("span",null,e.label))}))),j?wp.element.createElement("div",{className:"add_card_fields"},wp.element.createElement("span",{onClick:function(){return O(!1)},className:"vicon vicon-close"}),wp.element.createElement("div",{className:"all_card_fields"},p.map((function(e,t){if(e.key!=s)return wp.element.createElement("div",{className:"select_card_field"},wp.element.createElement("div",{className:"checkbox"},wp.element.createElement("input",{type:"checkbox",id:e.key,value:"1",checked:e.selected,onChange:function(){var e=ap(p);e[t].selected=!e[t].selected,u(e)}}),wp.element.createElement("label",{for:e.key},e.label)))})))):wp.element.createElement("span",{className:"tip bottom left",title:window.vibeprojects.translations.edit+" "+window.vibeprojects.translations.fields,onClick:function(){return O(!0)}},wp.element.createElement("span",{className:"vicon vicon-settings"}))),wp.element.createElement("div",{className:"list_view_boards"},null!=k&&k.length?k.map((function(e,t){return wp.element.createElement(rp,{activeParam:s,list:e,key:t,fields:p.filter((function(e){return e.selected>0&&s!=e.key}))})})):"",i.hasOwnProperty("path")&&i.path.hasOwnProperty("card")?wp.element.createElement(Mc,{close:function(){var e=op({},i.path);delete e.card,i.update("path",e)}}):"","list"==s?wp.element.createElement("div",{className:"list_wrapper"},f?wp.element.createElement("div",{className:"list_details"},wp.element.createElement("div",{className:"vibe_projects_new_list_form"},wp.element.createElement("div",{className:"vibe_projects_field"},wp.element.createElement("input",{type:"text",value:g.name,onChange:function(e){_(op(op({},g),{},{name:e.target.value}))},placeholder:window.vibeprojects.translations.list_name})),wp.element.createElement("div",{className:"vibe_projects_form_actions"},wp.element.createElement("a",{className:w?"button is-primary is-loading":"button is-primary",onClick:function(){b(!1),h(!0),fetch("".concat(yp,"/newlist/").concat(i.path.board,"/?force"),{method:"post",body:JSON.stringify(op(op({},g),{},{token:hp("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){if(h(!1),e.status){var t,n,r=[];null!==(t=i.board)&&void 0!==t&&null!==(n=t.lists)&&void 0!==n&&n.length&&(r=i.board.lists),r.push(e.listdetails),i.update("board",op(op({},i.board),{},{lists:r})),_({})}}))}},window.vibeprojects.translations.add_new_list),wp.element.createElement("a",{className:"vicon vicon-close",onClick:function(){b(!1)}})))):wp.element.createElement("a",{className:"invisible_button is-loading",onClick:function(){b(!0)}},window.vibeprojects.translations.add_new_list)):""))};var _p=wp.data,Ep=(_p.dispatch,_p.select,wp.element);Ep.createElement,Ep.render,Ep.useState,Ep.useEffect,Ep.Fragment,Ep.useContext,window.vibeprojects&&window.vibeprojects.apiUrl;var jp=wp.element;jp.createElement,jp.render,jp.useState,jp.useEffect,jp.Fragment,jp.useContext,window.vibeprojects&&window.vibeprojects.apiUrl;function Op(e){return function(e){if(Array.isArray(e))return Ip(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Pp(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Np(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kp(Object(n),!0).forEach((function(t){xp(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function xp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Sp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||Pp(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pp(e,t){if(e){if("string"==typeof e)return Ip(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ip(e,t):void 0}}function Ip(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Cp=wp.element,Ap=(Cp.createElement,Cp.render,Cp.useState),Dp=Cp.useEffect,Rp=(Cp.Fragment,Cp.useContext),Tp=Cp.useRef,Mp=wp.data,Up=(Mp.select,Mp.dispatch,function(e){var t=Rp(l),n=Tp(null),r=Tp(null),a=Sp(Ap({}),2),i=a[0],o=a[1],s=Sp(Ap(!1),2),c=s[0],d=s[1],p=Sp(Ap([]),2),u=(p[0],p[1],Sp(Ap(!1),2)),m=u[0],f=u[1],b=Sp(Ap(!1),2),v=b[0],w=b[1],h=Sp(Ap(""),2),y=(h[0],h[1],Sp(Ap([]),2)),g=y[0],_=y[1],E=Sp(Ap(!1),2),j=E[0],O=E[1],k=Sp(Ap({selectedStatus:[],selectedMembers:[],selectedLabels:[],dates:[],searchText:"",selectedCustomFields:[],showCompleted:!0,showUnlisted:!1}),2),N=k[0],x=k[1],S=Sp(Ap(null),2),P=S[0],A=S[1];return Dp((function(){var e;if(null!==(e=t.board)&&void 0!==e&&e.lists){o(t.board);window.vibeprojects.settings.additional_fields.create_card_fields.length&&window.vibeprojects.settings.additional_fields.create_card_fields.map((function(e){e.type}))}}),[t.board]),Dp((function(){var e=function(e){n.current.contains(e.target)||(d(!1),w(!1),f(!1),_(!1))};return n&&(v||c||m||j)&&document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[n,v,c,m,j]),Dp((function(){if(r&&"undefined"!=typeof flatpickr&&r.hasOwnProperty("current")&&r.current){P&&N.dates.length&&P.destroy();var e={altInput:!0,mode:"range",dateFormat:"Y-m-d",defaultDate:N.dates,minDate:new Date((new Date).setDate((new Date).getDate()-30)),onChange:function(e){x(Np(Np({},N),{},{dates:e}))}},t=flatpickr(r.current,e);A(t)}return function(){P&&P.destroy()}}),[r]),Dp((function(){t.update("boardFilters",N)}),[N]),Dp((function(){!N||t.hasOwnProperty("boardFilters")&&t.boardFilters==N||t.update("boardFilters",N)}),[t.boardFilters]),wp.element.createElement("div",{className:"board_filters",ref:n},wp.element.createElement("strong",null,window.vibeprojects.translations.filter_by),wp.element.createElement("div",null,wp.element.createElement("div",{className:"board_options_wrapper"},wp.element.createElement("input",{type:"text",ref:r,placeholder:window.vibeprojects.translations.filter_dates}),wp.element.createElement("span",{className:N.dates.length?"vicon vicon-close":"vicon vicon-calendar",onClick:function(){return x(Np(Np({},N),{},{dates:[]}))}})),i.hasOwnProperty("members")&&i.members.length?wp.element.createElement("div",{className:N.selectedMembers.length?"board_options_wrapper active":"board_options_wrapper"},N.selectedMembers.length?wp.element.createElement("div",{className:"selected_options"},wp.element.createElement(C,{user_ids:N.selectedMembers},N.selectedMembers.map((function(e,t){return wp.element.createElement("span",{className:"selected_option",onClick:function(){var e=Op(N.selectedMembers);e.splice(t,1),x(Np(Np({},N),{},{selectedMmebers:e})),e.length||w(!1)}},wp.element.createElement(I,{type:"user",id:{user_id:e}}))})))):"",wp.element.createElement("span",{className:v?"board_icon active":"board_icon",onClick:function(){return w(!v)}},wp.element.createElement("span",null,window.vibeprojects.translations.filter_members),wp.element.createElement("span",{className:N.selectedMembers.length?"vicon vicon-close":"vicon vicon-user",onClick:function(){return x(Np(Np({},N),{},{selectedMembers:[]}))}})),v&&i.members.length>N.selectedMembers.length?wp.element.createElement("div",{className:"board_options"},wp.element.createElement(C,{user_ids:i.members},i.members.map((function(e){if(-1==N.selectedMembers.indexOf(e))return wp.element.createElement("span",{className:"board_option",onClick:function(){var t=Op(N.selectedMembers);t.push(e),x(Np(Np({},N),{},{selectedMembers:t}))}},wp.element.createElement(I,{type:"user",id:{user_id:e}}))})))):""):"",i.hasOwnProperty("labels")&&i.labels.length?wp.element.createElement("div",{className:N.selectedLabels.length?"board_options_wrapper card_labels active":"board_options_wrapper card_labels"},N.selectedLabels.length?wp.element.createElement("div",{className:"selected_options"},N.selectedLabels.map((function(e,t){return wp.element.createElement("span",{className:"selected_option",style:{background:e.color},onClick:function(){var e=Op(N.selectedLabels);e.splice(t,1),x(Np(Np({},N),{},{selectedLabels:e})),e.length||d(!1)}},e.label)}))):"",wp.element.createElement("span",{className:c?"board_icon active":"board_icon",onClick:function(){return d(!c)}},wp.element.createElement("span",null,window.vibeprojects.translations.filter_labels),wp.element.createElement("span",{className:N.selectedLabels.length?"vicon vicon-close":"vicon vicon-tag",onClick:function(){return x(Np(Np({},N),{},{selectedLabels:[]}))}})),c&&N.selectedLabels.length<i.labels.length?wp.element.createElement("div",{className:"board_options"},i.labels.length>10?wp.element.createElement("span",null,wp.element.createElement("input",{type:"text",placeholder:windows.vibeprojects.translations.search_label,value:searchLabelsText}),wp.element.createElement("span",{className:"vicon vicon-search"})):"",i.labels.map((function(e){if(-1==N.selectedLabels.indexOf(e))return wp.element.createElement("span",{className:"board_option",style:{background:e.color},onClick:function(){var t=Op(N.selectedLabels);t.push(e),x(Np(Np({},N),{},{selectedLabels:t}))}},e.label)}))):""):"",wp.element.createElement("div",{className:N.selectedStatus.length?"board_options_wrapper active card_status":"board_options_wrapper card_status"},N.selectedStatus.length?wp.element.createElement("div",{className:"selected_options"},N.selectedStatus.map((function(e,t){return wp.element.createElement("span",{className:"selected_option",style:{background:e.color},onClick:function(){var e=Op(N.selectedStatus);e.splice(t,1),x(Np(Np({},N),{},{selectedStatus:e})),e.length||f(!1)}},e.label)}))):"",wp.element.createElement("span",{className:m?"board_icon active":"board_icon ",onClick:function(){return f(!m)}},wp.element.createElement("span",null,window.vibeprojects.translations.filter_status),wp.element.createElement("span",{className:N.selectedStatus.length?"vicon vicon-close":"vicon vicon-package",onClick:function(){return x(Np(Np({},N),{},{selectedStatus:[]}))}})),m&&N.selectedStatus.length<window.vibeprojects.settings.statuses.card.length?wp.element.createElement("div",{className:"board_options"},window.vibeprojects.settings.statuses.card.map((function(e){if(-1==N.selectedStatus.findIndex((function(t){return t.vaue==e.value})))return wp.element.createElement("span",{className:"board_option",style:{background:e.color},onClick:function(){var t=Op(N.selectedStatus);t.push(e),x(Np(Np({},N),{},{selectedStatus:t}))}},e.label)}))):""),g.length?wp.element.createElement("div",{className:N.selectedCustomFields.length?"board_options_wrapper active":"board_options_wrapper"},N.selectedCustomFields.length?wp.element.createElement("div",{className:"selected_options"},N.selectedCustomFields.map((function(e,t){return wp.element.createElement("span",{className:"selected_option",onClick:function(){var e=Op(N.selectedCustomFields);e.splice(t,1),x(Np(Np({},N),{},{selectedCustomFields:e})),e.length||O(!1)}},e.label)}))):"",wp.element.createElement("span",{className:j?"board_icon active":"board_icon",onClick:function(){return O(!j)}},wp.element.createElement("span",null,window.vibeprojects.translations.fields),wp.element.createElement("span",{className:N.selectedCustomFields.length?"vicon vicon-close":"vicon vicon-agenda",onClick:function(){return x(Np(Np({},N),{},{selectedCustomFields:[]}))}})),j&&g.length>N.selectedCustomFields.length?wp.element.createElement("div",{className:"board_options"},g.map((function(e){if(-1==N.selectedCustomFields.indexOf(e))return wp.element.createElement("span",{className:"board_option",onClick:function(){var t=Op(N.selectedCustomFields);t.push(e),x(Np(Np({},N),{},{selectedCustomFields:t}))}},e.label)}))):""):"",wp.element.createElement("div",{className:"board_options_wrapper"},wp.element.createElement("span",{className:"tip",title:N.showCompleted?window.vibeprojects.translations.hide_completed:window.vibeprojects.translations.show_completed}," ",wp.element.createElement("span",{className:N.showCompleted?"vicon vicon-check-box":"vicon vicon-check",onClick:function(){return x(Np(Np({},N),{},{showCompleted:!N.showCompleted}))}}))),e.displaytype&&"boards"!=e.displaytype?"":wp.element.createElement("div",{className:"board_options_wrapper"},wp.element.createElement("span",{className:"tip",title:N.showUnlisted?window.vibeprojects.translations.hide_unlisted:window.vibeprojects.translations.show_unlisted}," ",wp.element.createElement("span",{className:N.showUnlisted?"vicon vicon-link":"vicon vicon-unlink",onClick:function(){return x(Np(Np({},N),{},{showUnlisted:!N.showUnlisted}))}}))),wp.element.createElement("div",{className:"search_wrapper board_options_wrapper"},wp.element.createElement("input",{type:"text",value:N.searchText.trimStart(),onChange:function(e){return x(Np(Np({},N),{},{searchText:e.target.value}))},placeholder:window.vibeprojects.translations.search_task}),wp.element.createElement("span",{className:N.searchText.length>1?"vicon vicon-close":"vicon vicon-search",onClick:function(){return x(Np(Np({},N),{},{searchText:" "}))}}))))});function $p(e){return function(e){if(Array.isArray(e))return Jp(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Fp(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lp(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||Fp(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fp(e,t){if(e){if("string"==typeof e)return Jp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Jp(e,t):void 0}}function Jp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Hp=wp.element,Yp=(Hp.createElement,Hp.render,Hp.useState),Vp=Hp.useEffect,qp=Hp.Fragment,Wp=Hp.useContext,Gp=Hp.useRef,zp=wp.data,Xp=zp.select,Bp=zp.dispatch,Zp=function(e){var t=Wp(l),n=Gp(null),r=Gp(null),a=Lp(Yp({}),2),i=a[0],o=a[1],s=Lp(Yp(!1),2),c=s[0],d=s[1],p=Lp(Yp([]),2),u=p[0],m=p[1],f=Lp(Yp(!1),2),b=f[0],v=f[1],w=Lp(Yp(null),2),h=w[0],y=w[1],g=Lp(Yp(!1),2),_=g[0],E=g[1],j=Lp(Yp([]),2),O=j[0],k=j[1],N=Lp(Yp(""),2),x=(N[0],N[1]),S=Lp(Yp(!1),2),P=S[0],A=S[1],D=Lp(Yp([]),2),R=D[0],T=D[1],M=Lp(Yp(""),2),U=(M[0],M[1]),$=Lp(Yp(!1),2),L=$[0],F=$[1],J=Lp(Yp(null),2),H=J[0],Y=J[1],V=Lp(Yp(!1),2),q=V[0],W=V[1],G=Lp(Yp([]),2),z=G[0],X=G[1],B=Lp(Yp(!1),2),Z=B[0],Q=B[1],K=Lp(Yp(0),2),ee=K[0],te=K[1],ne=Lp(Yp([]),2),re=ne[0],ae=ne[1];Vp((function(){t.hasOwnProperty("board")&&o(t.board)}),[t.board]),Vp((function(){var e;return null!==(e=t.selectedCards)&&void 0!==e&&e.length&&X(t.selectedCards),function(){t.update("remove","selectedCards")}}),[t.selectedCards]),Vp((function(){var e=function(e){r.current.contains(e.target)||(d(!1),E(!1),v(!1))};return r&&(_||c||b)&&document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[r,_,c,b]),Vp((function(){q.length&&t.update("bulkAction",q)}),[q]),Vp((function(){if(n&&"undefined"!=typeof flatpickr&&n.hasOwnProperty("current")&&n.current){H&&L&&H.destroy();var e={altInput:!0,mode:"single",dateFormat:"Y-m-d",defaultDate:L,minDate:new Date((new Date).setDate((new Date).getDate()-30)),onChange:function(e){F(e)}},t=flatpickr(n.current,e);Y(t)}return function(){H&&H.destroy()}}),[n]),Vp((function(){"assign_milestone"==q&&fetch("".concat(window.vibeprojects.apiUrl,"/project/milestones/get/"),{method:"post",body:JSON.stringify({project_id:t.path.project,token:Xp("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){Q(!1),e.status&&ae(e.milestones)}))}),[q]);return wp.element.createElement("div",{className:"bulk_actions",ref:r},wp.element.createElement("strong",null,window.vibeprojects.translations.bulk_actions),wp.element.createElement("select",{value:q,onChange:function(e){return W(e.target.value)}},wp.element.createElement("option",null,window.vibeprojects.translations.bulk_actions_tip),window.vibeprojects.settings.board.bulk_actions.map((function(e){return wp.element.createElement("option",{value:e.value},e.label)}))),"add_member"==q||"remove_member"==q?wp.element.createElement(qp,null,i.hasOwnProperty("members")&&i.members.length?wp.element.createElement("div",{className:O.length?"board_options_wrapper active":"board_options_wrapper"},O.length?wp.element.createElement("div",{className:"selected_options"},wp.element.createElement(C,{user_ids:O},O.map((function(e,t){return wp.element.createElement("span",{className:"selected_option",onClick:function(){var e=$p(O);e.splice(t,1),k(e),e.length||E(!1)}},wp.element.createElement(I,{type:"user",id:{user_id:e}}))})))):"",wp.element.createElement("span",{className:_?"board_icon active":"board_icon",onClick:function(){return E(!_)}},wp.element.createElement("span",null,window.vibeprojects.translations.filter_members),wp.element.createElement("span",{className:"vicon vicon-user"})),_&&i.members.length>O.length?wp.element.createElement("div",{className:"board_options"},wp.element.createElement(C,{user_ids:i.members},i.members.map((function(e){if(-1==O.indexOf(e))return wp.element.createElement("span",{className:"board_option",onClick:function(){return k([].concat($p(O),[e]))}},wp.element.createElement(I,{type:"user",id:{user_id:e}}))})))):""):wp.element.createElement("div",{className:"vbp_message"},window.vibeprojects.translations.no_members_found)):"add_label"==q||"remove_label"==q?wp.element.createElement(qp,null,i.hasOwnProperty("labels")&&i.labels.length?wp.element.createElement("div",{className:u.length?"board_options_wrapper card_labels active":"board_options_wrapper card_labels"},u.length?wp.element.createElement("div",{className:"selected_options"},u.map((function(e,t){return wp.element.createElement("span",{className:"selected_option",style:{background:e.color},onClick:function(){var e=$p(u);e.splice(t,1),m(e),e.length||d(!1)}},e.label)}))):"",wp.element.createElement("span",null,wp.element.createElement("span",{onClick:function(){return d(!c)}},window.vibeprojects.translations.filter_labels),wp.element.createElement("span",{className:" vicon vicon-tag"})),c&&u.length<i.labels.length?wp.element.createElement("div",{className:"board_options"},i.labels.length>10?wp.element.createElement("span",null,wp.element.createElement("input",{type:"text",placeholder:windows.vibeprojects.translations.search_label,value:searchLabelsText}),wp.element.createElement("span",{className:"vicon vicon-search"})):"",i.labels.map((function(e){if(-1==u.indexOf(e))return wp.element.createElement("span",{className:"board_option",style:{background:e.color},onClick:function(){return m([].concat($p(u),[e]))}},e.label)}))):""):wp.element.createElement("div",{className:"vbp_message"},window.vibeprojects.translations.no_labels_found)):"change_status"==q?wp.element.createElement("div",{className:h?"board_options_wrapper active card_status":"board_options_wrapper card_status"},h?wp.element.createElement("div",{className:"selected_options"},wp.element.createElement("span",{className:"selected_option",style:{background:h.color},onClick:function(){return y(!1)}},h.label)):"",wp.element.createElement("span",{className:b?"board_icon active":"board_icon ",onClick:function(){return v(!b)}},wp.element.createElement("span",null,window.vibeprojects.translations.filter_status),wp.element.createElement("span",{className:"vicon vicon-package"})),wp.element.createElement("div",{className:"board_options"},window.vibeprojects.settings.statuses.card.map((function(e){if(!h||h.value!=e.value)return wp.element.createElement("span",{className:"board_option",style:{background:e.color},onClick:function(){return y([].concat($p(h),[e]))}},e.label)})))):"change_due_date"==q?wp.element.createElement("div",{className:"board_options_wrapper"},wp.element.createElement("input",{type:"text",ref:n,placeholder:window.vibeprojects.translations.filter_dates}),wp.element.createElement("span",{className:"vicon vicon-calendar"})):"watch_cards"==q?wp.element.createElement(qp,null,i.hasOwnProperty("members")&&i.members.length?wp.element.createElement("div",{className:R.length?"board_options_wrapper active":"board_options_wrapper"},R.length?wp.element.createElement("div",{className:"selected_options"},wp.element.createElement(C,{user_ids:R},R.map((function(e,t){return wp.element.createElement("span",{className:"selected_option",onClick:function(){var e=$p(R);e.splice(t,1),T(e),e.length||A(!1)}},wp.element.createElement(I,{type:"user",id:{user_id:e}}))})))):"",wp.element.createElement("span",{className:P?"board_icon active":"board_icon",onClick:function(){return A(!P)}},wp.element.createElement("span",null,window.vibeprojects.translations.filter_members),wp.element.createElement("span",{className:"vicon vicon-user"})),P&&i.members.length>R.length?wp.element.createElement("div",{className:"board_options"},wp.element.createElement(C,{user_ids:i.members},i.members.map((function(e){if(-1==R.indexOf(e))return wp.element.createElement("span",{className:"board_option",onClick:function(){return T([].concat($p(R),[e]))}},wp.element.createElement(I,{type:"user",id:{user_id:e}}))})))):""):wp.element.createElement("div",{className:"vbp_message"},window.vibeprojects.translations.no_members_found)):"assign_milestone"==q?wp.element.createElement(qp,null,re.length?wp.element.createElement("select",{value:ee,onChange:function(e){return te(e.target.value)}},wp.element.createElement("option",null,window.vibeprojects.translations.select_milestone),re.map((function(e){return wp.element.createElement("option",{value:e.card_id},e.title)}))):wp.element.createElement("div",{className:"vbp_message"},window.vibeprojects.translations.no_milestones)):"",z.length?wp.element.createElement("span",null,z.length," ",window.vibeprojects.translations.cards_selected," ",wp.element.createElement("span",{className:"vicon vicon-trash",onClick:function(){return t.update("remove","selectedCards")}})):wp.element.createElement("div",{className:"vbp_message"},window.vibeprojects.translations.select_cards),q&&z.length?wp.element.createElement("div",{className:"apply_bulk_actions"},wp.element.createElement("a",{className:Z?"button is-primary is-loading":"button is-primary",onClick:function(){Q(!0);var e=null;"add_member"==q&&(e=$p(O)),"add_label"==q&&(e=$p(u)),"change_Status"==q&&(e=h),"assign_milestone"==q&&(e=ee),"change_due_date"==q&&(e=Math.round(L.getTime()/1e3)),e?fetch("".concat(window.vibeprojects.apiUrl,"/project/board/bulkAction/"),{method:"post",body:JSON.stringify({project_id:t.path.project,board_id:t.path.board,bulkAction:q,data:e,selectedCards:z,token:Xp("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){Q(!1),Bp("vibebp").addNotification({text:e.message})})):(Q(!1),Bp("vibebp").addNotification({text:window.vibeprojects.translations.data_missing}))}},window.vibeprojects.translations.apply),wp.element.createElement("a",{className:"link",onClick:function(){X([]),W(null),m([]),F(!1),y(!1),k([]),x(""),T([]),U(""),te(0),t.update("remove","bulkAction"),e.close()}},window.vibeprojects.translations.cancel)):"")};function Qp(e){return(Qp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function eu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Kp(Object(n),!0).forEach((function(t){tu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function tu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nu(e){return function(e){if(Array.isArray(e))return iu(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||au(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ru(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||au(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function au(e,t){if(e){if("string"==typeof e)return iu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?iu(e,t):void 0}}function iu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var ou=wp.element,lu=(ou.createElement,ou.render,ou.useState),su=ou.useEffect,cu=ou.Fragment,du=ou.useContext,pu=(ou.useRef,wp.data),uu=pu.select,mu=pu.dispatch,fu=function(e){var t,n,r=du(l),a=ru(lu(!0),2),i=a[0],o=a[1],s=ru(lu(!1),2),c=(s[0],s[1],ru(lu({when:{key:"",value:""},then:{key:"",value:""}}),2)),d=c[0],p=c[1],u=ru(lu([]),2),m=u[0],f=u[1],b=ru(lu(!1),2),v=b[0],w=b[1],h=ru(lu([]),2),y=h[0],g=h[1],_=ru(lu(!1),2),E=_[0],j=_[1],O=ru(lu(!1),2),k=O[0],N=O[1];su((function(){if(r.hasOwnProperty("board")){var e=[],t=[],n=[];r.board.members.map((function(e){t.push(localforage.getItem("user_"+e).then((function(t){t=JSON.parse(t),n.push({value:e,label:t.name})})))})),f(r.board.automations),Promise.all(t).then((function(){window.vibeprojects.settings.board.automations.map((function(t){if("add_label"==t.type||"remove_label"==t.type){var a=nu(r.board.labels);a.map((function(e,t){a[t].value=e.id})),e.push(eu(eu({},t),{},{values:a}))}else if("change_status"==t.type)e.push(eu(eu({},t),{},{values:window.vibeprojects.settings.statuses.card}));else if("assign_member"==t.type||"remove_member"==t.type)e.push(eu(eu({},t),{},{values:n}));else if("move_card"==t.type){if(r.board.lists.length){var i=[];r.board.lists.map((function(e){i.push({value:e.term_id,label:e.name})})),e.push(eu(eu({},t),{},{values:i}))}}else e.push(eu({},t));g(e),window.vibeprojects.settings.board.automations.length==e.length&&o(!1)}))}))}}),[r.board]);return wp.element.createElement("div",{className:"board_automations"},wp.element.createElement("div",{className:"existing_board_automations_wrapper"},!i&&y.length&&m.length?wp.element.createElement("div",{className:"existing_board_automations"},m.map((function(e,t){var n;return wp.element.createElement("div",{className:"existing_board_automation"},wp.element.createElement("div",{className:"automation_when"},wp.element.createElement("label",null,window.vibeprojects.translations.when),wp.element.createElement("span",null,null===(n=y[y.findIndex((function(t){return t.type==e.when.key}))])||void 0===n?void 0:n.label),y.findIndex((function(t){return t.type==e.when.key}))>-1&&y[y.findIndex((function(t){return t.type==e.when.key}))].hasOwnProperty("values")?wp.element.createElement("span",null,y[y.findIndex((function(t){return t.type==e.when.key}))].values[y[y.findIndex((function(t){return t.type==e.when.key}))].values.findIndex((function(t){return t.value==e.when.value}))].label):""),wp.element.createElement("span",{className:"vicon vicon-arrow-right"}),wp.element.createElement("div",{className:"automation_then"},wp.element.createElement("label",null,window.vibeprojects.translations.then),wp.element.createElement("span",null,y.findIndex((function(t){return t.type==e.then.key}))>-1?y[y.findIndex((function(t){return t.type==e.then.key}))].label:""),y.findIndex((function(t){return t.type==e.then.key}))>-1&&y[y.findIndex((function(t){return t.type==e.then.key}))].hasOwnProperty("values")?wp.element.createElement("span",null,"object"==Qp(e.then.value)?e.then.value.name:y[y.findIndex((function(t){return t.type==e.then.key}))].values[y[y.findIndex((function(t){return t.type==e.then.key}))].values.findIndex((function(t){return t.value==e.then.value}))].label):""),wp.element.createElement("span",{className:"vicon vicon-trash",onClick:function(){var e=nu(m);e.splice(t,1),f(e)}}))}))):""),y.length?wp.element.createElement("div",{className:"create_new_automation"},v?wp.element.createElement("div",{className:"new_automation_wrap"},wp.element.createElement("div",{className:"automation_when"},wp.element.createElement("label",null,window.vibeprojects.translations.when),wp.element.createElement("select",{value:null===(t=d.when)||void 0===t?void 0:t.key,onChange:function(e){p(eu(eu({},d),{},{when:{key:e.target.value}}))}},wp.element.createElement("option",null,window.vibeprojects.translations.select_automation),y.map((function(e){return wp.element.createElement("option",{value:e.type},e.label)}))),d.when.key&&Array.isArray(y[y.findIndex((function(e){return e.type==d.when.key}))].values)?wp.element.createElement("select",{value:d.when.value,onChange:function(e){return p(eu(eu({},d),{},{when:{key:d.when.key,value:e.target.value}}))}},wp.element.createElement("option",null,window.vibeprojects.translations.select_automation_values),y[y.findIndex((function(e){return e.type==d.when.key}))].values.map((function(e){return wp.element.createElement("option",{value:e.value},e.label)}))):""),wp.element.createElement("div",{className:"automation_then"},wp.element.createElement("label",null,window.vibeprojects.translations.then),wp.element.createElement("select",{value:null===(n=d.then)||void 0===n?void 0:n.key,onChange:function(e){p(eu(eu({},d),{},{then:{key:e.target.value,value:""}}))}},wp.element.createElement("option",null,window.vibeprojects.translations.select_automation),y.map((function(e){return wp.element.createElement("option",{value:e.type},e.label)}))),d.then.key&&y[y.findIndex((function(e){return e.type==d.then.key}))].hasOwnProperty("values")?wp.element.createElement("select",{value:d.then.value,onChange:function(e){return p(eu(eu({},d),{},{then:{key:d.then.key,value:e.target.value}}))}},wp.element.createElement("option",null,window.vibeprojects.translations.select_automation_values),y[y.findIndex((function(e){return e.type==d.then.key}))].values.map((function(e){return wp.element.createElement("option",{value:e.value},e.label)}))):"")):"",wp.element.createElement("div",null,k?wp.element.createElement("a",{className:E?"button is-primary is-loading":"button is-primary",onClick:function(){j(!0),fetch("".concat(window.vibeprojects.apiUrl,"/board/saveAutomations/"),{method:"post",body:JSON.stringify({project_id:r.path.project,board_id:r.path.board,automations:m,token:uu("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){j(!1),N(!1),e.hasOwnProperty("message")&&(mu("vibebp").addNotification({text:e.message}),r.update("board",eu(eu({},r.board),{},{automations:m})))}))}},window.vibeprojects.translations.save):"",v?wp.element.createElement(cu,null,wp.element.createElement("a",{className:"create_new_automation button is-primary",onClick:function(){f([].concat(nu(m),[d])),p({when:{key:"",value:""},then:{key:"",value:""}}),w(!1),N(!0)}},window.vibeprojects.translations.create_new_automation),wp.element.createElement("a",{className:"link",onClick:function(){return w(!1)}},window.vibeprojects.translations.cancel)):wp.element.createElement("a",{className:"create_new_automation button is-primary",onClick:function(){return w(!0)}},window.vibeprojects.translations.create_new_automation))):wp.element.createElement("div",{className:"vbp_message"},wp.element.createElement("p",null,window.vibeprojects.translations.no_automation_options)))};function bu(e){return(bu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var vu=wp.element,wu=(vu.createElement,vu.render,vu.useState,vu.useEffect),hu=(vu.Fragment,vu.useContext,vu.useRef),yu=function(e){var t=hu(null);return wu((function(){if(t&&e.data){var n,r,a,i,o=t.current.getContext("2d"),l=[];if(null!==(n=e.data)&&void 0!==n&&null!==(r=n.bg)&&void 0!==r&&r.length)l=e.data.bg;else{var s=o.createLinearGradient(0,0,0,300);s.addColorStop(0,"rgb(241, 39, 17)"),s.addColorStop(1,"rgb(245, 175, 25)");var c=o.createLinearGradient(0,0,0,300);c.addColorStop(0,"rgb(238, 156, 167)"),c.addColorStop(1,"rgb(255, 221, 225)");var d=o.createLinearGradient(0,0,0,300);d.addColorStop(0,"rgb(17, 153, 142)"),d.addColorStop(1,"rgb(56, 239, 125)");var p=o.createLinearGradient(0,0,0,300);p.addColorStop(0,"rgb(252, 234, 187)"),p.addColorStop(1,"rgb(248, 181, 0)");var u=o.createLinearGradient(0,0,0,300);u.addColorStop(0,"rgb(127, 127, 213)"),u.addColorStop(1,"rgb(134, 168, 231)");var m=o.createLinearGradient(0,0,0,300);m.addColorStop(0,"rgb(86, 171, 47)"),m.addColorStop(1,"rgb(168, 224, 99)");var f=o.createLinearGradient(0,0,0,300);f.addColorStop(0,"rgb(238, 156, 167)"),f.addColorStop(1,"rgb(255, 221, 225)");var b=o.createLinearGradient(0,0,0,300);b.addColorStop(0,"rgb(238, 156, 167)"),b.addColorStop(1,"rgb(255, 221, 225)");var v=o.createLinearGradient(0,0,0,300);v.addColorStop(0,"rgb(238, 156, 167)"),v.addColorStop(1,"rgb(255, 221, 225)");var w=o.createLinearGradient(0,0,0,300);w.addColorStop(0,"rgb(238, 156, 167)"),w.addColorStop(1,"rgb(255, 221, 225)"),l=[s,c,d,p,u,m,f,b,v,w]}var h={borderRadius:5,scales:{xAxes:[{gridLines:{drawOnChartArea:!1}}],yAxes:[{gridLines:{drawOnChartArea:!1},ticks:{stepSize:1}}]}};e.notitle&&(h.plugins={legend:!1}),e.noaxes&&(h.scales.yAxes=[{display:!1}]);var y=[],g=[];if(null!==(a=e.data)&&void 0!==a&&null!==(i=a.labels)&&void 0!==i&&i.length&&"object"==bu(e.data.labels[0])){var _=e.data.labels.map((function(e){var t=new Image;return t.src=e.avatar,t}));g=[{afterDraw:function(e){var t=e.chart.ctx,n=e.scales["x-axis-0"],r=e.scales["y-axis-0"];n.ticks.forEach((function(e,a){var i=n.getPixelForTick(a);t.drawImage(_[a],i-12,r.bottom+10)}))}}]}else y=e.data.labels;new Chart(o,{type:"bar",data:{labels:y,datasets:[{label:e.data.title,data:e.data.data,backgroundColor:l,borderWidth:0,borderRadius:Number.MAX_VALUE}]},options:h,plugins:g})}}),[t,e.data]),wp.element.createElement("canvas",{ref:t})},gu=wp.element,_u=(gu.createElement,gu.render,gu.useState,gu.useEffect),Eu=(gu.Fragment,gu.useContext,gu.useRef),ju=function(e){var t=Eu(null);return _u((function(){if(t&&e.data){var n,r,a=t.current.getContext("2d"),i=[];if(null!==(n=e.data)&&void 0!==n&&null!==(r=n.bg)&&void 0!==r&&r.length)i=e.data.bg;else{var o=a.createLinearGradient(0,0,0,300);o.addColorStop(0,"#f9dbd5"),o.addColorStop(1,"#f9cceb");var l=a.createLinearGradient(0,0,0,300);l.addColorStop(0,"#eb5a46"),l.addColorStop(1,"#f6c9c0");var s=a.createLinearGradient(0,0,0,300);s.addColorStop(0,"#009dd8"),s.addColorStop(1,"#57c0e8");var c=a.createLinearGradient(0,0,0,300);c.addColorStop(0,"#5779e8"),c.addColorStop(1,"#244fdb");var d=a.createLinearGradient(0,0,0,300);d.addColorStop(0,"#24dbb9"),d.addColorStop(1,"#48d4ba");var p=a.createLinearGradient(0,0,0,300);p.addColorStop(0,"#48d469"),p.addColorStop(1,"#2dcc53");var u=a.createLinearGradient(0,0,0,300);u.addColorStop(0,"#b8e230"),u.addColorStop(1,"#9bc023");var m=a.createLinearGradient(0,0,0,300);m.addColorStop(0,"#c4c415"),m.addColorStop(1,"#e2e22f");var f=a.createLinearGradient(0,0,0,300);f.addColorStop(0,"#e2882f"),f.addColorStop(1,"#e47d18");var b=a.createLinearGradient(0,0,0,300);b.addColorStop(0,"#ec723e"),b.addColorStop(1,"#e45518"),i=[o,l,s,c,d,p,u,m,f,b]}new Chart(a,{type:"doughnut",data:{labels:e.data.labels,datasets:[{label:e.data.title,data:e.data.data,backgroundColor:i}]}})}}),[t,e.data]),wp.element.createElement("canvas",{ref:t})},Ou=wp.element,ku=(Ou.createElement,Ou.render,Ou.useState,Ou.useEffect),Nu=(Ou.Fragment,Ou.useContext,Ou.useRef),xu=function(e){var t=Nu(null);return ku((function(){if(t&&e.data){var n,r,a=t.current.getContext("2d"),i=[];if(null!==(n=e.data)&&void 0!==n&&null!==(r=n.bg)&&void 0!==r&&r.length)i=e.data.bg;else{var o=a.createLinearGradient(0,0,0,300);o.addColorStop(0,"#f9dbd5"),o.addColorStop(1,"#f9cceb");var l=a.createLinearGradient(0,0,0,300);l.addColorStop(0,"#eb5a46"),l.addColorStop(1,"#f6c9c0"),i=[o,l]}new Chart(a,{type:"line",data:{labels:e.data.labels,datasets:[{label:e.data.title,data:e.data.data,backgroundColor:i}]},options:{borderRadius:5,scales:{xAxes:[{gridLines:{drawOnChartArea:!1}}],yAxes:[{gridLines:{drawOnChartArea:!1},ticks:{stepSize:1}}]}}})}}),[t,e.data]),wp.element.createElement("canvas",{ref:t})};function Su(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Pu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pu(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Iu=wp.element,Cu=(Iu.createElement,Iu.render,Iu.useState),Au=Iu.useEffect,Du=(Iu.Fragment,Iu.useContext),Ru=(Iu.useRef,wp.data),Tu=(Ru.select,Ru.dispatch,function(e){var t=Du(l),n=Su(Cu({labels:[],data:[],bg:[]}),2),r=n[0],a=n[1],i=Su(Cu({labels:[],data:[],bg:[]}),2),o=i[0],s=i[1],c=Su(Cu({labels:[],data:[],bg:[]}),2),d=c[0],p=c[1],u=Su(Cu({labels:[],data:[],bg:[]}),2),m=u[0],f=u[1];return Au((function(){if(Array.isArray(t.board.lists)&&t.board.lists.length){var e=[],n=[];t.board.lists.map((function(t){e.push(t.name),t.hasOwnProperty("cards")?n.push(t.cards.length):n.push(0)})),a({title:window.vibeprojects.translations.tasks_by_lists,labels:e,data:n})}}),[t.board]),Au((function(){if(Array.isArray(t.board.lists)&&t.board.lists.length){var e=[],n=[],r=[];window.vibeprojects.settings.statuses.card.map((function(t){e.push(t.label),r.push(t.color),n[t.value]=1}));var a=[];if(t.board.cards.length)for(var i in window.vibeprojects.settings.statuses.card.map((function(e){n[e.value]=n[e.value]+t.board.cards.filter((function(t){return t.status==e.value})).length})),n)a.push(n[i]);s({title:window.vibeprojects.translations.tasks_by_status,labels:e,data:a,bg:r})}}),[t.board]),Au((function(){if(Array.isArray(t.board.lists)&&t.board.lists.length){var e,n,r=[],a=[],i=[];null!==(e=t.board)&&void 0!==e&&null!==(n=e.labels)&&void 0!==n&&n.length&&t.board.labels.map((function(e,n){a.push({id:e.id,value:t.board.cards.filter((function(t){var n;return(null===(n=t.labels)||void 0===n?void 0:n.indexOf(e.id))>-1})).length})})),a.sort((function(e,t){return e.value>t.value}));var o=[];a.map((function(e,n){n<5&&(o.push(e.value),r.push(t.board.labels[t.board.labels.findIndex((function(t){return t.id==e.id}))].label),i.push(t.board.labels[t.board.labels.findIndex((function(t){return t.id==e.id}))].color))})),p({title:window.vibeprojects.translations.tasks_by_labels,labels:r,data:o,bg:i})}}),[t.board]),Au((function(){if(Array.isArray(t.board.lists)&&t.board.lists.length){var e=[],n=[],r=[];t.board.members.map((function(t){r.push(localforage.getItem("user_"+t).then((function(t){e.push(JSON.parse(t).name)}))),n[t]=0})),t.board.cards.length&&t.board.members.map((function(e){n[e]=n[e]+t.board.cards.filter((function(t){return t.members.indexOf(e)>-1})).length})),Promise.all(r).then((function(){var t=[];for(var r in n)t.push(n[r]);f({title:window.vibeprojects.translations.tasks_by_members,labels:e,data:t})}))}}),[t.board]),wp.element.createElement("div",{className:"board_stats"},wp.element.createElement("div",{className:"tasks_per_group"},wp.element.createElement(yu,{data:r})),wp.element.createElement("div",{className:"tasks_per_group"},wp.element.createElement(ju,{data:o})),wp.element.createElement("div",{className:"tasks_per_group"},wp.element.createElement(xu,{data:d})),wp.element.createElement("div",{className:"tasks_per_group"},wp.element.createElement(yu,{data:m})))});function Mu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Uu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mu(Object(n),!0).forEach((function(t){$u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Lu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Fu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fu(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ju=wp.element,Hu=(Ju.createElement,Ju.render,Ju.useState),Yu=Ju.useEffect,Vu=(Ju.Fragment,Ju.useContext),qu=(Ju.useRef,wp.data),Wu=qu.select,Gu=qu.dispatch,zu=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",Xu=function(e){var t=Vu(l),n=Lu(Hu({}),2),r=n[0],a=n[1],i=Lu(Hu({page:1,search:"",board_id:e.board&&e.board.hasOwnProperty("id")?e.board.id:0}),2),o=(i[0],i[1],Lu(Hu("board_description"),2)),s=(o[0],o[1],Lu(Hu(!1),2)),c=s[0],d=s[1],p=Lu(Hu(!1),2),u=(p[0],p[1],Lu(Hu(e.defaultView),2)),m=u[0],f=u[1],b=Lu(Hu("filters"),2),v=b[0],w=b[1],h=Lu(Hu([]),2),y=(h[0],h[1],Lu(Hu({}),2)),_=y[0],E=y[1],j=Lu(Hu(0),2),O=j[0],k=j[1];return Yu((function(){t.path.hasOwnProperty("board")?fetch("".concat(window.vibeprojects.apiUrl,"/board/getFullBoard/"),{method:"post",body:JSON.stringify({project_id:t.path.project,board_id:t.path.board,token:Wu("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&e.status&&(E(e.board),t.update("board",e.board),"undefined"!=typeof firebase&&void 0!==firebase.auth&&firebase.auth().currentUser&&(firebase.database().ref("/projects/".concat(t.path.project,"/boards/").concat(t.path.board)).set(Uu(Uu({},e.board),{},{time:(new Date).getTime()})),firebase.database().ref("users/".concat(Wu("vibebp").getUser().id,"/status")).set(1)))})):e.back()}),[t.path.board]),Yu((function(){if("undefined"!=typeof firebase&&void 0!==firebase.auth&&firebase.auth().currentUser){var e=firebase.database().ref("/projects/".concat(t.path.project,"/boards/").concat(t.path.board)),n=e.on("value",(function(e){e.val()&&t.update("board",e.val())}));return function(){e.off("value",n),t.update("remove","board")}}}),[]),Yu((function(){if("undefined"!=typeof firebase&&void 0!==firebase.auth&&firebase.auth().currentUser)return function(){}}),[]),Yu((function(){t.hasOwnProperty("board")&&r!=t.board&&a(t.board)}),[null==t?void 0:t.board]),Yu((function(){var e,n;if(t.hasOwnProperty("automate")&&null!==(e=t.board)&&void 0!==e&&null!==(n=e.automations)&&void 0!==n&&n.length){var r=Uu({},t.board);t.board.automations.map((function(e){if(console.log(t.board.automations,e),e.when.key==t.automate.type){var n=0;e.when.hasOwnProperty("value")&&e.when.value==t.automate.value&&("add_label"==e.then.key&&(r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].hasOwnProperty("labels")||(r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].labels=[]),-1==r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].labels.indexOf(e.then.value)&&(r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].labels.push(e.then.value),n=1,fetch("".concat(zu,"/card/labels/").concat(t.automate.id,"/action?post"),{method:"post",body:JSON.stringify({label:t.automate.value,token:Wu("vibebp").getToken(),added:!0})}))),"remove_label"==e.then.key&&r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].labels.indexOf(e.then.value)>-1&&(r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].labels.splice(r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].labels.indexOf(e.then.value),1),n=1,fetch("".concat(zu,"/card/labels/").concat(t.automate.id,"/action?post"),{method:"post",body:JSON.stringify({label:r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))],token:Wu("vibebp").getToken(),added:!1})})),"assign_member"==e.then.key&&-1==r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].members.indexOf(e.then.value)&&(r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].members.push(e.then.value),n=1,fetch("".concat(zu,"/card/addmembertocard?post"),{method:"post",body:JSON.stringify({card_id:t.automate.id,project_id:t.path.project,members:[e.then.value],token:Wu("vibebp").getToken()})})),"remove_member"==e.then.key&&r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].members.indexOf(e.then.value)>-1&&(r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].members.splice(r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].members.indexOf(e.then.value),1),n=1,fetch("".concat(zu,"/card/removemembercard?post"),{method:"post",body:JSON.stringify({card_id:t.automate.id,project_id:t.path.project,member:e.then.value,token:Wu("vibebp").getToken()})})),"mark_milestone"==e.then.key&&(r.cards.findIndex((function(e){return e.card_id==t.automate.id}))>-1&&!r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].hasOwnProperty("icons")&&(r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].icons=[]),r.cards.findIndex((function(e){return e.card_id==t.automate.id}))>-1&&-1==r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].icons.findIndex((function(e){return"milestone"==e.key}))&&(r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].icons.push({icon:"vicon vicon-control-record",key:"milestone",label:window.vibeprojects.translations.milestone}),n=1,fetch("".concat(zu,"/card/milestone/").concat(t.automate.id,"/action?post"),{method:"post",body:JSON.stringify({milestone:!0,project_id:t.path.project,token:Wu("vibebp").getToken()})}))),"complete_card"==e.then.key&&(r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].hasOwnProperty("icons")||(r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].icons=[]),-1==r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].icons.findIndex((function(e){return"complete"==e.key}))&&(r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].icons.push({icon:"vicon vicon-check",key:"complete",label:window.vibeprojects.translations.card_complete}),n=1,fetch("".concat(zu,"/card/complete/").concat(t.automate.id,"/action?post"),{method:"post",body:JSON.stringify({complete:!0,project_id:t.path.project,token:Wu("vibebp").getToken()})}))),"move_card"==e.then.key&&r.lists.map((function(e,a){e.cards.indexOf(t.automate.id)>-1&&(r.lists[a].cards.splice(e.cards.indexOf(t.automate.id),1),r.lists[r.lists.findIndex((function(e){return e.term_id==t.automate.value}))].cards.push(t.automate.id),n=1,fetch("".concat(zu,"/project/boards/save_lists?post"),{method:"post",body:JSON.stringify({board_id:t.board.id,lists:r.lists,token:Wu("vibebp").getToken()})}))})),"change_status"==e.then.key&&r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].status!=e.then.value&&(r.cards[r.cards.findIndex((function(e){return e.card_id==t.automate.id}))].status=e.then.value,n=1,fetch("".concat(zu,"/card/changeStatus?post"),{method:"post",body:JSON.stringify({status:e.then.value,card_id:t.automate.id,project_id:t.path.project,token:Wu("vibebp").getToken()})})),n&&(Gu("vibebp").addNotification({icon:"vicon vicon-check",text:window.vibeprojects.translations.automation_applied+" -> "+window.vibeprojects.settings.board.automations[window.vibeprojects.settings.board.automations.findIndex((function(t){return t.type==e.then.key}))].label}),t.update("board",r)))}}))}}),[null==t?void 0:t.automate]),g((function(){t.hasOwnProperty("board")&&"undefined"!=typeof firebase&&void 0!==firebase.auth&&firebase.auth().currentUser&&firebase.database().ref("/projects/".concat(t.path.project,"/boards/").concat(t.board.id)).set(t.board)}),500,[null==t?void 0:t.board]),Yu((function(){v&&E(t.board)}),[v,t.board]),Yu((function(){if(e.defaultView!=m){var n=Uu({},t.path);n.hasOwnProperty("card")&&delete n.card,t.update("path",n)}}),[m]),wp.element.createElement("div",{className:"full_project"},wp.element.createElement("div",{className:"board_main"},wp.element.createElement("div",{className:"boards_list"},wp.element.createElement("div",{className:c?"view_boards_list":"view_boards_list unwrap"},wp.element.createElement("div",{className:"list_container"},wp.element.createElement("div",{className:"list_header_title"},wp.element.createElement("div",null,wp.element.createElement("h2",null,window.vibeprojects.translations.lists),wp.element.createElement("div",{className:"view_types"},wp.element.createElement("span",{className:m&&"boards"!=m?"tip":"active tip",onClick:function(){return f("boards")},title:window.vibeprojects.translations.show_task_board},wp.element.createElement("span",{className:"vicon vicon-trello"})),wp.element.createElement("span",{className:"list"==m?"active tip":"tip",onClick:function(){return f("list")},title:window.vibeprojects.translations.show_task_list},wp.element.createElement("span",{className:"vicon vicon-view-list-alt"})),wp.element.createElement("span",{className:"timeline"==m?"active tip":"tip",onClick:function(){return f("timeline")},title:window.vibeprojects.translations.show_task_timeline},wp.element.createElement("span",{className:"vicon vicon-panel"})))),wp.element.createElement("div",{className:"board_sort_options"},wp.element.createElement("span",{className:"filters"==v?"tip active":"tip",title:window.vibeprojects.translations.show_filters,onClick:function(){return w("filters")}},wp.element.createElement("span",{className:"vicon vicon-filter"})),wp.element.createElement("span",{className:"automations"==v?"tip active":"tip",title:window.vibeprojects.translations.show_automations,onClick:function(){return w("automations")}},wp.element.createElement("span",{className:"vicon vicon-reddit"})),wp.element.createElement("span",{className:"bulk_actions"==v?"tip active":"tip",title:window.vibeprojects.translations.bulk_actions_tip,onClick:function(){return w("bulk_actions")}},wp.element.createElement("span",{className:"vicon vicon-files"})),wp.element.createElement("span",{className:"stats"==v?"tip active":"tip",title:window.vibeprojects.translations.show_stats,onClick:function(){return w("stats")}},wp.element.createElement("span",{className:"vicon vicon-bar-chart"})),"boards"==m?wp.element.createElement("span",{className:"tip board_icon",title:window.vibeprojects.translations.wrap_lists,onClick:function(){return d(!c)}},wp.element.createElement("span",{className:c?"vicon vicon-view-grid active":"vicon vicon-layout-column3"})):"")),wp.element.createElement("div",{className:"expanded_board_sort_options"},"filters"==v?wp.element.createElement(Up,{displaytype:m,update:function(e){return E(e)}}):"bulk_actions"==v?wp.element.createElement(Zp,{refetch:function(){return k(O+1)},close:function(){return w("filters")}}):"automations"==v?wp.element.createElement(fu,{close:function(){return w("filters")}}):"stats"==v?wp.element.createElement(Tu,{close:function(){return w("filters")}}):"")),"list"==m?wp.element.createElement(gp,{board:r}):"timeline"==m?wp.element.createElement(Hd,{board:_}):wp.element.createElement(Zc,{board:_})))))};function Bu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bu(Object(n),!0).forEach((function(t){Qu(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Qu(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ku(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return em(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return em(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function em(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var tm=wp.element,nm=(tm.createElement,tm.render,tm.useState),rm=tm.useEffect,am=(tm.Fragment,tm.useContext),im=wp.data,om=(im.dispatch,im.select),lm=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",sm=function(e){var t=am(l),n=Ku(nm(!1),2),r=(n[0],n[1]),a=Ku(nm(!1),2),i=a[0],o=a[1],s=Ku(nm(!1),2),c=s[0],d=s[1],p=Ku(nm(!1),2),u=p[0],m=p[1],f=Ku(nm({id:0,post_title:"",post_content:"",project_id:e.project.id,meta:[],taxonomy:[],members:[]}),2),b=f[0],v=f[1],w=Ku(nm([]),2),h=w[0],y=w[1],g=Ku(nm([]),2),_=(g[0],g[1]),E=Ku(nm({post_content:"",raw:[]}),2),j=E[0],O=E[1],k=Ku(nm([]),2);k[0],k[1];rm((function(){e.hasOwnProperty("edit")&&v(Zu(Zu({},b),{},{id:e.hasOwnProperty("edit")?e.edit.id:0,post_title:e.hasOwnProperty("edit")?e.edit.title:0}))}),[e.edit]),rm((function(){r(!0),fetch("".concat(lm,"/project/").concat(e.project.id,"/board/getFields?force"),{method:"post",body:JSON.stringify({board_id:e.hasOwnProperty("edit")?e.edit.id:0,token:om("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){r(!1),e.status&&y(e.fields)}))}),[]);rm((function(){fetch("".concat(lm,"/taxonomy/board-type/terms?force"),{method:"post",body:JSON.stringify({token:om("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){r(!1),e.status&&_(e.board_types)}))}),[]);var N=function(e,t){var n=e.field;if("fieldvaluechanged"==t){if("post"==n.from)if("editor"==n.type)O({post_content:n.value,raw:n.raw});else{var r=Zu({},b);r[n.id]=n.value,v(r)}if("meta"==n.from){var a=Zu({},b),i=a.meta.findIndex((function(e){return e.meta_key==n.id}));i>-1?a.meta[i].meta_value=n.value:a.meta.push({meta_key:n.id,meta_value:n.value}),v(a)}if("taxonomy"==n.from){var o=Zu({},b),l=o.taxonomy.findIndex((function(e){return e.taxonomy==n.id}));l>-1?o.taxonomy[l].value=n.value:o.taxonomy.push({taxonomy:n.id,terms:n.value}),v(o)}}};return wp.element.createElement("div",{className:"new_board"},h.length?wp.element.createElement("div",{className:"board_create_form"},wp.element.createElement("div",{className:"board_essentials"},wp.element.createElement("div",{className:"board_featured"},wp.element.createElement(jo,{field:h[0],update:N})),wp.element.createElement("div",{className:"board_title_extras"},wp.element.createElement(jo,{field:h[1],update:N}),wp.element.createElement("div",{className:"board_title_extra_fields"},wp.element.createElement(jo,{field:h[2],update:N})))),wp.element.createElement("div",{className:"board_fields"},h.map((function(e,t){if(t>2&&t<h.length-1)return wp.element.createElement(jo,{field:e,update:N})}))),wp.element.createElement(jo,{field:h[h.length-1],update:N}),wp.element.createElement("div",{className:"button_create_board"},wp.element.createElement("span",null,wp.element.createElement("a",{onClick:function(){o(!0),fetch("".concat(lm,"/project/").concat(e.project.id,"/newboard/?post"),{method:"post",body:JSON.stringify(Zu(Zu(Zu({},b),j),{},{token:om("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(n){o(!1),n.status&&(e.board(n.data.board),t.update("path",Zu(Zu({},t.path),{},{board:n.data.board,id:id})))}))},className:i?"create_board button is-loading":"create_board button"},b.hasOwnProperty("id")?window.vibeprojects.translations.update_board:window.vibeprojects.translations.create_board),e.edit?wp.element.createElement("div",{className:"delete_board_button_wrapper"},wp.element.createElement("a",{onClick:function(){m(!0)},className:"delete_board button"},window.vibeprojects.translations.delete_board)):""),wp.element.createElement("a",{className:"link",onClick:e.close},window.vibeprojects.translations.cancel))):wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)),u?wp.element.createElement(Y,{open:u,onClose:function(){return m(!1)}},wp.element.createElement("div",{className:"modal-header"},window.vibeprojects.translations.you_sure_delete_the_board),wp.element.createElement("span",{className:"modal-body"},window.vibeprojects.translations.delete_board_notice),wp.element.createElement("div",{className:"modal-footer"},wp.element.createElement("a",{className:c?"button is-primary is-loading":"button is-primary",onClick:function(){d(!0),fetch("".concat(lm,"/project/").concat(e.project.id,"/deleteboard/?post"),{method:"post",body:JSON.stringify(Zu(Zu({},b),{},{token:om("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(n){if(d(!1),n.status){m(!1),e.delete(b);var r=Zu({},t.path);delete r.board,t.update("path",r),e.close()}}))}},window.vibeprojects.translations.confirm),wp.element.createElement("a",{className:"link",onClick:function(){m(!1)}},window.vibeprojects.translations.cancel))):"")},cm=wp.element,dm=(cm.createElement,cm.render,cm.useState,cm.useEffect,cm.Fragment,cm.useContext,window.vibeprojects&&window.vibeprojects.apiUrl,function(e){return wp.element.createElement("div",{className:"project_board",onClick:function(){return e.showBoard()}},wp.element.createElement("div",{className:"board_head"},wp.element.createElement("div",{className:"board_body"},wp.element.createElement("img",{src:e.board.image}),wp.element.createElement("strong",null,e.board.title)),H("create_board")?wp.element.createElement("span",{className:"vicon vicon-settings",onClick:e.edit}):""),wp.element.createElement("div",{className:"board_description"},e.board.description.length>50?e.board.description.substr(0,50)+"...":e.board.description),wp.element.createElement("div",{className:"board_head"},e.board.type.length?wp.element.createElement("div",{className:"board_type_list"},e.board.type.map((function(e){return wp.element.createElement("span",{className:"board_type tax_term "+e.slug},e.name)}))):"",wp.element.createElement("span",{className:"board_label "+e.board.label})),e.board.progress?wp.element.createElement("div",{className:"progress_wrap"},wp.element.createElement("span",{className:"progress_wrapper"},wp.element.createElement("span",{className:"increment",style:{width:100*e.board.progress.complete/e.board.progress.total+"%"}})),wp.element.createElement("span",{className:"progress_label"},Math.round(100*e.board.progress.complete/e.board.progress.total,2)+"%"," [",e.board.progress.complete,"/",e.board.progress.total,"]")):"",wp.element.createElement("div",{className:"board_footer"},e.board.members.length?wp.element.createElement(C,{user_ids:e.board.members},e.board.members.map((function(e){return wp.element.createElement(I,{id:{user_id:e},type:"user"})}))):""))});function pm(e){return function(e){if(Array.isArray(e))return wm(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||vm(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function um(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?um(Object(n),!0).forEach((function(t){fm(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):um(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bm(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||vm(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function vm(e,t){if(e){if("string"==typeof e)return wm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wm(e,t):void 0}}function wm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var hm=wp.element,ym=(hm.createElement,hm.render,hm.useState),gm=hm.useEffect,_m=(hm.Fragment,hm.useContext),Em=wp.data,jm=Em.select,Om=(Em.dispatch,window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/"),km=function(e){var t,n=bm(ym({page:1,s:"",project_id:e.project.id,boardType:""}),2),r=n[0],a=n[1],i=bm(ym(!1),2),o=i[0],s=i[1],c=_m(l),d=bm(ym([]),2),p=d[0],u=d[1],m=bm(ym(-1),2),f=m[0],b=m[1],v=bm(ym(!1),2),w=v[0],h=v[1],y=bm(ym(!1),2),g=y[0],_=y[1],E=bm(ym(0),2),j=(E[0],E[1],bm(ym(!1),2)),O=j[0],k=j[1],N=bm(ym(""),2),x=N[0],S=N[1],P=bm(ym([]),2),I=P[0],C=P[1];gm((function(){fetch("".concat(Om,"/project/boards/?args=").concat(JSON.stringify(r)),{method:"post",body:JSON.stringify(mm(mm({},r),{},{token:jm("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){e.status&&(C(e.types),u(o?[].concat(pm(p),pm(e.data)):e.data),k(e.total),S(e.default_view))}))}),[r]);var A=function(e){var t=pm(p);-1===t.findIndex((function(t){return t.id===e.id}))?(t.push(e),u(t)):(t.splice(t.findIndex((function(t){return t.id===e.id})),1,e),u(t)),h(!1)},D=function(){};return w?wp.element.createElement(sm,{close:function(){h(!1)},project:e.project,board:A,delete:D}):g?wp.element.createElement(sm,{close:function(){h(!1),_(!1)},edit:g,project:e.project,board:function(e){return A(e)},delete:D}):null!==(t=c.path)&&void 0!==t&&t.board?wp.element.createElement(Xu,{defaultView:x,board:c.path.board,edit:function(){_(!0)},token:jm("vibebp").getToken(),back:function(){b(-1);var e=mm({},c.path);delete e.board,c.update("path",e)},update:function(e,t){if("updateboard"==e){var n=pm(p);n[f]=t,u(n)}}}):wp.element.createElement("div",{className:"project_boards"},wp.element.createElement("div",{className:"vibe_projects_sort_search_container"},wp.element.createElement("div",null,wp.element.createElement("h3",null,window.vibeprojects.translations.boards),wp.element.createElement("span",null,H("create_board")?wp.element.createElement("a",{className:"new_board button is-primary",onClick:function(){h(!0)}},wp.element.createElement("span",{className:"add_icon vicon vicon-plus"}),window.vibeprojects.translations.create_board):"")),wp.element.createElement("div",null,I.length?wp.element.createElement("select",{onChange:function(e){return a(mm(mm({},r),{},{boardType:e.target.value}))}},wp.element.createElement("option",{value:"0"},window.vibeprojects.translations.filter_by_board_type),I.map((function(e){return wp.element.createElement("option",{value:e.term_id},e.name)}))):"",wp.element.createElement("div",{className:"vibe_projects_search_bar"},wp.element.createElement("input",{type:"text",onBlur:function(e){return a(mm(mm({},r),{},{s:e.target.value}))},placeholder:window.vibeprojects.translations.type_to_search}),wp.element.createElement("span",{className:"vicon vicon-search"})))),wp.element.createElement("div",{className:"view_boards_list"},p.length?p.map((function(e,t){return wp.element.createElement(dm,{board:e,showBoard:function(){var t=mm({},c.path);t.board=e.id,c.update("path",t)},edit:function(){_(e)}})})):H("create_board")?wp.element.createElement("div",{className:"add_new_project_div",onClick:function(){h(!0)},title:window.vibeprojects.translations.add_new_project},wp.element.createElement("span",{className:"vicon vicon-plus"})):"",p.length<O?wp.element.createElement("a",{className:"link",onClick:function(){s(!0),a(mm(mm({},r),{},{page:r.page+1}))}},window.vibeprojects.translations.load_more):""))};function Nm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function xm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nm(Object(n),!0).forEach((function(t){Sm(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Sm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pm(e){return function(e){if(Array.isArray(e))return Am(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Cm(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Im(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||Cm(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Cm(e,t){if(e){if("string"==typeof e)return Am(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Am(e,t):void 0}}function Am(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Dm=wp.element,Rm=(Dm.createElement,Dm.render,Dm.useState),Tm=Dm.useEffect,Mm=Dm.Fragment,Um=Dm.useContext,$m=Dm.useRef,Lm=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",Fm=wp.data,Jm=Fm.select,Hm=Fm.dispatch,Ym=function(e){var t=$m(null),n=Um(l),r=Im(Rm(!1),2),a=r[0],i=r[1],o=Im(Rm([]),2),s=o[0],c=o[1],d=Im(Rm(!1),2),p=(d[0],d[1],Im(Rm(null),2)),u=p[0],m=p[1],f=Im(Rm({header_height:40,column_width:30,step:24,view_modes:["Quarter Day","Half Day","Day","Week","Month"],bar_height:70,bar_corner_radius:5,arrow_curve:15,padding:40,view_mode:"Day",date_format:"YYYY-MM-DD",custom_popup_html:function(e){return""},draggable:H("create_project_milestones"),hasArrows:!0,on_date_change:function(e){e.dates=[Math.round(e._start.getTime()/1e3),Math.round(e._end.getTime()/1e3)],x(e,"dates")},on_progress_change:function(e){x(e,"progress")}}),2),b=f[0],v=f[1],w=Im(Rm(!1),2),h=w[0],y=w[1],g=Im(Rm(!1),2),_=g[0],E=g[1],j=Im(Rm(!0),2),O=j[0],k=j[1];Tm((function(){}),[]),Tm((function(){fetch("".concat(Lm,"/card/fetchmilestones/?post"),{method:"post",body:JSON.stringify({project_id:e.project.id,token:Jm("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&(e.tasks.length&&e.tasks.map((function(t,n){t.dependencies.length&&t.dependencies.map((function(t,r){e.tasks[n].dependencies[r]="milestone_"+t,e.tasks[n].isChild=!0}))})),c(e.tasks))}))}),[]);var N=function(){_&&fetch("".concat(Lm,"/card/deletemilestone/?post"),{method:"post",body:JSON.stringify({milestone:_,project_id:e.project.id,token:Jm("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){if(e.status){var t=Pm(s);t.splice(t.findIndex((function(e){return e.id==_.id})),1),c(t)}}))},x=function(t,n){fetch("".concat(Lm,"/card/updateMilestone/?post"),{method:"post",body:JSON.stringify({milestone:t,type:n,project_id:e.project.id,token:Jm("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){if(e.hasOwnProperty("message")&&Hm("vibebp").addNotification({text:e.message}),e.status){var t=Pm(s),n=t.findIndex((function(t){return t.card_id==e.task.card_id}));n>-1&&(t.splice(n,1,e.task),c(t))}}))};Tm((function(){u&&s.length&&u.refresh(s)}),[s]),Tm((function(){if(t&&s.length)if(u)u.change_view_mode(b.view_mode);else{var e=new Od(t.current,s,b);m(e)}}),[t,b,s]);return wp.element.createElement("div",{className:"project_gantt_wrapper"},h?wp.element.createElement(Mc,{card:xm(xm({},h),{},{title:h.name}),project_id:n.path.project,close:function(){return y(!1)}}):"",wp.element.createElement("div",{className:"gantt_wrapper"},O?wp.element.createElement("div",{className:"vibe_projects_gantt_chart_milestones"},wp.element.createElement("div",{className:"gant_button_wrapper"},wp.element.createElement("div",{className:"gant_chart_type_switcher"},H("create_project_milestones")?wp.element.createElement("a",{className:"active",onClick:function(){return i(!0)}},window.vibeprojects.translations.add_milestones):"",wp.element.createElement("a",{className:"tip",title:window.vibeprojects.translations.expand_tasks}," ",wp.element.createElement("span",{className:"vicon vicon-plus"})))),wp.element.createElement("div",{className:"gantt_chart_elements"},s.length?s.map((function(e,t){var n;return wp.element.createElement("div",{className:e.hasOwnProperty("parent")?"gantt_chart_element sub":"gantt_chart_element"},wp.element.createElement("div",{className:"gantt_chart_element_content"},_&&_.id==e.id?wp.element.createElement(Mm,null,wp.element.createElement("span",{className:"delete_notice"},window.vibeprojects.translations.delete_milestone_message),wp.element.createElement("div",{className:"card_actions"},wp.element.createElement("a",{className:"button is-primary",onClick:N},window.vibeprojects.translations.delete),wp.element.createElement("a",{className:"link",onClick:function(){return E(!1)}},window.vibeprojects.translations.cancel))):wp.element.createElement(Mm,null,wp.element.createElement("strong",{dangerouslySetInnerHTML:{__html:e.name},onClick:function(){var t=xm({},e);y(t)}}),wp.element.createElement("span",{className:"progress_per "+(100==e.progress?"full":e.progress>75?"fourth_quarter":e.progress>50?"third_quarter":e.progress>25?"second_quarter":e.progress>0?"first_quarter":"zero")},e.progress+"%"),wp.element.createElement("div",{className:"date_range"},wp.element.createElement("span",{className:"vicon vicon-calendar"}),wp.element.createElement("span",null,function(e){var t=new Date(e.start),n=new Date(e.end);return t.getYear()!==n.getYear()?t.toDateString()+" - "+n.toDateString():t.getMonth()!==n.getMonth()?t.toLocaleString("default",{month:"short"})+", "+t.getDate()+" - "+n.toLocaleString("default",{month:"short"})+", "+n.getDate():t.getDate()+" - "+n.getDate()+", "+t.toLocaleString("default",{month:"short"})}(e))),null!==(n=e.children)&&void 0!==n&&n.length?wp.element.createElement("span",{className:"sub_tasks",onClick:function(){return function(e){var t=Pm(s),n=t.findIndex((function(t){return t.id==e.id}));e.children.map((function(r,a){t.findIndex((function(e){return e.id==r.id}))>-1?t.splice(t.findIndex((function(e){return e.id==r.id})),1):((!r.hasOwnProperty("start")||!r.start||r.start<e.start)&&(r.start=e.start),(!r.hasOwnProperty("end")||!r.end||r.end>e.end||r.end<e.start)&&(r.end=e.end),r.parent=e.id,t.splice(n+1,0,r))})),c(t)}(e)}},wp.element.createElement("span",null,e.children.length," ",window.vibeprojects.translations.tasks),wp.element.createElement("span",{className:"vicon vicon-plus"})):"",wp.element.createElement("div",{className:"card_actions"},wp.element.createElement("span",{className:"vicon vicon-eye",onClick:function(){var t=xm({},e);t.card_id=t.id.split("milestone_")[0],y(t)}}),H("create_project_milestones")?wp.element.createElement("span",{className:"vicon vicon-pencil",onClick:function(){i(e)}}):"",wp.element.createElement("span",{className:"vicon vicon-arrow-up",onClick:function(){var n,r=Pm(s);r.splice(t,1),r.splice(t-1,0,e),n={start_card_id:e.card_id,start_card_order:t,end_card_id:s[t-1].card_id,end_card_order:t+1},fetch("".concat(Lm,"/card/updateMilestoneOrder/?post"),{method:"post",body:JSON.stringify({args:n,token:Jm("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&Hm("vibebp").addNotification({text:e.message})})),c(r)}}),H("delete_project_milestones")?wp.element.createElement("span",{className:"vicon vicon-trash",onClick:function(){return E(e)}}):""))))})):""),a?wp.element.createElement(md,{tasks:s,project:e.project,task:a,update:function(e){if(e){var t=Pm(s),n=t.findIndex((function(t){return t.card_id==e.card_id}));n>-1?t.splice(n,1,e):(t.unshift(e),n=1),c(t)}},close:function(){return i(!1)}}):""):"",wp.element.createElement("div",{className:"gantt_chart_wrapper"},wp.element.createElement("div",{className:"gantt_chart_header"},wp.element.createElement("strong",null,wp.element.createElement("span",{className:"hide_show_tasks vicon vicon-menu",onClick:function(){return k(!O)}}),window.vibeprojects.translations.milestones),wp.element.createElement("div",{className:"gannt_chart_switch_modes"},b.view_modes.map((function(e){return wp.element.createElement("a",{className:b.view_mode==e?"active":"",onClick:function(){return v(xm(xm({},b),{},{view_mode:e}))},title:e},e.substr(0,1))})))),wp.element.createElement("div",{className:"vibe_projects_gantt_Chart",ref:t}))))},Vm=wp.element,qm=(Vm.createElement,Vm.render,Vm.useState,Vm.useEffect),Wm=(Vm.Fragment,Vm.useContext,wp.data),Gm=(Wm.select,Wm.dispatch),zm=(window.vibeprojects&&window.vibeprojects.apiUrl,function(e){return qm((function(){return H("post_project_activity")||Gm("vibebp").setData("activityPostPermissions",0),function(){H("post_project_activity")||Gm("vibebp").removeData("activityPostPermissions")}}),[]),wp.element.createElement("div",{className:"project_content_tab"},wp.element.createElement($s,{filter:"vibe_projects",id:e.project.id,type:"vibe_projects"}))}),Xm=wp.element,Bm=(Xm.createElement,Xm.render,Xm.useState,Xm.useEffect),Zm=(Xm.Fragment,Xm.useContext,Xm.useRef),Qm=function(e){var t=Zm(null);return Bm((function(){if(console.log(e),t&&e.data){var n=t.current.getContext("2d"),r=[],a=[],i=[];e.data.map((function(e){-1==a.indexOf(e.date_recorded)&&a.push(e.date_recorded),-1==i.indexOf(e.type)&&i.push(e.type)}));r.push({type:"bar",label:window.vibeprojects.translations.card_created,data:[],backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(255, 159, 64, 0.2)","rgba(255, 205, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(54, 162, 235, 0.2)","rgba(153, 102, 255, 0.2)","rgba(201, 203, 207, 0.2)"],borderColor:["rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(54, 162, 235)","rgb(153, 102, 255)","rgb(201, 203, 207)"],borderRadius:5,borderWidth:1}),1==r.length&&r.push({type:"bar",label:window.vibeprojects.translations.card_completed,data:[],backgroundColor:["rgba(255, 99, 132, 0.2)","rgba(255, 159, 64, 0.2)","rgba(255, 205, 86, 0.2)","rgba(75, 192, 192, 0.2)","rgba(54, 162, 235, 0.2)","rgba(153, 102, 255, 0.2)","rgba(201, 203, 207, 0.2)"],borderColor:["rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(54, 162, 235)","rgb(153, 102, 255)","rgb(201, 203, 207)"],borderRadius:5,borderWidth:1}),r.push({type:"line",label:window.vibeprojects.translations.cumulative,data:[],fill:!1,borderColor:"#46C37B",tension:.1,borderRadius:Number.MAX_VALUE});var o=0;a.map((function(t,n){i.map((function(n,a){0,o=0,e.data.findIndex((function(e){return e.type==n&&e.date_recorded==t}))>-1?(o=parseInt(e.data[e.data.findIndex((function(e){return e.type==n&&e.date_recorded==t}))].count),r[a].data.push(o)):r[a].data.push(0)}))})),a.map((function(e,t){var n=0;r[0].data.map((function(e,r){r<=t&&(n+=e)})),r[1].data.map((function(e,r){r<=t&&(n-=e)})),n<0&&(n=0),r.length>1&&r[2].data.push(n)}));new Chart(n,{type:"line",data:{labels:a.map((function(e){return moment(e).format("YYYY-MM-DD")})),datasets:r.reverse()},options:{borderRadius:5,scales:{xAxes:[{gridLines:{drawOnChartArea:!1}}],yAxes:[{gridLines:{drawOnChartArea:!1},ticks:{stepSize:1}}]}}})}}),[t,e.data]),console.log(e,"@@@"),wp.element.createElement("canvas",{ref:t})};function Km(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ef(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Km(Object(n),!0).forEach((function(t){tf(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Km(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function tf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return rf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return rf(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function rf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var af=wp.element,of=(af.createElement,af.render,af.useState),lf=af.useEffect,sf=af.Fragment,cf=(af.useContext,wp.data),df=cf.select,pf=(cf.dispatch,window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/"),uf=function(e){var t,n,r,a,i,o,l,s=nf(of(!1),2),c=s[0],d=s[1],p=nf(of([]),2),u=p[0],m=p[1],f=nf(of(!0),2),b=(f[0],f[1],nf(of({type:e.type,dates:[],id:e.id}),2)),v=b[0];b[1];return lf((function(){d(!0),fetch("".concat(pf,"/project/reports/taskReport/?args=").concat(JSON.stringify(v)),{method:"post",body:JSON.stringify(ef(ef({},v),{},{token:df("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){d(!1),e.status&&m(e.data)}))}),[v]),wp.element.createElement("div",{className:"task_reports_wrapper"},wp.element.createElement("strong",{className:"task_report_header"},window.vibeprojects.translations.task_reports),wp.element.createElement("div",{className:"task_reports_wrap"},c?wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):wp.element.createElement(sf,null,wp.element.createElement("div",{className:"full_task_report"},wp.element.createElement("strong",null,window.vibeprojects.translations.task_burn_down),wp.element.createElement("div",{className:"task_report"},wp.element.createElement(Qm,{data:u.burndown}))),wp.element.createElement("div",{className:"task_reports"},wp.element.createElement("div",{className:"task_report"},wp.element.createElement("strong",null,window.vibeprojects.translations.tasks_by_status),wp.element.createElement("div",{className:"task_report"},wp.element.createElement(ju,{data:{data:null===(t=u.status)||void 0===t?void 0:t.map((function(e){return e.count})),labels:null===(n=u.status)||void 0===n?void 0:n.map((function(e){return window.vibeprojects.settings.statuses.card[window.vibeprojects.settings.statuses.card.findIndex((function(t){return t.value==e.status}))].label})),bg:null===(r=u.status)||void 0===r?void 0:r.map((function(e){return window.vibeprojects.settings.statuses.card[window.vibeprojects.settings.statuses.card.findIndex((function(t){return t.value==e.status}))].color}))}}))),wp.element.createElement("div",{className:"task_report"},wp.element.createElement("strong",null,window.vibeprojects.translations.tasks_by_progress),wp.element.createElement("div",{className:"task_report"},wp.element.createElement(ju,{data:{data:null===(a=u.progress)||void 0===a?void 0:a.data,labels:null===(i=u.progress)||void 0===i?void 0:i.labels}}))),wp.element.createElement("div",{className:"task_report"},wp.element.createElement("strong",null,window.vibeprojects.translations.tasks_by_time),wp.element.createElement("div",{className:"task_report"},wp.element.createElement(ju,{data:{data:null===(o=u.time)||void 0===o?void 0:o.data,labels:null===(l=u.time)||void 0===l?void 0:l.labels}})))))))};function mf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ff(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mf(Object(n),!0).forEach((function(t){bf(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function bf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return wf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wf(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var hf=wp.element,yf=(hf.createElement,hf.render,hf.useState),gf=hf.useEffect,_f=(hf.Fragment,hf.useContext,wp.data),Ef=_f.select,jf=(_f.dispatch,window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/"),Of=function(e){var t=vf(yf([]),2),n=t[0],r=t[1],a=vf(yf(!1),2),i=(a[0],a[1],vf(yf({type:e.type,dates:[],id:e.id}),2)),o=i[0];i[1];gf((function(){fetch("".concat(jf,"/project/reports/memberReport/?args=").concat(JSON.stringify(o)),{method:"post",body:JSON.stringify(ff(ff({},o),{},{token:Ef("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){e.status&&r(e.data)}))}),[o]);var l={labels:[],data:[]};return n.length&&(n.map((function(e){l.labels.push(e.name),l.data.push(e.total_cards)})),l.title=window.vibeprojects.translations.members+" "+window.vibeprojects.translations.cards),wp.element.createElement("div",{className:"task_reports_wrapper"},wp.element.createElement("div",{className:"task_report_header"},wp.element.createElement("h2",null,window.vibeprojects.translations.member_reports)),wp.element.createElement("div",{className:"project_member_reports"},wp.element.createElement("div",{className:"project_allmember_report"},l.data.length?wp.element.createElement(yu,{data:l}):""),wp.element.createElement("div",{className:"project_member_report_wrapper"},n.length?n.map((function(e){return wp.element.createElement("div",{className:"project_member_report"},function(e){var t,n={labels:[],data:[],bg:[]};return null!==(t=e.status)&&void 0!==t&&t.length&&e.status.map((function(e){n.data.push(e.count),n.labels.push(window.vibeprojects.settings.statuses.card[window.vibeprojects.settings.statuses.card.findIndex((function(t){return t.value==e.post_status}))].label),n.bg.push(window.vibeprojects.settings.statuses.card[window.vibeprojects.settings.statuses.card.findIndex((function(t){return t.value==e.post_status}))].color)})),wp.element.createElement("div",{className:"member_report"},wp.element.createElement("div",{className:"member_vitals"},wp.element.createElement("img",{src:e.avatar}),wp.element.createElement("strong",null,e.name)),wp.element.createElement("div",{className:"member_graphs"},wp.element.createElement("div",{className:"completed_graph"},wp.element.createElement("span",null,wp.element.createElement("span",null,parseInt(e.progress.data[1])),wp.element.createElement("span",null,window.vibeprojects.translations.completed)),wp.element.createElement("span",null,wp.element.createElement("span",null,parseInt(e.total_cards)-parseInt(e.progress.data[1])),wp.element.createElement("span",null,window.vibeprojects.translations.not_done)),wp.element.createElement("div",{className:"progress_wrap"},wp.element.createElement("div",{className:"progress_wrapper"},wp.element.createElement("span",{class:"increment",style:{width:Math.round(100*parseInt(e.progress.data[1])/parseInt(e.total_cards))+"%"}})),wp.element.createElement("span",null,Math.round(100*parseInt(e.progress.data[1])/parseInt(e.total_cards)),"%"))),wp.element.createElement("div",{className:"member_status_report"},wp.element.createElement(ju,{data:n})),wp.element.createElement("div",{className:"member_time_report"},wp.element.createElement(yu,{data:e.time,noaxes:"1"}))))}(e))})):"")))};function kf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Nf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nf(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Nf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var xf=wp.element,Sf=(xf.createElement,xf.render,xf.useState),Pf=xf.useEffect,If=xf.Fragment,Cf=xf.useContext,Af=wp.data,Df=Af.select,Rf=(Af.dispatch,window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/"),Tf=function(e){var t,n,r=Cf(l),a=kf(Sf([]),2),i=a[0],o=a[1],s=kf(Sf(null),2),c=s[0],d=s[1],p=kf(Sf(null),2),u=p[0],m=p[1],f=kf(Sf({data:[]}),2),b=f[0],v=f[1],w=kf(Sf("overview"),2),h=w[0],y=w[1];return Pf((function(){fetch("".concat(Rf,"/project/overview/"),{method:"post",body:JSON.stringify({project_id:r.path.project,token:Df("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&(o(e.data.snapshot),m(e.data.active_member),d(e.data.active_card),v(e.data.milestone))}))}),[]),Pf((function(){document.dispatchEvent(new CustomEvent("vibe_projects_report_"+h,{detail:{project_id:r.path.project}}))}),[h]),wp.element.createElement("div",{className:"project_reports_wrapper"},wp.element.createElement("div",{className:"project_reports_header"},wp.element.createElement("div",{className:"field buttons has-addons"},window.vibeprojects.settings.project_reports.map((function(e){return wp.element.createElement("p",{className:"control"},wp.element.createElement("a",{className:h==e.value?"button is-selected":"button",onClick:function(){return y(e.value)}},e.label))})))),wp.element.createElement("div",{className:"project_report"},"overview"==h?wp.element.createElement("div",{className:"project_overview"},wp.element.createElement("div",{className:"project_snapshot"},i.length?i.map((function(e){return wp.element.createElement("div",{className:"project_data project_data_"+e.key},wp.element.createElement("label",null,e.label),wp.element.createElement("strong",null,e.value),wp.element.createElement("span",null,e.desc))})):wp.element.createElement("div",{className:"vbp_message"},window.vibeprojects.translations.no_data_available)),wp.element.createElement("div",{className:"project_overview_sub_reports"},wp.element.createElement(If,null,u?wp.element.createElement("div",{className:"project_overview_sub_report"},wp.element.createElement("label",null,u.label),wp.element.createElement("div",{className:"activeMember"},wp.element.createElement("img",{src:u.member.avatar}),wp.element.createElement("strong",null,u.member.name)),wp.element.createElement("div",{className:"sub_report_stats"},wp.element.createElement("div",null,u.member.activity_count," Activities"),wp.element.createElement("div",null,u.member.task_count," Tasks"))):""),wp.element.createElement(If,null,c?wp.element.createElement("div",{className:"project_overview_sub_report"},wp.element.createElement("label",null,c.label),c.card?wp.element.createElement("div",{className:"activetask"},wp.element.createElement("strong",null,c.card.title),wp.element.createElement("span",{className:"progress_wrap"},wp.element.createElement("span",{className:"progress_wrapper"},wp.element.createElement("span",{className:"increment",style:{width:c.card.progress+"%"}})),wp.element.createElement("span",{className:"progress_label"},c.card.progress+"%")),wp.element.createElement("div",{className:"card_meta"},wp.element.createElement("span",{className:"task_status",style:{background:window.vibeprojects.settings.statuses.card[window.vibeprojects.settings.statuses.card.findIndex((function(e){return e.value==c.card.status}))].color}},window.vibeprojects.settings.statuses.card[window.vibeprojects.settings.statuses.card.findIndex((function(e){return e.value==c.card.status}))].label),c.card.hasOwnProperty("icons")&&c.card.icons.length?wp.element.createElement("div",{className:"card_icons"},c.card.icons.map((function(e){return wp.element.createElement("span",null,wp.element.createElement("span",{className:e.icon}),e.label)}))):"",c.card.hasOwnProperty("badges")&&c.card.badges.length?wp.element.createElement("div",{className:"card_badges"},c.card.badges.map((function(e){return wp.element.createElement("span",{className:"tip",title:e.label},wp.element.createElement("span",{className:e.icon}))}))):"",null!==(t=c.card)&&void 0!==t&&null!==(n=t.list)&&void 0!==n&&n.name?wp.element.createElement("span",{className:"task_list"},window.vibeprojects.translations.list," : ",c.card.list.name):""),wp.element.createElement("div",{className:"task_members"},c.card.members.map((function(e){return wp.element.createElement(I,{type:"user",id:{user_id:e}})})))):""):""),wp.element.createElement(If,null,b.data.length?wp.element.createElement("div",{className:"project_overview_sub_report milestones"},wp.element.createElement("label",null,b.label),wp.element.createElement("div",{className:"miltstones_wrap"},wp.element.createElement("div",{className:"miltstones_wrap_head"},wp.element.createElement("span",null,window.vibeprojects.translations.milestone),wp.element.createElement("span",null,window.vibeprojects.translations.status),wp.element.createElement("span",null,window.vibeprojects.translations.progress)),b.data.map((function(e){var t=window.vibeprojects.settings.statuses.card.findIndex((function(t){return t.value==e.status}));return wp.element.createElement("div",{className:"milestone_wrap"},wp.element.createElement("span",null,e.title),wp.element.createElement("span",{className:"milestone_status",style:{background:window.vibeprojects.settings.statuses.card[t].color}},window.vibeprojects.settings.statuses.card[t].label),wp.element.createElement("span",null,wp.element.createElement("div",{className:"progress_wrap"},wp.element.createElement("div",{className:"progress_wrapper"},wp.element.createElement("span",{className:"increment",style:{width:e.progress+"%"}})),wp.element.createElement("span",null,e.progress,"%"))))})))):""))):"tasks"==h?wp.element.createElement(uf,{type:"project",id:r.path.project}):"members"==h?wp.element.createElement(Of,{type:"project",id:r.path.project}):wp.element.createElement("div",{className:h})))};function Mf(e){return function(e){if(Array.isArray(e))return Hf(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Jf(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Uf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Uf(Object(n),!0).forEach((function(t){Lf(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Lf(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ff(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||Jf(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jf(e,t){if(e){if("string"==typeof e)return Hf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hf(e,t):void 0}}function Hf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Yf=wp.element,Vf=(Yf.createElement,Yf.render,Yf.useState),qf=Yf.useEffect,Wf=Yf.Fragment,Gf=Yf.useContext,zf=Yf.useRef,Xf=wp.data,Bf=Xf.select,Zf=Xf.dispatch,Qf=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",Kf=function(e){var t,n=zf(null),r=zf(null),a=Ff(Vf({}),2),i=(a[0],a[1]),o=Gf(l),s=Ff(Vf(e.project),2),c=s[0],d=s[1],p=Ff(Vf("project_description"),2),u=p[0],m=p[1],f=Ff(Vf([]),2),b=f[0],v=f[1],w=Ff(Vf([]),2),h=w[0],y=w[1],g=Ff(Vf("description"),2),_=g[0],j=g[1],O=Ff(Vf(!1),2),k=O[0],N=O[1],x=Ff(Vf({content:"",raw:{}}),2),S=x[0],P=x[1],C=Ff(Vf({team:"",member_type:"",notify:""}),2),A=C[0],D=C[1],R=Ff(Vf(!1),2),T=R[0],M=R[1];qf((function(){var t,n;if(d(e.project),null!==(t=o.path)&&void 0!==t&&t.project&&null!==(n=e.project)&&void 0!==n&&n.id&&o.path.project!=e.project.id){$f({},o.path);nprojectContext.path=$f($f({},nprojectContext.path),{},{project:e.project.id}),delete nprojectContext.tasks,o.update("full",nprojectContext)}}),[e.project]),qf((function(){h.length&&r&&r.current&&(r.current.hasOwnProperty("swiper")&&r.current.swiper.destroy(!0),setTimeout((function(){new Swiper(r.current,Lf({speed:400,spaceBetween:100,autoHeight:!0,effect:"slide",navigation:{nextEl:".swiper-next",prevEl:".swiper-prev",disabledClass:"swiper-disabled"},initialSlide:0,slidesPerView:1},"spaceBetween",0)),console.log("yes")}),1500))}),[h]),qf((function(){fetch("".concat(Qf,"/project/tabs/"),{method:"post",body:JSON.stringify({project_id:e.project.id,token:Bf("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&e.status&&(v(e.tabs),e.notices&&y(e.notices.sort((function(e,t){return t.timestamp-e.timestamp}))))}))}),[]),qf((function(){o.hasOwnProperty("path")&&b.length&&o.path.hasOwnProperty("board")&&o.path.board&&j("boards")}),[o.path,b]);qf((function(){document.dispatchEvent(new CustomEvent("vibe_projects_tab_change",{detail:{tab:_,project:e.project}}))}),[_]),qf((function(){var e=function(){n&&(n.current.removeAttribute("style"),i({maxWidth:n.current.getBoundingClientRect().width+"px"}))};return n&&(e(),window.addEventListener("resize",e)),function(){window.removeEventListener("resize",e)}}),[n]);var U=window.vibeprojects.settings.statuses.project.findIndex((function(t){return t.value==e.project.status}));return U<0&&(U=0),wp.element.createElement("div",{className:"full_project"},"description"==_?wp.element.createElement("div",{className:"project_header"},wp.element.createElement("div",{className:"links"},wp.element.createElement("span",null,wp.element.createElement("a",{onClick:function(){var t=$f({},o);delete t.board,delete t.path,o.update("full",t),e.back()},className:"vicon vicon-arrow-left"})),wp.element.createElement("span",null,wp.element.createElement("a",{onClick:function(){fetch("".concat(Qf,"/addfavproject"),{method:"post",body:JSON.stringify({project_id:e.project.id,token:Bf("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("message")&&Zf("vibebp").addNotification({text:e.message})}))},className:"vicon vicon-heart"}),H("create_project")?wp.element.createElement("a",{onClick:e.edit,className:"vicon vicon-settings"}):"")),wp.element.createElement("div",{className:"project_header_content"},wp.element.createElement("div",{className:"project_avatar"},wp.element.createElement("img",{src:c.image})),wp.element.createElement("div",{className:"project_details"},wp.element.createElement("h1",{dangerouslySetInnerHTML:{__html:c.name}}),wp.element.createElement("div",{className:"project_title_wrap"},wp.element.createElement("div",{className:"project_vitals"},wp.element.createElement("div",{className:"project_types"},wp.element.createElement("span",null,window.vibeprojects.translations.project_type),c.type.length?wp.element.createElement("div",{class:"project_types"},c.type.map((function(e){return wp.element.createElement("span",{className:"project_type tax_term",dangerouslySetInnerHTML:{__html:e.name}})}))):""),wp.element.createElement("div",{className:"project_status"},wp.element.createElement("span",null,window.vibeprojects.translations.status),wp.element.createElement("div",{className:"project_status"},wp.element.createElement("span",{className:"status "+e.project.status,style:{background:window.vibeprojects.settings.statuses.project[U].color}},window.vibeprojects.settings.statuses.project[U].label))),wp.element.createElement("div",{className:"project_owner"},wp.element.createElement("span",null,window.vibeprojects.translations.project_owner),wp.element.createElement(I,{id:{user_id:e.project.author}})),wp.element.createElement("div",{className:"project_progress"},wp.element.createElement("span",null,window.vibeprojects.translations.progress),wp.element.createElement("div",{className:"progress_wrap"},wp.element.createElement("span",{className:"progress_wrapper"},wp.element.createElement("span",{class:"increment",style:{width:e.project.project_progress+"%"}})),wp.element.createElement("span",{class:"progress_label"},e.project.project_progress+" %"))))),wp.element.createElement("div",{className:"item_meta"})))):wp.element.createElement("div",{className:"mini_project_header"},wp.element.createElement("div",{className:"links"},wp.element.createElement("a",{onClick:function(){var t=$f({},o);delete t.board,delete t.path,o.update("full",t),e.back()}},wp.element.createElement("span",{className:"vicon vicon-arrow-left"})," ",window.vibeprojects.translations.back_to_all_projects),wp.element.createElement("div",{className:"mini_project_details"},wp.element.createElement("div",{onClick:function(){return j("description")}},wp.element.createElement("img",{src:c.image}),wp.element.createElement("h1",{dangerouslySetInnerHTML:{__html:c.name}})),_&&"description"!==_?wp.element.createElement("div",{className:"active_tab",onClick:function(){j("description");var e=$f({},o);delete e.path.board,delete e.board,o.update("full",e)}},wp.element.createElement("span",{className:"vicon vicon-angle-right"}),wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:b[b.findIndex((function(e){return e.value==_}))].label}})):"","boards"==_?wp.element.createElement("div",{className:"active_tab",onClick:function(){var e=$f({},o);delete e.path.board,delete e.board,o.update("full",e)}},wp.element.createElement("span",{className:"vicon vicon-angle-right"}),wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:null===(t=o.board)||void 0===t?void 0:t.title}})):""))),wp.element.createElement("div",{className:"project_main"},"description"==_&&b.length?wp.element.createElement("div",{className:"project_tabs_wrapper"},wp.element.createElement("div",{className:"project_tabs"},b.map((function(e){return wp.element.createElement("div",{className:_==e.value?"project_tab active":"project_tab",onClick:function(){return j(e.value)}},wp.element.createElement("span",{dangerouslySetInnerHTML:{__html:e.label}}))})))):"",wp.element.createElement("div",{className:"project_tabs_content_wrapper",ref:n},""==_||"description"==_?wp.element.createElement("div",{className:"project_tabs_content"},wp.element.createElement("div",{className:"sub_flex"},wp.element.createElement("div",{className:"project_description_wrap"},wp.element.createElement("div",{className:"meta_group"},e.project.meta.length?e.project.meta.map((function(e){return wp.element.createElement("div",{className:"meta_value field_type"+e.type+" field_"+e.key},e.icon?wp.element.createElement("span",null,wp.element.createElement("span",{className:e.icon}),wp.element.createElement("span",null,e.desc)):e.label?wp.element.createElement("span",null,e.label):"",wp.element.createElement("span",{className:"mea"},"start_date"==e.key||"end_date"==e.key?wp.element.createElement(E,{timestamp:e.value}):"S"==e.value?window.vibeprojects.translations.on:window.vibeprojects.settings.additional_fields.create_project_fields.findIndex((function(t){return t.key==e.key}))>-1&&"select"==window.vibeprojects.settings.additional_fields.create_project_fields[window.vibeprojects.settings.additional_fields.create_project_fields.findIndex((function(t){return t.key==e.key}))].type&&window.vibeprojects.settings.additional_fields.create_project_fields[window.vibeprojects.settings.additional_fields.create_project_fields.findIndex((function(t){return t.key==e.key}))].options.findIndex((function(t){return t.value==e.value}))>-1?window.vibeprojects.settings.additional_fields.create_project_fields[window.vibeprojects.settings.additional_fields.create_project_fields.findIndex((function(t){return t.key==e.key}))].options[window.vibeprojects.settings.additional_fields.create_project_fields[window.vibeprojects.settings.additional_fields.create_project_fields.findIndex((function(t){return t.key==e.key}))].options.findIndex((function(t){return t.value==e.value}))].label:e.value))})):""),wp.element.createElement("div",{className:"full_project_notices_wrapper"},wp.element.createElement("h3",null,window.vibeprojects.translations.notices),wp.element.createElement(Wf,null,h.length?wp.element.createElement("div",{class:"project_notices_swiper swiper",ref:r},wp.element.createElement("div",{class:"swiper-wrapper"},h.map((function(t){return wp.element.createElement("div",{class:"swiper-slide"},wp.element.createElement("div",{className:"full_project_notice"},wp.element.createElement("div",{className:"project_notice_header"},wp.element.createElement("span",null,wp.element.createElement("span",{className:"vicon vicon-clock"}),window.vibeprojects.translations.posted+" ",wp.element.createElement(E,{timestamp:t.timestamp})," "+window.vibeprojects.translations.ago),H("add_project_notice")?wp.element.createElement("span",{className:"vicon vicon-trash",onClick:function(){return function(t){M(!0),fetch("".concat(Qf,"/deleteNotice"),{method:"post",body:JSON.stringify({project_id:e.project.id,notice:t,token:Bf("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){M(!1),e.hasOwnProperty("message")&&Zf("vibebp").addNotification({text:e.message})}))}(t)}}):""),wp.element.createElement("div",{className:"notice_description",dangerouslySetInnerHTML:{__html:t.content}})))}))),h.length>1?wp.element.createElement(Wf,null,wp.element.createElement("span",{className:"swiper-prev swiper-button vicon vicon-arrow-left"}),wp.element.createElement("span",{className:"swiper-next swiper-button vicon vicon-arrow-right"})):""):""),k?wp.element.createElement("div",{className:"add_notice_textarea"},wp.element.createElement(ha,{field:{id:"content",raw:S.raw,value:S.content},fieldIndex:0,tabIndex:0,update:function(e,t){P({raw:e.raw,content:e.value})}}),wp.element.createElement("div",{className:"notice_args"},wp.element.createElement("label",null,window.vibeprojects.translations.notification_for),wp.element.createElement(Vr,{field:{id:"team",options:[{value:"",label:window.vibeprojects.translations.select_member_team},{value:"all",label:window.vibeprojects.translations.all}].concat(Mf(window.vibeprojects.settings.memberTeams.map((function(e){return{value:e.term_id,label:e.name}})))),value:A.team},fieldIndex:0,tabIndex:0,update:function(e,t){D($f($f({},A),{},{team:e.value}))}}),wp.element.createElement(Vr,{field:{id:"member_type",options:[{value:"",label:window.vibeprojects.translations.select_member_type},{value:"all",label:window.vibeprojects.translations.all}].concat(Mf(window.vibeprojects.settings.memberTypes.map((function(e){return{value:e.db_id,label:e.name}})))),value:A.member_type},fieldIndex:0,tabIndex:0,update:function(e,t){D($f($f({},A),{},{member_type:e.value}))}}),wp.element.createElement("div",null,wp.element.createElement("label",null,window.vibeprojects.translations.notify_users),wp.element.createElement(Hn,{field:{id:"notify",value:A.notify},fieldIndex:0,tabIndex:0,update:function(e,t){D($f($f({},A),{},{notify:e.value}))}}))),wp.element.createElement("div",{className:"action_buttons"},wp.element.createElement("a",{className:T?"button is-loading is-primary":"button is-primary",onClick:function(){M(!0),fetch("".concat(Qf,"/addNotice"),{method:"post",body:JSON.stringify($f($f($f({project_id:e.project.id},S),A),{},{token:Bf("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){M(!1),e.status&&(N(!1),y([].concat(Mf(h),[e.notice]))),e.hasOwnProperty("message")&&Zf("vibebp").addNotification({text:e.message})}))}},window.vibeprojects.translations.add_notice),wp.element.createElement("a",{className:"link",onClick:function(){return N(!1)}},window.vibebp.translations.cancel))):H("add_project_notice")?wp.element.createElement("a",{className:"button is-primary",onClick:function(){return N(!0)}},window.vibeprojects.translations.add_notice," ",wp.element.createElement("span",{className:"vicon vicon-plus"})):""),wp.element.createElement("div",{className:"full_project_description_wrapper"},wp.element.createElement("strong",null,window.vibeprojects.translations.project_description),wp.element.createElement("div",{class:u,onClick:function(){u.indexOf("active")>-1?m("project_description"):m("project_description active")},"data-more":c.description.length>100?window.vibeprojects.translations.more:"",dangerouslySetInnerHTML:{__html:c.description}}))))):"members"==_?wp.element.createElement(le,{project:e.project}):"boards"==_?wp.element.createElement(km,{project:e.project}):"gantt"==_?wp.element.createElement(Ym,{project:e.project}):"notes"==_?wp.element.createElement(de,{project:e.project}):"activity"==_?wp.element.createElement(zm,{project:e.project}):"user_stories"==_?wp.element.createElement(UserStories,{project:e.project}):"reports"==_?wp.element.createElement(Tf,{project:e.project}):wp.element.createElement("div",{className:"project_tab_content_wrapper"},wp.element.createElement("div",{className:"project_tab_content "+_})))))};function eb(e){return function(e){if(Array.isArray(e))return ob(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ib(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tb(Object(n),!0).forEach((function(t){rb(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ab(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||ib(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ib(e,t){if(e){if("string"==typeof e)return ob(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ob(e,t):void 0}}function ob(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var lb=wp.element,sb=(lb.createElement,lb.render,lb.useState),cb=lb.useEffect,db=lb.Fragment,pb=lb.useContext,ub=wp.data,mb=ub.dispatch,fb=ub.select,bb=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",vb=function(e){var t=pb(l),n=ab(sb({}),2),r=(n[0],n[1],ab(sb(!0),2)),a=(r[0],r[1],ab(sb(!1),2)),i=a[0],o=a[1],s=ab(sb([]),2),c=s[0],d=s[1],p=ab(sb({id:e.edit,post_title:"",post_content:"",meta:[],taxonomy:[],members:[]}),2),u=p[0],m=p[1],f=ab(sb({post_content:"",raw:[]}),2),b=f[0],v=f[1],w=ab(sb({post_title:"",raw:[]}),2),h=(w[0],w[1],ab(sb([]),2)),y=(h[0],h[1],ab(sb(!1),2)),g=y[0],_=y[1],E=ab(sb(!1),2),j=E[0],O=E[1];cb((function(){e.edit&&m(nb(nb({},u),{},{id:e.edit}))}),[e.edit]),cb((function(){o(!0),fetch("".concat(bb,"/project/getFields?force"),{method:"post",body:JSON.stringify({project_id:e.edit,token:fb("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){o(!1),e.status&&d(e.fields)}))}),[]);var k=function(e,t){var n=e.field;if(c.findIndex((function(e){return e.id==n.id}))>-1){var r=eb(c);r[c.findIndex((function(e){return e.id==n.id}))]=n,d(r)}if("fieldvaluechanged"==t){if("post"==n.from)if("editor"==n.type)v({post_content:n.value,raw:n.raw});else{var a=nb({},u);a[n.id]=n.value,m(a)}if("meta"==n.from){var i=nb({},u),o=i.meta.findIndex((function(e){return e.meta_key==n.id}));o>-1?i.meta[o].meta_value=n.value:i.meta.push({meta_key:n.id,meta_value:n.value}),m(i)}if("taxonomy"==n.from){var l=nb({},u),s=l.taxonomy.findIndex((function(e){return e.taxonomy==n.id}));s>-1?l.taxonomy[s].value=n.value:l.taxonomy.push({taxonomy:n.id,terms:n.value}),m(l)}}};return wp.element.createElement("div",{className:"new_project"},c.length?wp.element.createElement(db,null,wp.element.createElement("div",{className:"links"},wp.element.createElement("a",{onClick:function(){e.back(),t.update("new",!1)},className:"vicon vicon-arrow-left"})),wp.element.createElement("div",{className:"project_create_form"},wp.element.createElement("div",{className:"project_essentails"},wp.element.createElement("div",{className:"project_featured"},wp.element.createElement(jo,{field:c[0],update:k})),wp.element.createElement("div",{className:"project_title_wrap"},wp.element.createElement(jo,{field:c[1],update:k}),wp.element.createElement("div",{className:"project_title_sub"},wp.element.createElement(jo,{field:c[2],update:k}),wp.element.createElement(jo,{field:c[3],update:k})))),wp.element.createElement("div",{className:"project_fields"},c.map((function(t,n){if(n>3)return wp.element.createElement("div",{className:t.style},wp.element.createElement(jo,{field:nb(nb({},t),{},{raw:{},post_id:e.edit?e.edit:""}),update:k}))}))),wp.element.createElement("div",{className:"button_create_project"},wp.element.createElement("div",{className:"button_group"},wp.element.createElement("a",{onClick:function(){o(!0),fetch("".concat(bb,"/project/newproject?post"),{method:"post",body:JSON.stringify(nb(nb(nb({},u),b),{},{token:fb("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(t){o(!1),t.status&&(e.projectadded(t.data),e.back())}))},className:i?"create_project button is-loading":"create_project button"},u.hasOwnProperty("project_id")?window.vibeprojects.translations.update_project:window.vibeprojects.translations.create_project),e.edit?wp.element.createElement("a",{className:"button is-secondary",onClick:function(){return O(!0)}},window.vibeprojects.translations.delete_project):""),wp.element.createElement("span",{className:"link",onClick:function(){return t.update("new",!1)}},window.vibeprojects.translations.cancel)))):wp.element.createElement("div",{class:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)),j?wp.element.createElement(Y,{open:j,onClose:function(){return O(!1)}},wp.element.createElement("div",{className:"modal-header"},window.vibeprojects.translations.delete_project_heading),wp.element.createElement("span",{className:"modal-body"},window.vibeprojects.translations.delete_project_message),wp.element.createElement("div",{className:"modal-footer"},wp.element.createElement("a",{className:g?"delete_project_button_wrapper button is-loading is-secondary":"delete_project_button_wrapper button is-secondary",onClick:function(){_(!0),fetch("".concat(bb,"/project/delete/").concat(e.edit,"/"),{method:"post",body:JSON.stringify({project_id:e.edit,token:fb("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(t){t.status&&(mb("vibebp").addNotification({text:t.message}),_(!1),e.delete())}))}},window.vibeprojects.translations.confirm),wp.element.createElement("a",{className:"link",onClick:function(){return O(!1)}},window.vibeprojects.translations.cancel))):"")};function wb(e){return function(e){if(Array.isArray(e))return jb(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Eb(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function yb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?hb(Object(n),!0).forEach((function(t){gb(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||Eb(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Eb(e,t){if(e){if("string"==typeof e)return jb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jb(e,t):void 0}}function jb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ob=wp.element,kb=(Ob.createElement,Ob.render,Ob.useState),Nb=Ob.useEffect,xb=Ob.Fragment,Sb=Ob.useContext,Pb=(Ob.useCallback,wp.data),Ib=Pb.select,Cb=(Pb.dispatch,window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/"),Ab=function(e){var t=Sb(l),n=_b(kb({page:1,search:"",sort:"",scope:e.type,context:"snapshot"}),2),r=n[0],a=n[1],i=_b(kb(!1),2),o=i[0],s=i[1],c=_b(kb([]),2),d=c[0],p=c[1],u=_b(kb(0),2),m=u[0],f=u[1],b=_b(kb(!1),2),v=b[0],w=b[1],h=_b(kb(!0),2),y=h[0],g=h[1],_=_b(kb(""),2),E=(_[0],_[1]),j=_b(kb(!1),2),O=j[0],k=j[1],N=_b(kb(!1),2),x=N[0],S=N[1],P=_b(kb(!0),2),I=(P[0],P[1],_b(kb(null),2)),C=I[0],A=(I[1],_b(kb("grid"),2)),D=A[0],R=A[1],T=_b(kb(window.vibeprojects.settings.project.listView),2),M=T[0],U=T[1],$=_b(kb(!1),2),F=$[0],J=$[1];Nb((function(){s(!1),w(!1),a(yb(yb({},r),{},{scope:e.type}))}),[e.type]),Nb((function(){var e;g(!0);var n,a=yb({},r);null!==(e=t.path)&&void 0!==e&&e.project&&(a.post__in=null===(n=t.path)||void 0===n?void 0:n.project);fetch("".concat(Cb,"/projects/?args=").concat(encodeURIComponent(JSON.stringify(yb(yb({},r),{},{search:""})))),{method:"post",body:JSON.stringify({args:a,token:Ib("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){if(g(!1),e.status)if(o){var t=[].concat(wb(d),wb(e.data));p(t),t.length<e.total?w(!0):w(!1)}else p(e.data),e.data.length<e.total?w(!0):w(!1);else p([]),E(e.message)}))}),[r]);var Y=function(e){a(yb(yb({},r),{},{paged:1}))};Nb((function(){return C?document.removeEventListener("vibebp_component_reload",Y):document.addEventListener("vibebp_component_reload",Y),function(){document.removeEventListener("vibebp_component_reload",Y)}})),Nb((function(){t.hasOwnProperty("path")&&t.path&&d.length&&(t.path.hasOwnProperty("project")?f(t.path.project):f(0))}),[t.path,d]),Nb((function(){localforage.getItem("projectsView").then((function(e){e&&R(e)}))}),[]),Nb((function(){t.new?(k(!1),S(!0)):S(!1)}),[t.new]);var V=wb(d);return r.search.length&&d.length&&(V=V.filter((function(e){return e.name.toLowerCase().includes(r.search.toLowerCase())}))),wp.element.createElement("div",{className:"view_projects_list"},x?wp.element.createElement(vb,{edit:O,back:function(){k(!1),S(!1)},projectadded:function(e){return function(e){var t=wb(d);t.findIndex((function(t){return t.id==e.id}))>-1?t[t.findIndex((function(t){return t.id==e.id}))]=e:t.unshift(e),p(t),S(!1),k(!1),f(t.findIndex((function(t){return t.id==e.id})))}(e)},delete:function(){S(!1);var e=wb(d),n=e.findIndex((function(e){return e.id==O}));f(!1),k(!1),n>-1&&e.splice(n,1),p(e);var r=yb({},t);r.hasOwnProperty("path")&&r.path.hasOwnProperty("project")&&(delete r.path.project,t.update("path",r.path))}}):m&&d.findIndex((function(e){return e.id==m}))>-1&&Object.keys(d[d.findIndex((function(e){return e.id==m}))]).length?wp.element.createElement(Kf,{back:function(){f(!1),t.update("path",{}),k(!1)},edit:function(){k(m),f(0),S(!0)},project:d[d.findIndex((function(e){return e.id==m}))]}):wp.element.createElement(xb,null,wp.element.createElement("div",{className:"vibe_projects_actions_container"},wp.element.createElement("div",{className:"vibe_projects_sort_search_container"},wp.element.createElement("div",{className:"vibe_projects_search_bar"},wp.element.createElement("input",{type:"text",value:r.search,onChange:function(e){a(yb(yb({},r),{},{search:e.target.value}))},placeholder:window.vibeprojects.translations.type_to_search}),wp.element.createElement("span",{className:"vicon vicon-search"})),wp.element.createElement("div",null,wp.element.createElement("span",null,wp.element.createElement("span",{className:"grid"==D?"active":"",onClick:function(){R("grid"),localforage.setItem("projectsView","grid")}},wp.element.createElement("span",{className:"vicon vicon-layout-grid2"})),wp.element.createElement("span",{className:"list"==D?"active":"",onClick:function(){R("list"),localforage.setItem("projectsView","list")}},wp.element.createElement("span",{className:"vicon vicon-view-list"}))),wp.element.createElement("select",{onChange:function(e){a(yb(yb({},r),{},{status:e.target.value}))},value:r.status},wp.element.createElement("option",{value:""},window.vibeprojects.translations.select_status),window.vibeprojects.settings.statuses.project.map((function(e){return wp.element.createElement("option",{value:e.value},e.label)}))))),y?wp.element.createElement("div",{class:"lds-ellipsis"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):"",V.length?wp.element.createElement(xb,null,wp.element.createElement("div",{className:"grid"==D?"grid_projects":"list_projects"},"list"==D?wp.element.createElement("div",{className:"project_list_header project_list_item"},M.filter((function(e){return e.selected})).map((function(e){return wp.element.createElement("span",{className:"project_info_"+e.key},e.label)})),wp.element.createElement("div",{className:"project_custom_fields_expand tip bottom right",title:window.vibeprojects.translations.show_hide_fields},wp.element.createElement("span",{className:F?"vicon vicon-close":"vicon vicon-plus",onClick:function(){return J(!F)}}),F?wp.element.createElement("div",{className:"project_custom_fields_selector"},M.map((function(e,t){return wp.element.createElement("span",{className:"project_custom_field"},wp.element.createElement("input",{type:"checkbox",id:e.key,value:"1",defaultChecked:e.selected,onChange:function(e){var n=wb(M);n[t].selected=!n[t].selected,U(n)}}),wp.element.createElement("label",{for:e.key},e.label))}))):"")):"",V.map((function(e){return wp.element.createElement(L,{project:e,view:D,projectListItems:M,open:function(){return t.update("path",{project:e.id})}})}))),wp.element.createElement(xb,null,v?wp.element.createElement("a",{className:"link",onClick:function(){s(!0),a(yb(yb({},r),{},{page:r.page+1}))}},window.vibebp.translations.load_more):"")):y?"":wp.element.createElement(xb,null,d.length?H("create_project")?wp.element.createElement("div",{className:"add_new_project_div",onClick:function(){return S(!0)},title:window.vibeprojects.translations.add_new_project},wp.element.createElement("span",{className:"vicon vicon-plus"})):"":wp.element.createElement("div",{className:"message vbp_message"},window.vibeprojects.translations.no_projects_found)))))};function Db(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Db(Object(n),!0).forEach((function(t){Tb(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Db(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Tb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Mb=function(e){var t=[];return e.map((function(e){var n,r,a,i,o=Rb({},e);(e.id&&(o.id=e.id),e.title&&(o.title=e.hasOwnProperty("postfix")?e.title+e.postfix:e.title),e.badges.length)&&(e.badges.findIndex((function(e){return"duedate"==e.key}))>-1&&e.badges[e.badges.findIndex((function(e){return"duedate"==e.key}))].value?o.end=new Date(1e3*e.badges[e.badges.findIndex((function(e){return"duedate"==e.key}))].value):null!==(n=e.badges[e.badges.findIndex((function(e){return"duedate"==e.key}))])&&void 0!==n&&null!==(r=n.date)&&void 0!==r&&r.length?o.end=new Date(e.badges[e.badges.findIndex((function(e){return"duedate"==e.key}))].date):o.end=new Date,e.badges.findIndex((function(e){return"startdate"==e.key}))>-1?e.badges[e.badges.findIndex((function(e){return"startdate"==e.key}))].value?o.start=new Date(1e3*e.badges[e.badges.findIndex((function(e){return"startdate"==e.key}))].value):null!==(a=e.badges[e.badges.findIndex((function(e){return"startdate"==e.key}))])&&void 0!==a&&null!==(i=a.date)&&void 0!==i&&i.length&&(o.start=new Date(e.badges[e.badges.findIndex((function(e){return"startdate"==e.key}))].date)):o.start=new Date);if(e.hasOwnProperty("badges")&&Array.isArray(e.badges)&&e.badges.length){var l=e.badges.findIndex((function(e){return"recurring"==e.key}));l>-1&&e.badges[l].value&&(o.groupId=o.id,"daysOfWeek"==e.badges[l].value.recurring?o.daysOfWeek=e.meta[l].meta_value.daysOfWeek:"everyDay"==e.meta[l].meta_value.recurring&&(o.daysOfWeek=[0,1,2,3,4,5,6]),e.badges.map((function(e){e.meta_key&&e.meta_value&&("start"==e.meta_key?(o.nstart=e.meta_value,o.startTime=new Date(e.meta_value).getHours()+":"+new Date(e.meta_value).getMinutes(),o.startRecur=new Date(e.meta_value)):"end"==e.meta_key?(o.nend=e.meta_value,o.endTime=new Date(e.meta_value).getHours()+":"+new Date(e.meta_value).getMinutes(),o.endRecur=new Date(e.meta_value)):"color"==e.meta_key&&(o.color=e.meta_value))})))}t.push(o)})),t};function Ub(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ub(Object(n),!0).forEach((function(t){Lb(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ub(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Lb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fb(e,t,n,r,a,i,o){try{var l=e[i](o),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,a)}function Jb(e){return function(e){if(Array.isArray(e))return Vb(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Yb(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Hb(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||Yb(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yb(e,t){if(e){if("string"==typeof e)return Vb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vb(e,t):void 0}}function Vb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var qb=wp.element,Wb=qb.useState,Gb=qb.useEffect,zb=qb.createRef,Xb=qb.useContext,Bb=(qb.useRef,wp.data),Zb=Bb.select,Qb=(Bb.dispatch,window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/"),Kb=function(e){var t=Xb(l),n=Hb(Wb([]),2),r=n[0],a=n[1],i=Hb(Wb([]),2),o=i[0],s=i[1],c=zb(null),d=Hb(Wb(),2),p=d[0],u=d[1],m=Hb(Wb({calendarView:"dayGridMonth",slotDuration:"00:15:00",editable:!0,droppable:!0}),2),f=m[0];m[1];Gb((function(){var t;if(null!==(t=e.cards)&&void 0!==t&&t.length){var n=[],r=Jb(o),i=[],l=[];e.cards.map((function(e){var t,a;null!==(t=e.badges)&&void 0!==t&&t.length&&e.badges.findIndex((function(e){return"startdate"==e.key}))>-1?e.start=new Date(1e3*parseInt(e.badges[e.badges.findIndex((function(e){return"startdate"==e.key}))].value)):e.start=new Date,null!==(a=e.badges)&&void 0!==a&&a.length&&e.badges.findIndex((function(e){return"duedate"==e.key}))>-1?e.end=new Date(1e3*parseInt(e.badges[e.badges.findIndex((function(e){return"duedate"==e.key}))].value)):e.end=new Date,e.allDay=!0,l.push(e),e.members.map(function(){var e,t=(e=regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null,o.length&&-1!=o.findIndex((function(e){return e.key==t}))||i.push(localforage.getItem("user_"+t).then((function(e){e?(e=JSON.parse(e),r.push($b($b({},e),{},{key:t}))):-1==n.indexOf(t)&&n.push(t)})));case 2:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){Fb(i,r,a,o,l,"next",e)}function l(e){Fb(i,r,a,o,l,"throw",e)}o(void 0)}))});return function(e){return t.apply(this,arguments)}}())})),Promise.all(i).then((function(){n.length?fetch("".concat(window.vibebp.api.url,"/avatars?ids=").concat(JSON.stringify(n),"&client_id=").concat(window.vibebp.settings.client_id),$b($b({},opts),{},{method:"post",body:JSON.stringify({ids:n,type:"user",token:Zb("vibebp").getToken()})})).then((function(e){return e.json()})).then((function(e){e.status&&(e.values.map((function(e){r.push(e)})),s(r),a(l))})):(s(r),a(l))}))}}),[e.cards]);return Gb((function(){if(c&&o.length&&r.length){var n={initialView:f.calendarView,themeSystem:"bootstrap",headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},editable:f.editable,droppable:f.droppable,eventContent:function(t){var n=t.event._def.extendedProps,r=window.vibeprojects.settings.statuses.card.findIndex((function(e){return e.value==n.status})),a="";return"mine"==e.type?a+="<span>".concat(n.project?n.project.title:window.vibeprojects.translations.no_project,"</span>"):(a+='<div class="event_members">',n.members.map((function(e){o.length&&(a+='<div class="event_member"><img src='.concat(o[o.findIndex((function(t){return t.key==e}))].avatar," title=").concat(o[o.findIndex((function(t){return t.key==e}))].name,"/></div>"))})),a+="</div>"),{html:'\n                  <div class="cal_event">\n                    <div class="fc-event-time">'.concat(t.timeText,'</div>\n                    <div class="fc-event-title"><span class="event_status" style="background:').concat(r>-1?window.vibeprojects.settings.statuses.card[r].color:"",'">').concat(r>-1?window.vibeprojects.settings.statuses.card[r].label:"Active","</span> \n                    <span>").concat(t.event._def.title,'</span></div>\n                    <div class="fc-event-id"> ').concat(a,"</div>\n                    </div> ")}},eventReceive:function(e){var t=$b($b({},e.event._def.extendedProps),e.event._instance.range);console.log("event",e,t)},eventClick:function(t,n,r){e.show(t.event._def.extendedProps.card_id)},eventDrop:function(e){var n=Jb(r),a=e.event._def.extendedProps,i=e.event._instance.range;if(n.findIndex((function(e){return e.card_id==a.card_id}))>-1){var o,l,s=n[n.findIndex((function(e){return e.card_id==a.card_id}))];-1==s.badges.findIndex((function(e){return"startdate"==e.key}))&&s.badges.push({date:"",key:"startdate",value:""}),-1==s.badges.findIndex((function(e){return"duedate"==e.key}))&&s.badges.push({date:"",key:"duedate",value:""}),s.badges[s.badges.findIndex((function(e){return"startdate"==e.key}))].date=i.start.getFullYear()+"-"+i.start.getMonth()+"-"+i.start.getDate(),s.badges[s.badges.findIndex((function(e){return"startdate"==e.key}))].value=Math.round(i.start.getTime()/1e3),s.badges[s.badges.findIndex((function(e){return"duedate"==e.key}))].date=i.end.getFullYear()+"-"+i.end.getMonth()+"-"+i.end.getDate(),s.badges[s.badges.findIndex((function(e){return"duedate"==e.key}))].value=Math.round(i.end.getTime()/1e3),s.dates=[Math.round(i.start.getTime()/1e3),Math.round(i.end.getTime()/1e3)],n[n.findIndex((function(e){return e.card_id==a.card_id}))]=s;fetch("".concat(Qb,"/card/updateTask/?post"),{method:"post",body:JSON.stringify({task:s,type:"dates",project_id:null!==(o=t.path)&&void 0!==o&&o.project?t.path.project:null===(l=s.project)||void 0===l?void 0:l.id,token:Zb("vibebp").getToken()})})}},eventResizeStop:function(e){console.log(e.event);var n=Jb(r),a=e.event._def.extendedProps,i=e.event._instance.range;if(n.findIndex((function(e){return e.card_id==a.card_id}))>-1){var o,l=n[n.findIndex((function(e){return e.card_id==a.card_id}))];-1==l.badges.findIndex((function(e){return"startdate"==e.key}))&&l.badges.push({date:"",key:"startdate",value:""}),-1==l.badges.findIndex((function(e){return"duedate"==e.key}))&&l.badges.push({date:"",key:"duedate",value:""}),l.badges[l.badges.findIndex((function(e){return"startdate"==e.key}))].date=i.start.getFullYear()+"-"+i.start.getMonth()+"-"+i.start.getDate(),l.badges[l.badges.findIndex((function(e){return"startdate"==e.key}))].value=Math.round(i.start.getTime()/1e3),l.badges[l.badges.findIndex((function(e){return"duedate"==e.key}))].date=i.end.getFullYear()+"-"+i.end.getMonth()+"-"+i.end.getDate(),l.badges[l.badges.findIndex((function(e){return"duedate"==e.key}))].value=Math.round(i.end.getTime()/1e3),l.dates=[Math.round(i.start.getTime()/1e3),Math.round(i.end.getTime()/1e3)],n[n.findIndex((function(e){return e.card_id==a.card_id}))]=l;fetch("".concat(Qb,"/card/updateTask/?post"),{method:"post",body:JSON.stringify({task:l,type:"dates",project_id:null!==(o=t.path)&&void 0!==o&&o.project?t.path.project:l.project.id,token:Zb("vibebp").getToken()})})}},datesSet:function(t){var n=t.view.activeStart.getTime(),r=t.view.activeEnd.getTime();e.updateFilter&&e.updateFilter(n,r)}};!p&&r.length&&(n.events=Mb(r));var a=new FullCalendar.Calendar(c.current,n);p&&(p.setOption("events",Mb(r)),a=p),a.render(),u(a)}}),[r,o]),wp.element.createElement("div",{className:"vibe_fullcalendar_wrapper"},wp.element.createElement("div",{class:"vibe_fullcalendar"},wp.element.createElement("div",{id:"fullcalendar",ref:c})))};function ev(e){return function(e){if(Array.isArray(e))return ov(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||iv(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tv(Object(n),!0).forEach((function(t){rv(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function av(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||iv(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function iv(e,t){if(e){if("string"==typeof e)return ov(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ov(e,t):void 0}}function ov(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var lv=wp.element,sv=(lv.createElement,lv.render,lv.useState),cv=lv.useEffect,dv=(lv.Fragment,lv.useContext),pv=wp.data,uv=pv.dispatch,mv=pv.select,fv=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",bv=function(e){var t,n=dv(l),r=av(sv([]),2),a=r[0],i=r[1],o=av(sv({}),2),s=(o[0],o[1],av(sv(!1),2)),c=s[0],d=s[1],p=av(sv(null),2),u=(p[0],p[1],av(sv(!1),2)),m=u[0],f=u[1],b=av(sv(""),2),v=b[0],w=b[1],h=av(sv(""),2),y=h[0],g=h[1],_=av(sv(rv({posts_per_page:-1,type:"mine",start:"",end:"",page:1},"posts_per_page",-1)),2),E=_[0],j=_[1];cv((function(){var e=nv({},n);nv({},n.path);delete e.path.project,delete e.path.board,delete e.bulkAction,delete e.selectedCards,delete e.boardFilters,n.update("multiple",nv({},e))}),[]),cv((function(){var t,n;null!==(t=e.board)&&void 0!==t&&null!==(n=t.cards)&&void 0!==n&&n.length&&i(e.board.cards)}),[null===(t=e.board)||void 0===t?void 0:t.cards]),cv((function(){var e;null!==(e=n.tasks)&&void 0!==e&&e.length&&i(n.tasks)}),[n.tasks]),cv((function(){"mine"==e.type&&fetch("".concat(fv,"/tasks"),{method:"post",body:JSON.stringify({args:E,token:mv("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&n.update("tasks",e.tasks),e.hasOwnProperty("message")&&uv("vibebp").addNotification({text:e.message})}))}),[E]);var O=ev(a);return m||(O=O.filter((function(e){return-1==e.icons.findIndex((function(e){return"complete"==e.key}))}))),y.length&&(O=O.filter((function(e){return e.status==y}))),v.length&&(O=O.filter((function(e){return e.title.indexOf(v)>-1}))),wp.element.createElement("div",{className:"vibe_projects_calendar"},"mine"==e.type?wp.element.createElement("div",{className:"my_tasks_header"},wp.element.createElement("div",{className:"search_bar"},wp.element.createElement("input",{type:"text",value:v,onChange:function(e){return w(e.target.value)},placeholder:window.vibeprojects.translations.search_task}),wp.element.createElement("span",{className:"vicon vicon-search"})),wp.element.createElement("div",{className:"checkbox"},wp.element.createElement("input",{type:"checkbox",id:"completed_cards",value:"1",onClick:function(){return f(!m)}}),wp.element.createElement("label",{for:"completed_cards"},window.vibeprojects.translations.show_completed)),wp.element.createElement("select",{value:y,onChange:function(e){return g(e.target.value)}},wp.element.createElement("option",null,window.vibeprojects.translations.select_status),window.vibeprojects.settings.statuses.card.map((function(e){return wp.element.createElement("option",{value:e.value},e.label)})))):"",c?wp.element.createElement(Mc,{card:c,close:function(){return d(!1)}}):"",wp.element.createElement("div",{className:"vibecal_wrapper"},wp.element.createElement(Kb,{cards:O,type:e.type,show:function(e){d(a[a.findIndex((function(t){return t.card_id==e}))])},updateFilter:function(e,t){j(nv(nv({},E),{},{start:e,end:t}))},updateCards:function(e){n.update("tasks",e)}})))};function vv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?vv(Object(n),!0).forEach((function(t){hv(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yv(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return gv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gv(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var _v=wp.element,Ev=(_v.createElement,_v.render,_v.useState),jv=_v.useEffect,Ov=_v.Fragment,kv=(_v.useContext,wp.data),Nv=kv.select,xv=(kv.dispatch,function(e){var t=yv(Ev(!1),2),n=t[0],r=t[1],a=yv(Ev([]),2),i=a[0],o=a[1],l=yv(Ev(!0),2),s=(l[0],l[1],yv(Ev({type:"member",dates:[]}),2)),c=s[0];s[1];return jv((function(){r(!0),fetch("".concat(window.vibeprojects.apiUrl,"/memberReports/?args=").concat(JSON.stringify(c)),{method:"post",body:JSON.stringify(wv(wv({},c),{},{token:Nv("vibebp").getToken()}))}).then((function(e){return e.json()})).then((function(e){r(!1),e.status&&o(e.data)}))}),[c]),wp.element.createElement("div",{className:"task_reports_wrapper"},wp.element.createElement("strong",{className:"task_report_header"},window.vibeprojects.translations.reports),wp.element.createElement("div",{className:"task_reports_wrap"},n?wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):wp.element.createElement(Ov,null,i.length?i.map((function(e){return wp.element.createElement("div",{className:"member_report "+e.class},wp.element.createElement("strong",null,e.title),wp.element.createElement("div",{className:"task_report"},"timeline"==e.type?wp.element.createElement(Qm,{data:e.data}):"doughnut"==e.type?wp.element.createElement(ju,{data:e.data}):"bar"==e.type?wp.element.createElement(yu,{data:e.data}):"line"==e.type?wp.element.createElement(Line,{data:e.data}):""))})):wp.element.createElement("div",{className:"vbp_message"},window.vibeprojects.translations.no_data_available))))});function Sv(e){return function(e){if(Array.isArray(e))return Rv(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Dv(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Iv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pv(Object(n),!0).forEach((function(t){Cv(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Cv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Av(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||Dv(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Dv(e,t){if(e){if("string"==typeof e)return Rv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Rv(e,t):void 0}}function Rv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Tv=wp.element,Mv=(Tv.createElement,Tv.render,Tv.useState),Uv=Tv.useEffect,$v=Tv.Fragment,Lv=Tv.useContext,Fv=(Tv.useRef,wp.data),Jv=(Fv.dispatch,Fv.select),Hv=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",Yv=function(e){var t=Av(Mv(!1),2),n=t[0],r=t[1],a=Av(Mv([]),2),i=a[0],o=a[1],s=Av(Mv(!1),2),c=s[0],d=s[1],p=Av(Mv({s:"",post_status:"",page:1,type:"mine",showCompleted:!1,upcoming:!0}),2),u=p[0],m=p[1],f=Av(Mv(!1),2),b=f[0],v=f[1],w=Av(Mv(!1),2),h=w[0],y=w[1],g=Lv(l),_=Av(Mv([]),2),E=_[0],j=_[1],O=Av(Mv("date"),2),k=O[0],N=O[1],x=Av(Mv(window.vibeprojects.settings.board.listView.filter((function(e){return-1==["list","labels","members"].indexOf(e.key)}))),2),S=x[0],P=x[1],I=Av(Mv(!1),2),C=(I[0],I[1],Av(Mv(!1),2)),A=(C[0],C[1],Av(Mv({}),2)),D=(A[0],A[1],Av(Mv(!1),2)),R=D[0],T=D[1];Uv((function(){var e=Iv({},g);Iv({},g.path);delete e.path.project,delete e.path.board,delete e.bulkAction,delete e.selectedCards,delete e.boardFilters,g.update("multiple",Iv({},e))}),[]),Uv((function(){var e;null!==(e=g.path)&&void 0!==e&&e.card&&i.findIndex((function(e){return e.card_id==g.path.card}))>-1&&d(i[i.findIndex((function(e){return e.card_id==g.path.card}))])}),[g.path]),Uv((function(){r(!0),fetch("".concat(Hv,"/projectList"),{method:"post",body:JSON.stringify({token:Jv("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){e.status&&j(e.projects)}))}),[]),Uv((function(){r(!0),fetch("".concat(Hv,"/tasks"),{method:"post",body:JSON.stringify({args:u,token:Jv("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){r(!1),e.status&&(y(e.total),b?(g.update("tasks",[].concat(Sv(i),Sv(e.tasks))),v(!1)):g.update("tasks",e.tasks))}))}),[u]),Uv((function(){o(g.tasks)}),[g.tasks]);var M=[];if(null!=i&&i.length){if("status"==k&&window.vibeprojects.settings.statuses.card.map((function(e){M.push({id:e.value,label:e.label,color:e.color,cards:i.filter((function(t){return t.status==e.value})).map((function(e){return e.card_id}))})})),"members"==k&&board.members.map((function(e){M.push({id:e,cards:i.filter((function(t){return t.members.indexOf(e)>-1})).map((function(e){return e.card_id}))})})),"date"==k){var U=Math.round(new Date((new Date).getUTCFullYear()+"-"+((new Date).getUTCMonth()+1)+"-"+(new Date).getUTCDate()).getTime()/1e3),$=Math.round(new Date((new Date).getUTCFullYear()+"-"+((new Date).getUTCMonth()+1)+"-"+((new Date).getUTCDate()+2)).getTime()/1e3),L=Math.round(new Date((new Date).getUTCFullYear()+"-"+((new Date).getUTCMonth()+2)+"-1").getTime()/1e3);M.push({id:"today",label:window.vibeprojects.translations.due_today,cards:i.filter((function(e){return e.badges.findIndex((function(e){return"duedate"==e.key}))>-1&&e.badges[e.badges.findIndex((function(e){return"duedate"==e.key}))].value<=U})).map((function(e){return e.card_id}))}),M.push({id:"tomorrow",label:window.vibeprojects.translations.due_tomorrow,cards:i.filter((function(e){return e.badges.findIndex((function(e){return"duedate"==e.key}))>-1&&e.badges[e.badges.findIndex((function(e){return"duedate"==e.key}))].value>U&&e.badges[e.badges.findIndex((function(e){return"duedate"==e.key}))].value<=$})).map((function(e){return e.card_id}))}),M.push({id:"month",label:window.vibeprojects.translations.due_this_month,cards:i.filter((function(e){return e.badges.findIndex((function(e){return"duedate"==e.key}))>-1&&e.badges[e.badges.findIndex((function(e){return"duedate"==e.key}))].value>$&&e.badges[e.badges.findIndex((function(e){return"duedate"==e.key}))].value<=L})).map((function(e){return e.card_id}))}),M.push({id:"later",label:window.vibeprojects.translations.due_later,cards:i.filter((function(e){return-1==e.badges.findIndex((function(e){return"duedate"==e.key}))||e.badges[e.badges.findIndex((function(e){return"duedate"==e.key}))].value>L})).map((function(e){return e.card_id}))})}if("project"==k){M.push({id:0,label:window.vibeprojects.translations.no_project,cards:i.filter((function(e){return!e.hasOwnProperty("project")})).map((function(e){return e.card_id}))});var F=[];i.map((function(e){e.hasOwnProperty("project")&&-1==F.indexOf(e.project)&&F.push(e.project)})),F.map((function(e){M.push(Iv(Iv({},e),{},{label:e.title,cards:i.filter((function(t){return t.hasOwnProperty("project")&&t.project.id==e.id})).map((function(e){return e.card_id}))}))}))}"progress"==k&&(M.push({id:0,label:"0 %",cards:i.filter((function(e){return!e.progress})).map((function(e){return e.card_id}))}),M.push({id:25,label:"0 - 25%",cards:i.filter((function(e){return e.progress>0&&e.progress<=25})).map((function(e){return e.card_id}))}),M.push({id:50,label:"25 - 50%",cards:i.filter((function(e){return e.progress>25&&e.progress<=50})).map((function(e){return e.card_id}))}),M.push({id:75,label:"50 - 75%",cards:i.filter((function(e){return e.progress>50&&e.progress<=75})).map((function(e){return e.card_id}))}),M.push({id:100,label:"75 - 100%",cards:i.filter((function(e){return e.progress>75&&e.progress<=100})).map((function(e){return e.card_id}))})),"milestone"==k&&(M.push({id:1,label:window.vibeprojects.translations.milestone,cards:i.filter((function(e){return e.icons.findIndex((function(e){return"milestone"==e.key}))>-1})).map((function(e){return e.card_id}))}),M.push({id:0,label:window.vibeprojects.translations.cards,cards:i.filter((function(e){return-1==e.icons.findIndex((function(e){return"milestone"==e.key}))})).map((function(e){return e.card_id}))}))}return wp.element.createElement("div",{className:"all_tasks_wrapper"},c?wp.element.createElement(Mc,{card:c,update:function(e){var t=Sv(i);t[t.findIndex((function(t){return t.card_id==e.card_id}))]=e,o(t)},close:function(){return d(!1)}}):"",wp.element.createElement("div",{className:"list_view"},wp.element.createElement("div",{className:"vibebp_main_head"},wp.element.createElement("div",{className:"searchbox"},wp.element.createElement("span",{className:"vicon vicon-search"}),wp.element.createElement("input",{type:"text",placeholder:window.vibeprojects.translations.search_task,onBlur:function(e){return m(Iv(Iv({},u),{},{s:e.target.value,page:1,posts_not__in:[]}))}})),wp.element.createElement("div",{className:"tasks_end"},wp.element.createElement("span",{className:"tip bottom",title:window.vibeprojects.translations.show_upcoming,onClick:function(){return m(Iv(Iv({},u),{},{upcoming:!u.upcoming}))}},wp.element.createElement("span",{className:u.upcoming?"vicon vicon-time":"vicon vicon-timer"})),wp.element.createElement("span",{className:"tip bottom",title:window.vibeprojects.translations.show_completed,onClick:function(){return m(Iv(Iv({},u),{},{showCompleted:!u.showCompleted}))}},wp.element.createElement("span",{className:u.showCompleted?"vicon vicon-check":"vicon vicon-check-box"})),E.length?wp.element.createElement("select",{onChange:function(e){m(Iv(Iv({},u),{},{project:e.target.value}))}},wp.element.createElement("option",{value:""},window.vibeprojects.translations.select_project),E.map((function(e){return wp.element.createElement("option",{value:e.ID},e.post_title)}))):"")),null!=i&&i.length?wp.element.createElement($v,null,wp.element.createElement("div",{className:"list_view_header"},wp.element.createElement("div",{className:"card_fields"},S.filter((function(e){return e.selected&&e.key!=k})).map((function(e){return wp.element.createElement("div",{className:"card_field field_"+e.key,onClick:function(){e.required||N(e.key)}},wp.element.createElement("span",null,e.label))}))),R?wp.element.createElement("div",{className:"add_card_fields"},wp.element.createElement("span",{onClick:function(){return T(!1)},className:"vicon vicon-close"}),wp.element.createElement("div",{className:"all_card_fields"},S.map((function(e,t){return wp.element.createElement("div",{className:"select_card_field"},wp.element.createElement("div",{className:"checkbox"},wp.element.createElement("input",{type:"checkbox",id:e.key,value:"1",onChange:function(){var e=Sv(S);e[t].selected=!e[t].selected,P(e)},checked:e.selected}),wp.element.createElement("label",{for:e.key},e.label)))})))):wp.element.createElement("span",{className:"tip bottom left",title:window.vibeprojects.translations.edit+" "+window.vibeprojects.translations.fields,onClick:function(){return T(!0)}},wp.element.createElement("span",{className:"vicon vicon-settings"}))),wp.element.createElement("div",{className:"list_view_boards"},null!=M&&M.length?M.map((function(e,t){if(e.cards.length)return wp.element.createElement(rp,{activeParam:k,list:e,key:t,fields:S.filter((function(e){return e.selected>0&&k!=e.key}))})})):""),h>(null==i?void 0:i.length)?wp.element.createElement("span",{className:n?"vicon vicon-reload":"link",onClick:function(){v(!0),m(Iv(Iv({},u),{},{page:u.page+1,posts_not__in:i.map((function(e){return e.card_id}))}))}},window.vibeprojects.translations.load_more," ",wp.element.createElement("span",null,"(",h-i.length,")")):""):n?wp.element.createElement("div",{className:"loading-roller"},wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null),wp.element.createElement("div",null)):wp.element.createElement("div",{className:"vbp_message"},window.vibeprojects.translations.no_tasks_found)))};function Vv(e){return function(e){if(Array.isArray(e))return Bv(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Xv(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wv(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qv(Object(n),!0).forEach((function(t){Gv(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qv(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Gv(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zv(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,i=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){l=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw a}}return i}(e,t)||Xv(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xv(e,t){if(e){if("string"==typeof e)return Bv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Bv(e,t):void 0}}function Bv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Zv=wp.element,Qv=(Zv.createElement,Zv.render),Kv=Zv.useState,ew=Zv.useEffect,tw=(Zv.Fragment,Zv.useContext,Zv.useCallback,wp.data.select),nw=window.vibeprojects?window.vibeprojects.apiUrl:"http://localhost/wplms/wp-json/vibeprojects/v1/projects/",rw=function(e){var t=zv(Kv(!1),2),n=(t[0],t[1]),r=zv(Kv({path:{},board:{},automate:{},bulkAction:"",selectedCards:[]}),2),a=r[0],i=r[1],o=zv(Kv(!1),2),s=o[0],d=o[1],p=zv(Kv([]),2),u=p[0],m=p[1],f=zv(Kv([]),2),b=f[0],v=f[1],w=zv(Kv([]),2),h=w[0],y=w[1],g=function(){};return ew((function(){-1==document.querySelector("body").classList.value.indexOf("withsidebar")&&document.querySelector("body").classList.add("withsidebar")}),[]),ew((function(){return document.addEventListener("vibebp_component_reload",g),function(){document.removeEventListener("vibebp_component_reload",g)}})),ew((function(){window.location.href.split("#");var e=[],t={};window.location.href.replace(/[#&]+([^=&]+)=([^&]*)/gi,(function(t,n,r){e[n]=r}));Object.keys(e).map((function(n){"project"==n&&(t.project=e[n]),"board"==n&&(t.board=e[n]),"card"==n&&(t.card=e[n])})),Object.keys(t).length&&i(Wv(Wv({},a),{},{path:t}))}),[]),ew((function(){if(a.hasOwnProperty("path")){var e=window.location.href.split("#")[0]+"#",t=[],n=(window.location.href.replace(/[#&]+([^=&]+)=([^&]*)/gi,(function(e,n,r){t[n]=r})),"");Object.keys(t).map((function(e){"project"!==e&&"board"!==e&&"card"!==e&&(n+=e+"="+t[e])})),e+=n,a.path.hasOwnProperty("project")&&(n.length&&(e+="&"),e+="project="+a.path.project),a.path.hasOwnProperty("board")&&(e+="&board="+a.path.board),a.path.hasOwnProperty("card")&&(e+="&card="+a.path.card),window.location.href!=e&&(window.location.href=e)}}),[a.path]),ew((function(){document.dispatchEvent(new Event("vibe_projects_subnav_loaded"))}),[s]),ew((function(){n(!0),fetch("".concat(nw,"/favprojects/?post}"),{method:"post",body:JSON.stringify({token:tw("vibebp").getToken()})}).then((function(e){return e.json()})).then((function(e){n(!1),e.status&&y(e.projects)}))}),[]),ew((function(){var e=tw("vibebp").getMenu().filter((function(e){return"projects"===e.parent}));e.map((function(t,n){-1===e.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}))&&e[n].class.push("current-menu-item")})),d(e[0].css_id),-1==document.querySelector("body").classList.value.indexOf("withsidebar")&&document.querySelector("body").classList.add("withsidebar"),tw("vibebp").getUser().caps.hasOwnProperty("manage_options")&&e.push({class:["menu-child"],css_id:"admin",icon:"vicon vicon-menu",link:"projects/admin/",name:window.vibeprojects.translations.admin,parent:"projects",parent_slug:"projects",position:90,secondary:!0,show_in_admin_bar:!1,slug:"admin",user_has_access:!0}),m(e)}),[]),console.log(s,"@@"),wp.element.createElement("div",{className:"vibebp_sidebars"},wp.element.createElement("div",{className:"vibebp_left_sidebar_wrapper"},wp.element.createElement("div",{className:"vibebp_left_sidebar"},wp.element.createElement("h3",null,window.vibeprojects.label),H("create_project")?wp.element.createElement("a",{className:"button is-primary new_mail",onClick:function(){i(Wv(Wv({},a),{},{new:!a.new}))}},a.new?wp.element.createElement("span",null,wp.element.createElement("span",{class:"vicon vicon-arrow-left"})," ",window.vibeprojects.translations.back):wp.element.createElement("span",null,window.vibeprojects.translations.add_new_project," ",wp.element.createElement("span",{class:"vicon vicon-arrow-right"})," ")):"",u.map((function(e,t){var n=e.class.join(" ")+" "+e.css_id;return wp.element.createElement("a",{className:n,onClick:function(n){var r=Wv({},b);r.filter=e.css_id,r.page=1,b.css_id!==r.filter&&v(r),d(e.css_id);var o=Vv(u),l=o.findIndex((function(e){return e.class.indexOf("current-menu-item")>-1}));o[l].class.splice(o[l].class.indexOf("current-menu-item"),1),o[t].class.push("current-menu-item"),i(Wv(Wv({},a),{},{path:{}})),m(o)}},e.name)})),h.length?wp.element.createElement("div",{className:"favourite_projects"},wp.element.createElement("strong",null,wp.element.createElement("span",null,window.vibeprojects.translations.favourite_projects)),h.map((function(e){return wp.element.createElement("div",{className:"fav_project",onClick:function(){d("projects"),i(Wv(Wv({},a),{},{path:{project:e.id}}))}},wp.element.createElement("img",{src:e.avatar}),wp.element.createElement("div",{className:"fav_project_details"},wp.element.createElement("div",null,wp.element.createElement("strong",null,e.title)),wp.element.createElement(c,{progress:e.progress,size:"xs"})))}))):wp.element.createElement("span",{className:"add_fav_projects_message"},window.vibeprojects.translations.add_fav_projects_message))),wp.element.createElement("div",{className:"vibebp_main"},wp.element.createElement("div",{className:"vibe_projects_context_wrapper"},wp.element.createElement(l.Provider,{value:Wv(Wv({},a),{},{update:function(e,t){var n=Wv({},a);"remove"===e?delete n[t]:"full"==e?n=t:"multiple"==e?Object.keys(t).map((function(e){n[e]=t[e]})):n[e]=t,i(n)}})},"projects"==s?wp.element.createElement(Ab,{type:"mine"}):"admin"==s?wp.element.createElement(Ab,{type:"admin"}):"tasks"==s?wp.element.createElement(Yv,null):"calendar"==s?wp.element.createElement(bv,{type:"mine"}):"reports"==s?wp.element.createElement(xv,null):wp.element.createElement("div",{className:"projects_sub_nav_"+s})))))};document.addEventListener("component_loaded",(function(e){if("projects"===e.detail.component)setTimeout((function(){Qv(wp.element.createElement(rw,{user:e.detail.user,token:e.detail.token}),document.querySelector("#projects_component"))}),200);else{var t=window.location.href.split("#")[0]+"#",n=[],r=(window.location.href.replace(/[#&]+([^=&]+)=([^&]*)/gi,(function(e,t,r){n[t]=r})),"");Object.keys(n).map((function(e){"project"!==e&&"board"!==e&&"card"!==e&&(r+=e+"="+n[e])})),t+=r,window.location.href=t}}),!1)}]);